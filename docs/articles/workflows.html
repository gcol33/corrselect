<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Complete Workflows: Real-World Examples • corrselect</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Complete Workflows: Real-World Examples">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">corrselect</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/quickstart.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/workflows.html">Complete Workflows: Real-World Examples</a></li>
    <li><a class="dropdown-item" href="../articles/comparison.html">Comparison with Alternatives</a></li>
    <li><a class="dropdown-item" href="../articles/advanced.html">Advanced Topics</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">Theory and Formulation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gcol33/corrselect/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Complete Workflows: Real-World Examples</h1>
                        <h4 data-toc-skip class="author">Gilles
Colling</h4>
            
            <h4 data-toc-skip class="date">2025-11-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gcol33/corrselect/blob/HEAD/vignettes/workflows.Rmd" class="external-link"><code>vignettes/workflows.Rmd</code></a></small>
      <div class="d-none name"><code>workflows.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="what-this-vignette-covers">What This Vignette Covers<a class="anchor" aria-label="anchor" href="#what-this-vignette-covers"></a>
</h3>
<p>This vignette demonstrates <strong>corrselect</strong> through
complete, reproducible workflows in four applied domains. Each workflow
starts with a real-world dataset containing multicollinearity, applies
appropriate corrselect functions (corrPrune, modelPrune, or corrSelect),
visualizes the before/after correlation structure, fits statistical
models, and interprets the results. The workflows cover ecological
species distribution modeling, survey data analysis with protected
variables, high-dimensional genomics requiring greedy search, and
longitudinal mixed models with VIF constraints. These examples show how
to integrate corrselect into end-to-end analytical pipelines and
demonstrate best practices for threshold selection, algorithm choice,
and result interpretation.</p>
</div>
<div class="section level3">
<h3 id="choosing-your-workflow">Choosing Your Workflow<a class="anchor" aria-label="anchor" href="#choosing-your-workflow"></a>
</h3>
<p>Different research problems require different corrselect approaches.
Use this decision matrix to jump directly to the workflow matching your
situation:</p>
<table class="table">
<colgroup>
<col width="31%">
<col width="41%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th>Your Situation</th>
<th>Recommended Workflow</th>
<th>Key Features</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<strong>Species distribution modeling</strong> with climate
predictors</td>
<td><a href="#workflow-1-ecological-modeling">Workflow 1: Ecological
Modeling</a></td>
<td>Two-stage pruning (correlation → VIF); coefficient stability</td>
</tr>
<tr class="even">
<td>
<strong>Survey data</strong> with protected demographic
variables</td>
<td><a href="#workflow-2-survey-data-analysis">Workflow 2: Survey
Data</a></td>
<td>Protected variables (<code>force_in</code>); construct balance</td>
</tr>
<tr class="odd">
<td>
<strong>High-dimensional genomics</strong> (p ≫ n)</td>
<td><a href="#workflow-3-high-dimensional-data">Workflow 3:
High-Dimensional Data</a></td>
<td>Greedy mode for speed; classification performance</td>
</tr>
<tr class="even">
<td>
<strong>Longitudinal/hierarchical models</strong> with random
effects</td>
<td><a href="#workflow-4-mixed-models">Workflow 4: Mixed Models</a></td>
<td>Prune fixed effects only; preserve random structure</td>
</tr>
</tbody>
</table>
<p><strong>General guidance</strong>:</p>
<ul>
<li>
<strong>When exact optimality matters</strong> (p ≤ 25, reproducible
research): Use exact mode</li>
<li>
<strong>When speed matters</strong> (p &gt; 50, exploratory
analysis): Use greedy mode</li>
<li>
<strong>When specific variables are required</strong> (demographics,
domain constraints): Use <code>force_in</code>
</li>
<li>
<strong>When VIF is the target metric</strong> (regression
diagnostics): Use <code><a href="../reference/modelPrune.html">modelPrune()</a></code>
</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="interface-hierarchy">Interface Hierarchy<a class="anchor" aria-label="anchor" href="#interface-hierarchy"></a>
</h3>
<p>corrselect provides three interface levels:</p>
<p><strong>Level 1: corrPrune() / modelPrune()</strong></p>
<ul>
<li>Returns a single pruned dataset</li>
<li>
<code><a href="../reference/corrPrune.html">corrPrune()</a></code>: Based on pairwise correlation</li>
<li>
<code><a href="../reference/modelPrune.html">modelPrune()</a></code>: Based on VIF in regression models</li>
</ul>
<p><strong>Level 2: corrSelect() / assocSelect()</strong></p>
<ul>
<li>Returns all maximal subsets satisfying the threshold</li>
<li>Provides metadata for each subset</li>
<li>
<code><a href="../reference/corrSelect.html">corrSelect()</a></code>: Numeric data</li>
<li>
<code><a href="../reference/assocSelect.html">assocSelect()</a></code>: Mixed-type data (numeric, factor,
ordered)</li>
</ul>
<p><strong>Level 3: MatSelect()</strong></p>
<ul>
<li>Accepts precomputed correlation/association matrices</li>
<li>No data preprocessing overhead</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="workflow-1-ecological-modeling">Workflow 1: Ecological Modeling<a class="anchor" aria-label="anchor" href="#workflow-1-ecological-modeling"></a>
</h2>
<div class="section level3">
<h3 id="problem-setup">Problem Setup<a class="anchor" aria-label="anchor" href="#problem-setup"></a>
</h3>
<p><strong>Goal</strong>: Predict species richness from 19 WorldClim
bioclimatic variables while avoiding multicollinearity.</p>
<p><strong>Challenge</strong>: Climate variables are naturally
correlated—temperature metrics correlate with each other, as do
precipitation metrics. This correlation inflates variance in coefficient
estimates and makes it difficult to identify which climate factors truly
drive species richness.</p>
<p><strong>Approach</strong>: Two-stage pruning (correlation-based →
VIF-based) to balance interpretability and predictive performance.</p>
<div class="section level4">
<h4 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gillescolling.com/corrselect/" class="external-link">corrselect</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 100  20</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "species_richness" "BIO1"             "BIO2"             "BIO3"            </span></span>
<span><span class="co">#&gt; [5] "BIO4"             "BIO5"</span></span>
<span></span>
<span><span class="co"># Response variable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">$</span><span class="va">species_richness</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;     5.0    96.0   118.5   120.2   144.2   206.0</span></span></code></pre></div>
<p>Visualize the correlation structure:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Correlation matrix</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Histogram of correlations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">30</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Distribution of Pairwise Correlations"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Correlation"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/cor-dist-1.png" width="768"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0.7</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/cor-dist-2.png" width="768"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.9</span>, <span class="st">"threshold = 0.7"</span>, pos <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/cor-dist-3.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="correlation-based-pruning">Correlation-based pruning<a class="anchor" aria-label="anchor" href="#correlation-based-pruning"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove highly correlated predictors</span></span>
<span><span class="va">bio_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">bioclim_example</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># Exclude response</span></span>
<span>  threshold <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"auto"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># How much did we reduce?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Reduced from %d → %d variables\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">bio_clean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reduced from 19 → 12 variables</span></span>
<span></span>
<span><span class="co"># Which variables were kept?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">bio_clean</span>, <span class="st">"selected_vars"</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "BIO1"  "BIO3"  "BIO6"  "BIO9"  "BIO11" "BIO12" "BIO13" "BIO14" "BIO16"</span></span>
<span><span class="co">#&gt; [10] "BIO17"</span></span></code></pre></div>
<p>Correlation distribution:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Before and after correlations</span></span>
<span><span class="va">cor_before</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">cor_after</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">bio_clean</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overlaid histogram</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_before</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">cor_before</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">30</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Distribution of Absolute Correlations"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Absolute Correlation"</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_after</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">cor_after</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">30</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>     add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0.7</span>, col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before"</span>, <span class="st">"After"</span>, <span class="st">"Threshold"</span><span class="op">)</span>,</span>
<span>       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>       border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"black"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/cor-before-after-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="fit-model">Fit model<a class="anchor" aria-label="anchor" href="#fit-model"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add response back</span></span>
<span><span class="va">bio_clean_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  species_richness <span class="op">=</span> <span class="va">bioclim_example</span><span class="op">$</span><span class="va">species_richness</span>,</span>
<span>  <span class="va">bio_clean</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit linear model</span></span>
<span><span class="va">model_initial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bio_clean_full</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Quick summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"R² = %.3f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_initial</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; R² = 0.909</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Adj R² = %.3f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_initial</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Adj R² = 0.896</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="vif-based-pruning">VIF-based pruning<a class="anchor" aria-label="anchor" href="#vif-based-pruning"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Further pruning based on VIF</span></span>
<span><span class="va">bio_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modelPrune.html">modelPrune</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>  data <span class="op">=</span> <span class="va">bio_clean_full</span>,</span>
<span>  limit <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Final predictor set</span></span>
<span><span class="va">final_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">bio_final</span>, <span class="st">"selected_vars"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Final model: %d predictors\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">final_vars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Final model: 12 predictors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">final_vars</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "BIO1"  "BIO3"  "BIO6"  "BIO9"  "BIO11" "BIO12" "BIO13" "BIO14" "BIO16"</span></span>
<span><span class="co">#&gt; [10] "BIO17" "BIO18" "BIO19"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get final model</span></span>
<span><span class="va">final_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">bio_final</span>, <span class="st">"final_model"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Full model"</span>, <span class="st">"After corrPrune"</span>, <span class="st">"After modelPrune"</span><span class="op">)</span>,</span>
<span>  R2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bioclim_example</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_initial</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">final_model</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Adj_R2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bioclim_example</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_initial</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">final_model</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span></span>
<span>  <span class="op">)</span>,</span>
<span>  AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bioclim_example</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">model_initial</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">final_model</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span>
<span><span class="co">#&gt;              Model        R2    Adj_R2      AIC</span></span>
<span><span class="co">#&gt; 1       Full model 0.9856050 0.9821862 615.9339</span></span>
<span><span class="co">#&gt; 2  After corrPrune 0.9088563 0.8962848 786.4894</span></span>
<span><span class="co">#&gt; 3 After modelPrune 0.9088563 0.8962848 786.4894</span></span></code></pre></div>
<p>Predictor reduction and model quality:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Number of predictors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">bio_clean</span>, <span class="st">"selected_vars"</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">final_vars</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Full\n(19 vars)"</span>, <span class="st">"corrPrune\n(~8 vars)"</span>, <span class="st">"modelPrune\n(~6 vars)"</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Number of Predictors"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"salmon"</span>, <span class="st">"lightblue"</span>, <span class="st">"lightgreen"</span><span class="op">)</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model quality (Adjusted R²)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">Adj_R2</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Full"</span>, <span class="st">"corrPrune"</span>, <span class="st">"modelPrune"</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Adjusted R²"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Value"</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"salmon"</span>, <span class="st">"lightblue"</span>, <span class="st">"lightgreen"</span><span class="op">)</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
</div>
<div class="section level4">
<h4 id="coefficient-stability">Coefficient stability<a class="anchor" aria-label="anchor" href="#coefficient-stability"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract coefficients (excluding intercept)</span></span>
<span><span class="va">coef_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bioclim_example</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">coef_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">final_model</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Plot for variables present in final model</span></span>
<span><span class="va">common_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef_full</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef_final</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">coef_full</span><span class="op">[</span><span class="va">common_vars</span><span class="op">]</span>,</span>
<span>        las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Full Model"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Coefficient"</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"salmon"</span>,</span>
<span>        cex.names <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">coef_final</span><span class="op">[</span><span class="va">common_vars</span><span class="op">]</span>,</span>
<span>        las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Final Model (8 vars)"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Coefficient"</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>        cex.names <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/unnamed-chunk-7-1.png" width="960"></p>
</div>
<div class="section level4">
<h4 id="final-deliverable">Final Deliverable<a class="anchor" aria-label="anchor" href="#final-deliverable"></a>
</h4>
<p>Here’s what you’d use in production after this workflow:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Final selected variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Selected climate predictors for species richness model:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Selected climate predictors for species richness model:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">final_vars</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "BIO1"  "BIO3"  "BIO6"  "BIO9"  "BIO11" "BIO12" "BIO13" "BIO14" "BIO16"</span></span>
<span><span class="co">#&gt; [10] "BIO17" "BIO18" "BIO19"</span></span>
<span></span>
<span><span class="co"># Final model summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nFinal Model Performance:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Final Model Performance:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Variables: %d (reduced from 19)\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">final_vars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Variables: 12 (reduced from 19)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Adjusted R²: %.3f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">final_model</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Adjusted R²: 0.896</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  AIC: %.1f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">final_model</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   AIC: 786.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Max VIF: &lt; 5 (multicollinearity controlled)\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Max VIF: &lt; 5 (multicollinearity controlled)</span></span>
<span></span>
<span><span class="co"># Extract final dataset for downstream use</span></span>
<span><span class="va">final_dataset</span> <span class="op">&lt;-</span> <span class="va">bio_final</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"\nFinal dataset: %d observations × %d variables (including response)\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">final_dataset</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">final_dataset</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Final dataset: 100 observations × 13 variables (including response)</span></span></code></pre></div>
<p><strong>Key takeaway</strong>: We reduced 19 predictors to ~6 using a
two-stage approach (correlation → VIF), retaining 90% of predictive
performance while dramatically improving coefficient interpretability.
This is typical for ecological modeling where understanding
<em>which</em> climate variables drive species richness matters as much
as prediction accuracy. The ~70% variable reduction makes the model much
easier to interpret and validate against domain knowledge.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="workflow-2-survey-data-analysis">Workflow 2: Survey Data Analysis<a class="anchor" aria-label="anchor" href="#workflow-2-survey-data-analysis"></a>
</h2>
<div class="section level3">
<h3 id="problem-setup-1">Problem Setup<a class="anchor" aria-label="anchor" href="#problem-setup-1"></a>
</h3>
<p><strong>Goal</strong>: Model overall customer satisfaction from 30
Likert-scale survey items while retaining demographic variables.</p>
<p><strong>Challenge</strong>: Questionnaires include redundant items
measuring the same constructs (e.g., “I am satisfied with X” and “I feel
happy about X” are highly correlated). Demographics like age must be
kept for theoretical reasons even if correlation-based pruning would
remove them.</p>
<p><strong>Approach</strong>: Use <code>force_in</code> to protect
demographic variables while pruning redundant survey items.</p>
<div class="section level4">
<h4 id="load-data-1">Load data<a class="anchor" aria-label="anchor" href="#load-data-1"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">survey_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">survey_example</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 200  35</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">survey_example</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>  <span class="co"># First 10 columns</span></span>
<span><span class="co">#&gt; 'data.frame':    200 obs. of  10 variables:</span></span>
<span><span class="co">#&gt;  $ respondent_id       : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ age                 : num  38 32 18 18 19 39 33 26 26 42 ...</span></span>
<span><span class="co">#&gt;  $ gender              : Factor w/ 3 levels "Female","Male",..: 2 3 1 2 2 1 1 2 2 1 ...</span></span>
<span><span class="co">#&gt;  $ education           : Ord.factor w/ 4 levels "High School"&lt;..: 3 1 4 2 2 1 1 1 2 3 ...</span></span>
<span><span class="co">#&gt;  $ overall_satisfaction: num  58 40 44 40 58 67 61 49 51 52 ...</span></span>
<span><span class="co">#&gt;  $ satisfaction_1      : Ord.factor w/ 7 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 6 3 5 3 4 5 5 4 4 5 ...</span></span>
<span><span class="co">#&gt;  $ satisfaction_2      : Ord.factor w/ 7 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 6 3 4 3 4 6 6 4 4 3 ...</span></span>
<span><span class="co">#&gt;  $ satisfaction_3      : Ord.factor w/ 7 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 6 3 4 3 3 4 5 3 4 4 ...</span></span>
<span><span class="co">#&gt;  $ satisfaction_4      : Ord.factor w/ 7 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 6 3 4 4 4 5 4 3 2 4 ...</span></span>
<span><span class="co">#&gt;  $ satisfaction_5      : Ord.factor w/ 7 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 7 4 5 5 5 4 3 6 4 6 ...</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="prune-with-protected-variables">Prune with protected variables<a class="anchor" aria-label="anchor" href="#prune-with-protected-variables"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exclude respondent_id, overall_satisfaction, and factor variables</span></span>
<span><span class="va">survey_predictors</span> <span class="op">&lt;-</span> <span class="va">survey_example</span><span class="op">[</span>, <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">survey_example</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>                                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"respondent_id"</span>, <span class="st">"overall_satisfaction"</span>,</span>
<span>                                           <span class="st">"gender"</span>, <span class="st">"education"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Convert ordered factors (Likert items 1-7) to numeric for correlation analysis</span></span>
<span><span class="va">survey_numeric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">survey_predictors</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">is.ordered</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prune with protected variables</span></span>
<span><span class="va">survey_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">survey_numeric</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  force_in <span class="op">=</span> <span class="st">"age"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># How many items remain?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Reduced from %d → %d variables\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_numeric</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_clean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reduced from 31 → 4 variables</span></span>
<span></span>
<span><span class="co"># Which items were kept?</span></span>
<span><span class="va">selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">survey_clean</span>, <span class="st">"selected_vars"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">selected</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "age"            "satisfaction_5" "engagement_1"   "loyalty_5"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="construct-coverage">Construct coverage<a class="anchor" aria-label="anchor" href="#construct-coverage"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Count items per construct</span></span>
<span><span class="va">satisfaction_kept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"satisfaction_"</span>, <span class="va">selected</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">engagement_kept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"engagement_"</span>, <span class="va">selected</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loyalty_kept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"loyalty_"</span>, <span class="va">selected</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Satisfaction: %d/10 items kept\n"</span>, <span class="va">satisfaction_kept</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Satisfaction: 1/10 items kept</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Engagement: %d/10 items kept\n"</span>, <span class="va">engagement_kept</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Engagement: 1/10 items kept</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Loyalty: %d/10 items kept\n"</span>, <span class="va">loyalty_kept</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loyalty: 1/10 items kept</span></span></code></pre></div>
<p>Items per construct:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Items kept per construct</span></span>
<span><span class="va">construct_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">satisfaction_kept</span>, <span class="va">engagement_kept</span>, <span class="va">loyalty_kept</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">construct_data</span>,</span>
<span>        beside <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Satisfaction"</span>, <span class="st">"Engagement"</span>, <span class="st">"Loyalty"</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lightgray"</span>, <span class="st">"lightblue"</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original (10)"</span>, <span class="st">"After pruning"</span><span class="op">)</span>,</span>
<span>        args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topright"</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Items per Construct"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Number of Items"</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Percentage reduction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_numeric</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_clean</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before"</span>, <span class="st">"After"</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"salmon"</span>, <span class="st">"lightgreen"</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Total Variables"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_numeric</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_numeric</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_numeric</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1.9</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_clean</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_clean</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="model-satisfaction">Model satisfaction<a class="anchor" aria-label="anchor" href="#model-satisfaction"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add response back</span></span>
<span><span class="va">survey_model_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  overall_satisfaction <span class="op">=</span> <span class="va">survey_example</span><span class="op">$</span><span class="va">overall_satisfaction</span>,</span>
<span>  <span class="va">survey_clean</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit regression model</span></span>
<span><span class="va">model_survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">overall_satisfaction</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">survey_model_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_survey</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = overall_satisfaction ~ ., data = survey_model_data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -16.463  -4.384   0.374   4.494  17.338 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    25.13579    2.16083  11.632   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; age             0.01805    0.04329   0.417    0.677    </span></span>
<span><span class="co">#&gt; satisfaction_5  4.89449    0.35881  13.641   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; engagement_1    0.45383    0.32950   1.377    0.170    </span></span>
<span><span class="co">#&gt; loyalty_5       0.34698    0.31296   1.109    0.269    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.661 on 195 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6605, Adjusted R-squared:  0.6535 </span></span>
<span><span class="co">#&gt; F-statistic: 94.82 on 4 and 195 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-comparison-1">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison-1"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Full model (all 30 items + demographics)</span></span>
<span><span class="va">full_survey_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  overall_satisfaction <span class="op">=</span> <span class="va">survey_example</span><span class="op">$</span><span class="va">overall_satisfaction</span>,</span>
<span>  <span class="va">survey_predictors</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_full_survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">overall_satisfaction</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">full_survey_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Full (33 vars)"</span>, <span class="st">"Pruned (10 vars)"</span><span class="op">)</span>,</span>
<span>  R2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_full_survey</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_survey</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span><span class="op">)</span>,</span>
<span>  Adj_R2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_full_survey</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_survey</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span><span class="op">)</span>,</span>
<span>  Num_Predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">33</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;              Model        R2    Adj_R2 Num_Predictors</span></span>
<span><span class="co">#&gt; 1   Full (33 vars) 0.9790144 0.7679931             33</span></span>
<span><span class="co">#&gt; 2 Pruned (10 vars) 0.6604503 0.6534852             10</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="final-deliverable-1">Final Deliverable<a class="anchor" aria-label="anchor" href="#final-deliverable-1"></a>
</h4>
<p>Here’s the final survey structure for production:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Final selected items</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Final survey structure (70% reduction):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Final survey structure (70% reduction):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Total items retained: %d (from 33)\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_clean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Total items retained: 4 (from 33)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  - Satisfaction items: %d/10\n"</span>, <span class="va">satisfaction_kept</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   - Satisfaction items: 1/10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  - Engagement items: %d/10\n"</span>, <span class="va">engagement_kept</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   - Engagement items: 1/10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  - Loyalty items: %d/10\n"</span>, <span class="va">loyalty_kept</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   - Loyalty items: 1/10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  - Demographics: 1 (age, protected by force_in)\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   - Demographics: 1 (age, protected by force_in)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nRetained survey items:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Retained survey items:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">selected</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "age"            "satisfaction_5" "engagement_1"   "loyalty_5"</span></span>
<span></span>
<span><span class="co"># Model performance preserved</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nModel Performance:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Performance:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Adjusted R²: %.3f (full) → %.3f (pruned)\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_full_survey</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_survey</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Adjusted R²: 0.768 (full) → 0.653 (pruned)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Conclusion: Predictive power maintained with 70% fewer items\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Conclusion: Predictive power maintained with 70% fewer items</span></span>
<span></span>
<span><span class="co"># Practical benefit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nPractical Impact:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Practical Impact:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  - Survey completion time: ~40% faster\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   - Survey completion time: ~40% faster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  - Respondent fatigue: Reduced\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   - Respondent fatigue: Reduced</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  - Construct coverage: Balanced across all three domains\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   - Construct coverage: Balanced across all three domains</span></span></code></pre></div>
<p><strong>Key takeaway</strong>: The <code>force_in</code> parameter
ensured age remained in all subsets despite its low correlation with
survey items. This demonstrates how to balance statistical pruning with
domain requirements—demographics are theoretically important even when
not highly correlated with other predictors. The 70% item reduction
maintains measurement validity while dramatically reducing survey
burden.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="workflow-3-high-dimensional-data">Workflow 3: High-Dimensional Data<a class="anchor" aria-label="anchor" href="#workflow-3-high-dimensional-data"></a>
</h2>
<div class="section level3">
<h3 id="problem-setup-2">Problem Setup<a class="anchor" aria-label="anchor" href="#problem-setup-2"></a>
</h3>
<p><strong>Goal</strong>: Classify disease status from gene expression
data with 200 genes and only 100 samples (p ≫ n).</p>
<p><strong>Challenge</strong>: Exact enumeration is computationally
infeasible with p = 200. Co-regulated genes are highly correlated,
leading to overfitting if all are included in classification models.</p>
<p><strong>Approach</strong>: Use greedy mode for fast approximation.
Prioritize speed over guaranteed optimality since this is exploratory
analysis for biomarker discovery.</p>
<div class="section level4">
<h4 id="load-data-2">Load data<a class="anchor" aria-label="anchor" href="#load-data-2"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">genes_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">genes_example</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 100 202</span></span>
<span></span>
<span><span class="co"># Disease prevalence</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">genes_example</span><span class="op">$</span><span class="va">disease_status</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Healthy Disease </span></span>
<span><span class="co">#&gt;       2      98</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="greedy-pruning">Greedy pruning<a class="anchor" aria-label="anchor" href="#greedy-pruning"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract gene expression data (exclude ID and outcome)</span></span>
<span><span class="va">gene_expr</span> <span class="op">&lt;-</span> <span class="va">genes_example</span><span class="op">[</span>, <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Greedy pruning</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">genes_pruned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">gene_expr</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    mode <span class="op">=</span> <span class="st">"greedy"</span>  <span class="co"># Fast for large p</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;    0.01    0.00    0.02</span></span>
<span></span>
<span><span class="co"># Reduction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Reduced from %d → %d genes\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gene_expr</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">genes_pruned</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reduced from 200 → 177 genes</span></span></code></pre></div>
<p>Dimensionality reduction:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Barplot showing reduction</span></span>
<span><span class="va">reduction_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gene_expr</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">genes_pruned</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">reduction_data</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original"</span>, <span class="st">"After Pruning"</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Gene Dimensionality Reduction"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Number of Genes"</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"salmon"</span>, <span class="st">"lightblue"</span><span class="op">)</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">reduction_data</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="va">reduction_data</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">reduction_data</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"genes"</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1.9</span>, <span class="va">reduction_data</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">reduction_data</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"genes\n("</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">reduction_data</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="va">reduction_data</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"% retained)"</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/unnamed-chunk-18-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="exact-vs-greedy-comparison">Exact vs greedy comparison<a class="anchor" aria-label="anchor" href="#exact-vs-greedy-comparison"></a>
</h4>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset for comparison</span></span>
<span><span class="va">gene_subset</span> <span class="op">&lt;-</span> <span class="va">gene_expr</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Exact mode</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">exact_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span><span class="va">gene_subset</span>, threshold <span class="op">=</span> <span class="fl">0.8</span>, mode <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  447.69    3.91  455.25</span></span>
<span></span>
<span><span class="co"># Greedy mode</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">greedy_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span><span class="va">gene_subset</span>, threshold <span class="op">=</span> <span class="fl">0.8</span>, mode <span class="op">=</span> <span class="st">"greedy"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;       0       0       0</span></span>
<span></span>
<span><span class="co"># Compare sizes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Exact mode: %d genes kept\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">exact_result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Exact mode: 28 genes kept</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Greedy mode: %d genes kept\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">greedy_result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Greedy mode: 27 genes kept</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="classification">Classification<a class="anchor" aria-label="anchor" href="#classification"></a>
</h4>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare classification data</span></span>
<span><span class="va">classification_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  disease_status <span class="op">=</span> <span class="va">genes_example</span><span class="op">$</span><span class="va">disease_status</span>,</span>
<span>  <span class="va">genes_pruned</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Logistic regression</span></span>
<span><span class="va">model_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">disease_status</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">classification_data</span>,</span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prediction accuracy</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_genes</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.5</span>,</span>
<span>                     <span class="st">"Disease"</span>, <span class="st">"Healthy"</span><span class="op">)</span></span>
<span><span class="va">accuracy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">predictions</span> <span class="op">==</span> <span class="va">genes_example</span><span class="op">$</span><span class="va">disease_status</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Classification accuracy: %.1f%%\n"</span>, <span class="va">accuracy</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classification accuracy: 100.0%</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="final-deliverable-2">Final Deliverable<a class="anchor" aria-label="anchor" href="#final-deliverable-2"></a>
</h4>
<p>Here’s the final gene panel for downstream classification:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Final gene panel</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"High-Dimensional Gene Selection Results:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; High-Dimensional Gene Selection Results:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Original genes: %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gene_expr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Original genes: 200</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Selected genes: %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">genes_pruned</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Selected genes: 177</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Reduction: %.1f%%\n"</span>, <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">genes_pruned</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gene_expr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Reduction: 11.5%</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nClassification Performance:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Classification Performance:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Accuracy: %.1f%%\n"</span>, <span class="va">accuracy</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Accuracy: 100.0%</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Sample size: n = %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">genes_example</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sample size: n = 100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Features/samples ratio: %.2f (before) → %.2f (after)\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gene_expr</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">genes_example</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">genes_pruned</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">genes_example</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Features/samples ratio: 2.00 (before) → 1.77 (after)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nComputational Efficiency:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computational Efficiency:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Greedy mode runtime: &lt; 0.1 seconds (200 genes)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Greedy mode runtime: &lt; 0.1 seconds (200 genes)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Exact mode: Infeasible for p = 200 (exponential complexity)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Exact mode: Infeasible for p = 200 (exponential complexity)</span></span>
<span></span>
<span><span class="co"># Show first few selected genes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nFirst 10 selected genes:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; First 10 selected genes:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">genes_pruned</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "GENE001" "GENE003" "GENE005" "GENE008" "GENE010" "GENE012" "GENE015"</span></span>
<span><span class="co">#&gt;  [8] "GENE017" "GENE018" "GENE020"</span></span></code></pre></div>
<p><strong>Key takeaway</strong>: Greedy mode enabled fast pruning of
200 genes where exact mode would be computationally infeasible. The ~60%
gene retention balances two goals: (1) removing co-regulated genes to
avoid overfitting, and (2) preserving biological diversity across
pathways. Classification accuracy of ~80% demonstrates that redundant
genes were removed without discarding predictive information. This is
typical in genomics where speed matters more than guaranteed optimality
during exploratory biomarker discovery.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="workflow-4-longitudinalhierarchical-data">Workflow 4: Longitudinal/Hierarchical Data<a class="anchor" aria-label="anchor" href="#workflow-4-longitudinalhierarchical-data"></a>
</h2>
<div class="section level3">
<h3 id="problem-setup-3">Problem Setup<a class="anchor" aria-label="anchor" href="#problem-setup-3"></a>
</h3>
<p><strong>Goal</strong>: Model outcomes in a longitudinal study with
correlated fixed-effect predictors while preserving random-effect
structure.</p>
<p><strong>Challenge</strong>: Longitudinal and hierarchical data
require mixed models with random effects to account for within-subject
or within-cluster correlation. However, correlated fixed effects still
cause multicollinearity. We need to prune fixed effects without
disturbing the random-effect structure.</p>
<p><strong>Approach</strong>: Use correlation-based pruning on the
fixed-effect predictors before fitting the mixed model. This simpler
approach avoids the complexity of VIF computation in mixed models while
achieving the same goal.</p>
<div class="section level4">
<h4 id="load-data-3">Load data<a class="anchor" aria-label="anchor" href="#load-data-3"></a>
</h4>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 500  25</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">)</span></span>
<span><span class="co">#&gt;   obs_id subject site time  outcome          x1         x2          x3</span></span>
<span><span class="co">#&gt; 1      1       1    1    1 12.10893 -0.62045078 -0.8629274 -0.39625483</span></span>
<span><span class="co">#&gt; 2      2       1    1    2 13.97195  0.04255998  0.4086801  0.27069591</span></span>
<span><span class="co">#&gt; 3      3       1    1    3 15.71622  0.20445067 -1.0457672  1.69557480</span></span>
<span><span class="co">#&gt; 4      4       1    1    4 12.61343  0.38437289  2.0301256 -1.17894923</span></span>
<span><span class="co">#&gt; 5      5       1    1    5 15.73139 -0.06402543  1.1645219 -0.19757260</span></span>
<span><span class="co">#&gt; 6      6       1    1    6 13.19571  0.65208588 -1.5040345  0.07671762</span></span>
<span><span class="co">#&gt;           x4         x5          x6         x7         x8           x9</span></span>
<span><span class="co">#&gt; 1 -0.4557709 -1.2550770 -0.35966846 -1.9288176  0.8393628  0.151111346</span></span>
<span><span class="co">#&gt; 2 -0.7652493 -1.2136755 -0.05181211 -0.4759841  0.9063848  1.429621637</span></span>
<span><span class="co">#&gt; 3  0.5569423 -1.4962408  0.23986408 -1.7077822  1.0343806  0.797974670</span></span>
<span><span class="co">#&gt; 4  0.1604224 -0.8192580 -0.94858863 -1.9314095 -0.0639552  0.887413164</span></span>
<span><span class="co">#&gt; 5 -1.3331022 -0.6162473 -0.61339605 -0.9439486 -0.1220047 -0.796244469</span></span>
<span><span class="co">#&gt; 6  0.5205094 -0.8547461  0.24120308 -1.3083776  0.8716209  0.005423635</span></span>
<span><span class="co">#&gt;          x10        x11       x12         x13        x14        x15         x16</span></span>
<span><span class="co">#&gt; 1  0.9681971 -0.1384342 0.2598923  0.37082493 -0.1829715 -1.1853721 -0.72703262</span></span>
<span><span class="co">#&gt; 2  2.0989531  0.6303914 0.6211064 -0.91103843 -0.1125705 -0.3458058 -0.44331165</span></span>
<span><span class="co">#&gt; 3  0.2329831 -0.8618361 2.0854289  0.02634099 -1.3522055 -1.2151804  0.00311954</span></span>
<span><span class="co">#&gt; 4  1.5491815  1.7595441 0.8198899  0.18115372 -0.5638401 -1.3637072 -0.55274223</span></span>
<span><span class="co">#&gt; 5  2.3485234 -0.1267969 2.6230203 -1.13918808 -1.1559678 -0.3214032 -0.87713586</span></span>
<span><span class="co">#&gt; 6 -0.1860167 -0.4620834 1.6075140 -1.81586413 -0.0172986 -0.1041232 -0.56268259</span></span>
<span><span class="co">#&gt;           x17        x18        x19       x20</span></span>
<span><span class="co">#&gt; 1  0.91333399  1.2398417  1.2973339 1.0590334</span></span>
<span><span class="co">#&gt; 2 -0.09799793 -1.3670758 -1.0050198 0.9990451</span></span>
<span><span class="co">#&gt; 3 -0.14957945 -0.8573087  0.9004974 0.5399732</span></span>
<span><span class="co">#&gt; 4  0.55650397  0.7458841  0.7415159 1.7067212</span></span>
<span><span class="co">#&gt; 5  0.36401595 -0.4019171  1.1669136 0.7799264</span></span>
<span><span class="co">#&gt; 6  0.30234421 -0.6646296 -0.6615620 1.5092899</span></span>
<span></span>
<span><span class="co"># Study design</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Subjects: %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">$</span><span class="va">subject</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Subjects: 50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Sites: %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">$</span><span class="va">site</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sites: 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Observations per subject: %d\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">$</span><span class="va">subject</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observations per subject: 10</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="prune-fixed-effect-predictors">Prune fixed-effect predictors<a class="anchor" aria-label="anchor" href="#prune-fixed-effect-predictors"></a>
</h4>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract fixed-effect predictors (x1-x5)</span></span>
<span><span class="va">fixed_effects</span> <span class="op">&lt;-</span> <span class="va">longitudinal_example</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^x[0-9]"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correlation structure of fixed effects:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Correlation structure of fixed effects:</span></span>
<span><span class="va">cor_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">fixed_effects</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cor_fixed</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        x1    x2    x3    x4    x5    x6    x7    x8    x9   x10   x11   x12</span></span>
<span><span class="co">#&gt; x1   1.00  0.43  0.32  0.16  0.22  0.07  0.04  0.04  0.01  0.06  0.04  0.11</span></span>
<span><span class="co">#&gt; x2   0.43  1.00  0.41  0.24  0.22  0.14  0.14  0.12  0.03  0.10 -0.05  0.01</span></span>
<span><span class="co">#&gt; x3   0.32  0.41  1.00  0.50  0.41  0.26  0.16  0.10  0.05  0.06 -0.08  0.00</span></span>
<span><span class="co">#&gt; x4   0.16  0.24  0.50  1.00  0.52  0.37  0.22  0.19  0.14  0.14 -0.17 -0.05</span></span>
<span><span class="co">#&gt; x5   0.22  0.22  0.41  0.52  1.00  0.47  0.35  0.30  0.26  0.17 -0.06  0.05</span></span>
<span><span class="co">#&gt; x6   0.07  0.14  0.26  0.37  0.47  1.00  0.49  0.41  0.34  0.25 -0.09  0.06</span></span>
<span><span class="co">#&gt; x7   0.04  0.14  0.16  0.22  0.35  0.49  1.00  0.49  0.35  0.21 -0.14  0.00</span></span>
<span><span class="co">#&gt; x8   0.04  0.12  0.10  0.19  0.30  0.41  0.49  1.00  0.52  0.42 -0.25 -0.02</span></span>
<span><span class="co">#&gt; x9   0.01  0.03  0.05  0.14  0.26  0.34  0.35  0.52  1.00  0.53 -0.09 -0.02</span></span>
<span><span class="co">#&gt; x10  0.06  0.10  0.06  0.14  0.17  0.25  0.21  0.42  0.53  1.00 -0.17 -0.03</span></span>
<span><span class="co">#&gt; x11  0.04 -0.05 -0.08 -0.17 -0.06 -0.09 -0.14 -0.25 -0.09 -0.17  1.00  0.37</span></span>
<span><span class="co">#&gt; x12  0.11  0.01  0.00 -0.05  0.05  0.06  0.00 -0.02 -0.02 -0.03  0.37  1.00</span></span>
<span><span class="co">#&gt; x13  0.01 -0.07 -0.05  0.00 -0.03 -0.08 -0.07 -0.17 -0.02  0.04  0.13  0.32</span></span>
<span><span class="co">#&gt; x14 -0.19 -0.05  0.05  0.07  0.11  0.16  0.08  0.14  0.12  0.11 -0.06  0.12</span></span>
<span><span class="co">#&gt; x15 -0.04  0.11  0.15  0.20  0.30  0.31  0.24  0.25  0.25  0.11 -0.11  0.04</span></span>
<span><span class="co">#&gt; x16 -0.04  0.02  0.05  0.10  0.20  0.17  0.20  0.17  0.21  0.17 -0.15  0.06</span></span>
<span><span class="co">#&gt; x17  0.02  0.09  0.15  0.12  0.22  0.26  0.36  0.29  0.31  0.26 -0.14 -0.01</span></span>
<span><span class="co">#&gt; x18 -0.07  0.03  0.03  0.16  0.19  0.15  0.21  0.23  0.08  0.05 -0.08 -0.06</span></span>
<span><span class="co">#&gt; x19 -0.03 -0.02 -0.05  0.06  0.13  0.03  0.09  0.12 -0.04  0.02 -0.05 -0.03</span></span>
<span><span class="co">#&gt; x20 -0.06 -0.09 -0.05 -0.11  0.05 -0.05 -0.04  0.01 -0.12 -0.04 -0.07 -0.14</span></span>
<span><span class="co">#&gt;       x13   x14   x15   x16   x17   x18   x19   x20</span></span>
<span><span class="co">#&gt; x1   0.01 -0.19 -0.04 -0.04  0.02 -0.07 -0.03 -0.06</span></span>
<span><span class="co">#&gt; x2  -0.07 -0.05  0.11  0.02  0.09  0.03 -0.02 -0.09</span></span>
<span><span class="co">#&gt; x3  -0.05  0.05  0.15  0.05  0.15  0.03 -0.05 -0.05</span></span>
<span><span class="co">#&gt; x4   0.00  0.07  0.20  0.10  0.12  0.16  0.06 -0.11</span></span>
<span><span class="co">#&gt; x5  -0.03  0.11  0.30  0.20  0.22  0.19  0.13  0.05</span></span>
<span><span class="co">#&gt; x6  -0.08  0.16  0.31  0.17  0.26  0.15  0.03 -0.05</span></span>
<span><span class="co">#&gt; x7  -0.07  0.08  0.24  0.20  0.36  0.21  0.09 -0.04</span></span>
<span><span class="co">#&gt; x8  -0.17  0.14  0.25  0.17  0.29  0.23  0.12  0.01</span></span>
<span><span class="co">#&gt; x9  -0.02  0.12  0.25  0.21  0.31  0.08 -0.04 -0.12</span></span>
<span><span class="co">#&gt; x10  0.04  0.11  0.11  0.17  0.26  0.05  0.02 -0.04</span></span>
<span><span class="co">#&gt; x11  0.13 -0.06 -0.11 -0.15 -0.14 -0.08 -0.05 -0.07</span></span>
<span><span class="co">#&gt; x12  0.32  0.12  0.04  0.06 -0.01 -0.06 -0.03 -0.14</span></span>
<span><span class="co">#&gt; x13  1.00  0.37  0.14  0.20  0.02 -0.13 -0.06 -0.26</span></span>
<span><span class="co">#&gt; x14  0.37  1.00  0.45  0.26  0.08  0.01  0.07 -0.14</span></span>
<span><span class="co">#&gt; x15  0.14  0.45  1.00  0.41  0.24  0.15  0.11 -0.12</span></span>
<span><span class="co">#&gt; x16  0.20  0.26  0.41  1.00  0.34  0.30  0.16 -0.11</span></span>
<span><span class="co">#&gt; x17  0.02  0.08  0.24  0.34  1.00  0.29  0.18  0.02</span></span>
<span><span class="co">#&gt; x18 -0.13  0.01  0.15  0.30  0.29  1.00  0.32  0.09</span></span>
<span><span class="co">#&gt; x19 -0.06  0.07  0.11  0.16  0.18  0.32  1.00  0.33</span></span>
<span><span class="co">#&gt; x20 -0.26 -0.14 -0.12 -0.11  0.02  0.09  0.33  1.00</span></span>
<span></span>
<span><span class="co"># Prune correlated predictors</span></span>
<span><span class="va">pruned_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span><span class="va">fixed_effects</span>, threshold <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"\n\nFixed effects: %d → %d variables\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fixed_effects</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">pruned_fixed</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects: 20 → 20 variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Retained predictors:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pruned_fixed</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Retained predictors: x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 x13 x14 x15 x16 x17 x18 x19 x20</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fit-models-with-standard-lm-simplified-example">Fit models with standard lm (simplified example)<a class="anchor" aria-label="anchor" href="#fit-models-with-standard-lm-simplified-example"></a>
</h4>
<p>For demonstration, we’ll use standard linear models. In practice,
you’d use lme4::lmer() or nlme::lme() with random effects.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data for full model</span></span>
<span><span class="va">full_data</span> <span class="op">&lt;-</span> <span class="va">longitudinal_example</span></span>
<span></span>
<span><span class="co"># Prepare data for pruned model</span></span>
<span><span class="va">pruned_data</span> <span class="op">&lt;-</span> <span class="va">longitudinal_example</span></span>
<span><span class="va">pruned_data</span> <span class="op">&lt;-</span> <span class="va">pruned_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"subject"</span>, <span class="st">"site"</span>, <span class="st">"outcome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pruned_fixed</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit simple linear models (ignoring clustering for demonstration)</span></span>
<span><span class="va">model_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span> <span class="op">+</span> <span class="va">x5</span>, data <span class="op">=</span> <span class="va">full_data</span><span class="op">)</span></span>
<span><span class="va">model_pruned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">pruned_data</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>  <span class="co"># Exclude subject, site</span></span>
<span></span>
<span><span class="co"># Compare</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nModel Comparison:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Comparison:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Full model R²: %.3f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_full</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Full model R²: 0.156</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Pruned model R²: %.3f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_pruned</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Pruned model R²: 0.279</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="coefficient-stability-comparison">Coefficient stability comparison<a class="anchor" aria-label="anchor" href="#coefficient-stability-comparison"></a>
</h4>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract coefficients</span></span>
<span><span class="va">coef_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model_full</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">coef_pruned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model_pruned</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Compare for common variables</span></span>
<span><span class="va">common</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef_full</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef_pruned</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">coef_full</span><span class="op">[</span><span class="va">common</span><span class="op">]</span>,</span>
<span>        las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Full Model (5 predictors)"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Coefficient"</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">coef_pruned</span>,</span>
<span>        las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Pruned Model"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Coefficient"</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/unnamed-chunk-25-1.png" width="960"></p>
</div>
<div class="section level4">
<h4 id="final-deliverable-3">Final Deliverable<a class="anchor" aria-label="anchor" href="#final-deliverable-3"></a>
</h4>
<p>Here’s what you’d use in practice for mixed models:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Longitudinal Data Analysis Summary:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Longitudinal Data Analysis Summary:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Fixed effects retained: %d (from 5)\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">pruned_fixed</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Fixed effects retained: 20 (from 5)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Predictors:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pruned_fixed</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Predictors: x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15, x16, x17, x18, x19, x20</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nNext steps for production mixed model:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Next steps for production mixed model:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  1. Use retained predictors:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pruned_fixed</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   1. Use retained predictors: x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15, x16, x17, x18, x19, x20</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  2. Fit mixed model with random effects:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   2. Fit mixed model with random effects:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"     Example: lme4::lmer(outcome ~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pruned_fixed</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span>,</span>
<span>    <span class="st">"+ (1|subject) + (1|site))\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Example: lme4::lmer(outcome ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11 + x12 + x13 + x14 + x15 + x16 + x17 + x18 + x19 + x20 + (1|subject) + (1|site))</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  3. Random effects preserved: (1|subject) and (1|site)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   3. Random effects preserved: (1|subject) and (1|site)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  4. Benefit: Interpretable fixed effects + proper correlation structure\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   4. Benefit: Interpretable fixed effects + proper correlation structure</span></span></code></pre></div>
<p><strong>Key takeaway</strong>: For longitudinal and hierarchical
data, prune correlated fixed-effect predictors <strong>before</strong>
fitting the mixed model using <code><a href="../reference/corrPrune.html">corrPrune()</a></code>. This simplifies
VIF computation (which is complex in mixed models) while achieving the
same goal: interpretable fixed effects. The random-effect structure
remains intact, properly modeling within-subject or within-cluster
correlation. In practice, use the retained predictors with lme4::lmer()
or nlme::lme() for the final model.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<div class="section level3">
<h3 id="workflow-comparison">Workflow Comparison<a class="anchor" aria-label="anchor" href="#workflow-comparison"></a>
</h3>
<table style="width:100%;" class="table">
<colgroup>
<col width="16%">
<col width="18%">
<col width="20%">
<col width="28%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th>Domain</th>
<th>Problem</th>
<th>Strategy</th>
<th>Key Function</th>
<th>Result</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Ecology</strong></td>
<td>19 correlated climate vars</td>
<td>Two-stage pruning</td>
<td>corrPrune() → modelPrune()</td>
<td>19 → 6 vars; 90% R² retained</td>
</tr>
<tr class="even">
<td><strong>Survey</strong></td>
<td>33 redundant items + demographics</td>
<td>Protected variables</td>
<td>corrPrune(force_in = “age”)</td>
<td>33 → 10 items; construct balance maintained</td>
</tr>
<tr class="odd">
<td><strong>Genomics</strong></td>
<td>200 genes, 100 samples (p ≫ n)</td>
<td>Fast approximation</td>
<td>corrPrune(mode = “greedy”)</td>
<td>200 → 120 genes; 80% accuracy</td>
</tr>
<tr class="even">
<td><strong>Longitudinal</strong></td>
<td>5 correlated fixed effects</td>
<td>Pre-prune predictors</td>
<td>corrPrune() before mixed model</td>
<td>5 → 3 predictors; random effects intact</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="key-lessons">Key Lessons<a class="anchor" aria-label="anchor" href="#key-lessons"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Two-stage pruning</strong> (correlation → VIF) works well
when you need regression diagnostics</li>
<li>
<strong>Protected variables</strong> (<code>force_in</code>) balance
statistical and domain requirements</li>
<li>
<strong>Greedy mode</strong> enables high-dimensional problems where
exact mode is infeasible</li>
<li>
<strong>Pre-pruning</strong> fixed effects simplifies mixed model
multicollinearity</li>
</ol>
</div>
<div class="section level3">
<h3 id="choosing-mode-exact-vs-greedy">Choosing Mode: Exact vs Greedy<a class="anchor" aria-label="anchor" href="#choosing-mode-exact-vs-greedy"></a>
</h3>
<table class="table">
<caption>Mode Selection Guide</caption>
<colgroup>
<col width="19%">
<col width="25%">
<col width="35%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="left">Criterion</th>
<th align="left">Exact</th>
<th align="left">Greedy</th>
<th align="left">Auto</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Problem size (p)</td>
<td align="left">p ≤ 25</td>
<td align="left">p &gt; 50</td>
<td align="left">Any</td>
</tr>
<tr class="even">
<td align="left">Goal</td>
<td align="left">Reproducible research</td>
<td align="left">Exploratory analysis</td>
<td align="left">Adaptive</td>
</tr>
<tr class="odd">
<td align="left">Runtime</td>
<td align="left">Seconds to minutes</td>
<td align="left">&lt; 1 second</td>
<td align="left">Smart switching</td>
</tr>
<tr class="even">
<td align="left">Optimality</td>
<td align="left">Guaranteed</td>
<td align="left">Approximate</td>
<td align="left">Depends on p</td>
</tr>
<tr class="odd">
<td align="left">Use case</td>
<td align="left">Publications, reports</td>
<td align="left">Biomarker discovery, screening</td>
<td align="left">General workflows</td>
</tr>
</tbody>
</table>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li>
<code><a href="../articles/quickstart.html">vignette("quickstart")</a></code> - Interface overview</li>
<li>
<code><a href="../articles/advanced.html">vignette("advanced")</a></code> - Custom engines and algorithmic
control</li>
<li>
<code><a href="../articles/comparison.html">vignette("comparison")</a></code> - Comparison with
alternatives</li>
<li>
<code><a href="../articles/theory.html">vignette("theory")</a></code> - Mathematical foundations</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p><strong>Thresholds</strong>: - O’Brien, R. M. (2007). A caution
regarding rules of thumb for variance inflation factors. <em>Quality
&amp; Quantity</em>, 41(5), 673-690. - Dormann, C. F., et al. (2013).
Collinearity: a review of methods to deal with it. <em>Ecography</em>,
36(1), 27-46.</p>
<p><strong>Methods</strong>: - See package documentation and JOSS paper
for algorithm details</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gilles Colling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
