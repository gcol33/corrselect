<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Complete Workflows: Real-World Examples • corrselect</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Complete Workflows: Real-World Examples">
</head>
<body>
<p>








  pkgdown/mathjax-config.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">corrselect</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/quickstart.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/quickstart.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/workflows.html">Workflows</a></li>
    <li><a class="dropdown-item" href="../articles/comparison.html">Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/advanced.html">Advanced</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">Theory</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gcol33/corrselect" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Complete Workflows: Real-World Examples</h1>
                        <h4 data-toc-skip class="author">Gilles
Colling</h4>
            
            <h4 data-toc-skip class="date">2026-02-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gcol33/corrselect/blob/HEAD/vignettes/workflows.Rmd" class="external-link"><code>vignettes/workflows.Rmd</code></a></small>
      <div class="d-none name"><code>workflows.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>This vignette demonstrates integration of corrselect into complete
modeling workflows, from raw predictors to final models under
correlation constraints. Four applied settings illustrate interface
selection and workflow composition. See
<code><a href="../articles/quickstart.html">vignette("quickstart")</a></code> for interface descriptions and
<code><a href="../articles/theory.html">vignette("theory")</a></code> for mathematical foundations.</p>
<p><strong>Functions used</strong>: <code><a href="../reference/corrPrune.html">corrPrune()</a></code>,
<code><a href="../reference/modelPrune.html">modelPrune()</a></code>, see <code><a href="../articles/quickstart.html">vignette("quickstart")</a></code> for
full signatures and parameter details.</p>
<p>Each workflow showcases different aspects of the package:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Ecological Modeling</strong>: Two-stage pruning
(correlation + VIF) for environmental predictors</p></li>
<li><p><strong>Survey Data</strong>: Protecting key variables while
reducing redundancy in questionnaires</p></li>
<li><p><strong>High-Dimensional Data</strong>: Greedy algorithms for
gene expression (p &gt;&gt; n scenarios)</p></li>
<li><p><strong>Mixed Models</strong>: VIF-based pruning of fixed effects
in hierarchical data</p></li>
</ol>
<hr>
</div>
<div class="section level2">
<h2 id="workflow-1-ecological-modeling">Workflow 1: Ecological Modeling<a class="anchor" aria-label="anchor" href="#workflow-1-ecological-modeling"></a>
</h2>
<p><strong>Goal</strong>: Build an interpretable species distribution
model from highly correlated bioclimatic variables.</p>
<p><strong>Challenge</strong>: WorldClim’s 19 bioclimatic variables
contain many temperature and precipitation metrics that are
mathematically related (e.g., mean temperature, minimum temperature,
maximum temperature). Using all variables leads to multicollinearity,
unstable coefficients, and poor model interpretation.</p>
<p><strong>Strategy</strong>: Two-stage pruning:</p>
<ol style="list-style-type: decimal">
<li><p><code><a href="../reference/corrPrune.html">corrPrune()</a></code> removes pairwise correlations &gt;
0.7</p></li>
<li><p><code><a href="../reference/modelPrune.html">modelPrune()</a></code> refines further using variance
inflation factors (VIF)</p></li>
</ol>
<p>This approach balances model fit with interpretability and numerical
stability.</p>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 100  20</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "species_richness" "BIO1"             "BIO2"             "BIO3"            </span></span>
<span><span class="co">#&gt; [5] "BIO4"             "BIO5"</span></span>
<span></span>
<span><span class="co"># Response variable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">$</span><span class="va">species_richness</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;     5.0    96.0   118.5   120.2   144.2   206.0</span></span></code></pre></div>
<p>The dataset contains 100 sampling locations with 19 bioclimatic
predictors and a species richness response. The bioclimatic variables
are standard WorldClim metrics (BIO1-BIO19) measuring temperature and
precipitation patterns.</p>
</div>
<div class="section level4">
<h4 id="correlation-based-pruning">Correlation-based pruning<a class="anchor" aria-label="anchor" href="#correlation-based-pruning"></a>
</h4>
<p>We start by removing variables with pairwise correlations exceeding
0.7. The <code>mode = "auto"</code> setting uses the exact algorithm
(Bron-Kerbosch) to enumerate all maximal subsets, then selects the
largest one.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove highly correlated predictors</span></span>
<span><span class="va">bio_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">bioclim_example</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># Exclude response</span></span>
<span>  threshold <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"auto"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># How much did we reduce?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Reduced from %d → %d variables\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">bio_clean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reduced from 19 → 12 variables</span></span>
<span></span>
<span><span class="co"># Which variables were kept?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">bio_clean</span>, <span class="st">"selected_vars"</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "BIO1"  "BIO3"  "BIO6"  "BIO9"  "BIO11" "BIO12" "BIO13" "BIO14" "BIO16"</span></span>
<span><span class="co">#&gt; [10] "BIO17"</span></span></code></pre></div>
<p>The pruning successfully reduced dimensionality while ensuring no
remaining pair exceeds the 0.7 threshold. The selected variables span
both temperature and precipitation domains, maintaining ecological
interpretability.</p>
</div>
<div class="section level4">
<h4 id="correlation-distribution">Correlation distribution<a class="anchor" aria-label="anchor" href="#correlation-distribution"></a>
</h4>
<p>The histogram below shows how <code><a href="../reference/corrPrune.html">corrPrune()</a></code> reshapes the
correlation structure. Before pruning (red), many variable pairs exceed
the 0.7 threshold. After pruning (blue), all pairwise correlations fall
below the threshold.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor_before</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">cor_after</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">bio_clean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vals_before</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_before</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">cor_before</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">vals_after</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_after</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">cor_after</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Common x limits</span></span>
<span><span class="va">xlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Shared breaks for fair comparison</span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Before histogram</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">vals_before</span>,</span>
<span>     breaks <span class="op">=</span> <span class="va">breaks</span>,</span>
<span>     freq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Distribution of Absolute Correlations"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Absolute Correlation"</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="va">xlim</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># After histogram</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">vals_after</span>,</span>
<span>     breaks <span class="op">=</span> <span class="va">breaks</span>,</span>
<span>     freq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>     add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Threshold line</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0.7</span>, col <span class="op">=</span> <span class="st">"black"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before"</span>, <span class="st">"After"</span>, <span class="st">"Threshold"</span><span class="op">)</span>,</span>
<span>       fill   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>                  <span class="cn">NA</span><span class="op">)</span>,</span>
<span>       border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"white"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>       lty    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       lwd    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       col    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"black"</span><span class="op">)</span>,</span>
<span>       bty    <span class="op">=</span> <span class="st">"o"</span>,</span>
<span>       bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<p><div class="svg-container"><button type="button" class="btn btn-primary btn-copy-svg" title="Copy SVG to clipboard" aria-label="Copy SVG to clipboard" data-bs-toggle="tooltip" data-bs-placement="left"><i class="fa fa-copy"></i></button>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='504.00pt' height='360.00pt' viewBox='0 0 504.00 360.00' class="r-plt inline-svg" style="max-width:100%;width:100%;height:auto;">
<g class='svglite'>
<defs>
  <style type='text/css'><![CDATA[
    /* theme-aware-processed */
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite circle {
      fill: none;
      stroke: #3E3F3A;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite > g > rect {
      fill: none;
      stroke: #3E3F3A;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
      fill: #3E3F3A;
    }
    .svglite g.glyphgroup path {
      fill: inherit;
      stroke: none;
    }
  ]]></style>
</defs>
<rect width='100%' height='100%' style='stroke: none; fill: #F5F6F8;'/>
<defs>
  <clipPath id='cpMC4wMHw1MDQuMDB8MC4wMHwzNjAuMDA='>
    <rect x='0.00' y='0.00' width='504.00' height='360.00' />
  </clipPath>
</defs>
<g clip-path='url(#cpMC4wMHw1MDQuMDB8MC4wMHwzNjAuMDA=)'>
<text x='266.40' y='34.67' text-anchor='middle' style='font-size: 14.40px; font-weight: bold; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='252.17px' lengthAdjust='spacingAndGlyphs'>Distribution of Absolute Correlations</text>
<text x='266.40' y='341.28' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='108.72px' lengthAdjust='spacingAndGlyphs'>Absolute Correlation</text>
<text transform='translate(12.96,172.80) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='40.02px' lengthAdjust='spacingAndGlyphs'>Density</text>
<line x1='74.40' y1='286.56' x2='458.40' y2='286.56' style='stroke-width: 0.75;' />
<line x1='74.40' y1='286.56' x2='74.40' y2='293.76' style='stroke-width: 0.75;' />
<line x1='151.20' y1='286.56' x2='151.20' y2='293.76' style='stroke-width: 0.75;' />
<line x1='228.00' y1='286.56' x2='228.00' y2='293.76' style='stroke-width: 0.75;' />
<line x1='304.80' y1='286.56' x2='304.80' y2='293.76' style='stroke-width: 0.75;' />
<line x1='381.60' y1='286.56' x2='381.60' y2='293.76' style='stroke-width: 0.75;' />
<line x1='458.40' y1='286.56' x2='458.40' y2='293.76' style='stroke-width: 0.75;' />
<text x='74.40' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.0</text>
<text x='151.20' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.2</text>
<text x='228.00' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.4</text>
<text x='304.80' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.6</text>
<text x='381.60' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.8</text>
<text x='458.40' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>1.0</text>
<line x1='59.04' y1='278.13' x2='59.04' y2='89.92' style='stroke-width: 0.75;' />
<line x1='59.04' y1='278.13' x2='51.84' y2='278.13' style='stroke-width: 0.75;' />
<line x1='59.04' y1='240.49' x2='51.84' y2='240.49' style='stroke-width: 0.75;' />
<line x1='59.04' y1='202.85' x2='51.84' y2='202.85' style='stroke-width: 0.75;' />
<line x1='59.04' y1='165.21' x2='51.84' y2='165.21' style='stroke-width: 0.75;' />
<line x1='59.04' y1='127.56' x2='51.84' y2='127.56' style='stroke-width: 0.75;' />
<line x1='59.04' y1='89.92' x2='51.84' y2='89.92' style='stroke-width: 0.75;' />
<text transform='translate(41.76,278.13) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>0</text>
<text transform='translate(41.76,240.49) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>1</text>
<text transform='translate(41.76,202.85) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>2</text>
<text transform='translate(41.76,165.21) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>3</text>
<text transform='translate(41.76,127.56) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>4</text>
<text transform='translate(41.76,89.92) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>5</text>
</g>
<defs>
  <clipPath id='cpNTkuMDR8NDczLjc2fDU5LjA0fDI4Ni41Ng=='>
    <rect x='59.04' y='59.04' width='414.72' height='227.52' />
  </clipPath>
</defs>
<g clip-path='url(#cpNTkuMDR8NDczLjc2fDU5LjA0fDI4Ni41Ng==)'>
<rect x='74.40' y='67.47' width='13.24' height='210.67' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='87.64' y='80.23' width='13.24' height='197.90' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='100.88' y='182.38' width='13.24' height='95.76' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='114.12' y='195.14' width='13.24' height='82.99' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='127.37' y='252.60' width='13.24' height='25.54' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='140.61' y='265.37' width='13.24' height='12.77' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='153.85' y='258.98' width='13.24' height='19.15' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='167.09' y='258.98' width='13.24' height='19.15' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='180.33' y='246.21' width='13.24' height='31.92' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='193.57' y='252.60' width='13.24' height='25.54' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='206.81' y='252.60' width='13.24' height='25.54' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='220.06' y='233.45' width='13.24' height='44.69' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='233.30' y='258.98' width='13.24' height='19.15' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='246.54' y='239.83' width='13.24' height='38.30' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='259.78' y='233.45' width='13.24' height='44.69' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='273.02' y='265.37' width='13.24' height='12.77' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='286.26' y='265.37' width='13.24' height='12.77' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='299.50' y='258.98' width='13.24' height='19.15' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='312.74' y='252.60' width='13.24' height='25.54' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='325.99' y='233.45' width='13.24' height='44.69' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='339.23' y='258.98' width='13.24' height='19.15' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='352.47' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='365.71' y='258.98' width='13.24' height='19.15' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='378.95' y='233.45' width='13.24' height='44.69' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='392.19' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='405.43' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='418.68' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='431.92' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='445.16' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='74.40' y='46.57' width='13.24' height='231.56' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='87.64' y='13.49' width='13.24' height='264.64' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='100.88' y='195.43' width='13.24' height='82.70' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='114.12' y='211.97' width='13.24' height='66.16' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='127.37' y='228.51' width='13.24' height='49.62' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='140.61' y='261.59' width='13.24' height='16.54' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='153.85' y='245.05' width='13.24' height='33.08' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='167.09' y='261.59' width='13.24' height='16.54' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='180.33' y='245.05' width='13.24' height='33.08' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='193.57' y='228.51' width='13.24' height='49.62' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='206.81' y='245.05' width='13.24' height='33.08' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='220.06' y='245.05' width='13.24' height='33.08' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='233.30' y='261.59' width='13.24' height='16.54' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='246.54' y='261.59' width='13.24' height='16.54' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='259.78' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='273.02' y='245.05' width='13.24' height='33.08' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='286.26' y='245.05' width='13.24' height='33.08' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='299.50' y='261.59' width='13.24' height='16.54' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='312.74' y='261.59' width='13.24' height='16.54' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='325.99' y='228.51' width='13.24' height='49.62' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='339.23' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='352.47' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='365.71' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='378.95' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='392.19' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='405.43' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='418.68' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='431.92' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='445.16' y='278.13' width='13.24' height='0.00' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<line x1='343.20' y1='286.56' x2='343.20' y2='59.04' style='stroke-width: 1.50; stroke-dasharray: 8.00,8.00;' />
<rect rx='4' x='363.16' y='59.04' width='110.60' height='57.60' style='stroke-width: 0.75; stroke: #DFD7CA; fill: #F5F6F8;' />
<rect x='373.96' y='69.84' width='8.64' height='7.20' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.40;' />
<rect x='373.96' y='84.24' width='8.64' height='7.20' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.40;' />
<rect x='373.96' y='98.64' width='8.64' height='7.20' style='stroke-width: 0.75; stroke: none;' /> fill: #F5F6F8;' />
<line x1='382.60' y1='102.24' x2='404.20' y2='102.24' style='stroke-width: 1.50; stroke-dasharray: 8.00,8.00;' />
<text x='415.00' y='77.74' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='35.34px' lengthAdjust='spacingAndGlyphs'>Before</text>
<text x='415.00' y='92.14' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='25.33px' lengthAdjust='spacingAndGlyphs'>After</text>
<text x='415.00' y='106.54' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='53.36px' lengthAdjust='spacingAndGlyphs'>Threshold</text>
</g>
</g>
</svg></div></p>
</div>
<div class="section level4">
<h4 id="fit-models">Fit models<a class="anchor" aria-label="anchor" href="#fit-models"></a>
</h4>
<p>We fit three models to compare the effect of pruning:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Full model</strong>: All 19 bioclimatic variables
(baseline)</p></li>
<li><p><strong>After corrPrune</strong>: Variables with correlations
&lt; 0.7</p></li>
<li><p><strong>After modelPrune</strong>: Further refined using VIF &lt;
5</p></li>
</ol>
<p>The VIF criterion complements correlation-based pruning by detecting
multicollinearity involving more than two variables simultaneously.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model 1: Full model (19 variables)</span></span>
<span><span class="va">model_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bioclim_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model 2: After corrPrune (correlation-based pruning)</span></span>
<span><span class="va">bio_clean_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  species_richness <span class="op">=</span> <span class="va">bioclim_example</span><span class="op">$</span><span class="va">species_richness</span>,</span>
<span>  <span class="va">bio_clean</span></span>
<span><span class="op">)</span></span>
<span><span class="va">model_corrprune</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bio_clean_full</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model 3: Sequential VIF-based refinement</span></span>
<span><span class="va">bio_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modelPrune.html">modelPrune</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>  data <span class="op">=</span> <span class="va">bio_clean_full</span>,</span>
<span>  limit <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span><span class="va">model_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">bio_final</span>, <span class="st">"final_model"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h4>
<p>The table below shows that pruning dramatically improves numerical
stability (condition number κ) while maintaining model fit (adjusted
R²). A lower κ indicates better-conditioned matrices and more stable
coefficient estimates.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Variable counts</span></span>
<span><span class="va">n_full</span>      <span class="op">&lt;-</span> <span class="fl">19</span></span>
<span><span class="va">n_corrprune</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">bio_clean</span>, <span class="st">"selected_vars"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">n_final</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">bio_final</span>, <span class="st">"selected_vars"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute condition numbers (measure of collinearity)</span></span>
<span><span class="va">X_full</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">model_full</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">X_corrprune</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">model_corrprune</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">X_final</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">model_final</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">kappa_full</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/kappa.html" class="external-link">kappa</a></span><span class="op">(</span><span class="va">X_full</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">kappa_corrprune</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/kappa.html" class="external-link">kappa</a></span><span class="op">(</span><span class="va">X_corrprune</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">kappa_final</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/kappa.html" class="external-link">kappa</a></span><span class="op">(</span><span class="va">X_final</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary table</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Full"</span>, <span class="st">"corrPrune"</span>, <span class="st">"+ modelPrune"</span><span class="op">)</span>,</span>
<span>  Predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n_full</span>, <span class="va">n_corrprune</span>, <span class="va">n_final</span><span class="op">)</span>,</span>
<span>  Adj_R2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_full</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_corrprune</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_final</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">kappa_full</span>, <span class="va">kappa_corrprune</span>, <span class="va">kappa_final</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span>
<span><span class="co">#&gt;           Step Predictors    Adj_R2    Kappa</span></span>
<span><span class="co">#&gt; 1         Full         19 0.9821862 914.8146</span></span>
<span><span class="co">#&gt; 2    corrPrune         12 0.8962848 538.1157</span></span>
<span><span class="co">#&gt; 3 + modelPrune         12 0.8962848 538.1157</span></span></code></pre></div>
<p><strong>Key insights</strong>:</p>
<ul>
<li><p>The full model has substantial multicollinearity (high
κ)</p></li>
<li><p>Correlation-based pruning reduces κ while losing minimal
fit</p></li>
<li><p>VIF-based refinement can further improve stability with only
marginal R² decrease</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h4>
<p>The plot below illustrates the pruning tradeoff: as we remove
variables, condition number (κ) drops dramatically while adjusted R²
remains high. This demonstrates that many of the original 19 variables
were redundant for prediction.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract data</span></span>
<span><span class="va">n_vars</span> <span class="op">&lt;-</span> <span class="va">comparison</span><span class="op">$</span><span class="va">Predictors</span></span>
<span><span class="va">adj_r2</span> <span class="op">&lt;-</span> <span class="va">comparison</span><span class="op">$</span><span class="va">Adj_R2</span></span>
<span><span class="va">kappa</span>  <span class="op">&lt;-</span> <span class="va">comparison</span><span class="op">$</span><span class="va">Kappa</span></span>
<span></span>
<span><span class="co"># Left y-axis: Adjusted R²</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>  <span class="co"># extra space on the right for second axis</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">n_vars</span>, <span class="va">adj_r2</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"b"</span>,</span>
<span>  pch  <span class="op">=</span> <span class="fl">19</span>,</span>
<span>  cex  <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  col  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  lwd  <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Number of Predictors"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Adjusted R²"</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Pruning Reduces Collinearity While Preserving Fit"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Right y-axis: log10(κ)</span></span>
<span><span class="va">log_kappa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Nice ylim for log10(κ)</span></span>
<span><span class="va">ylim_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">log_kappa</span>, finite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ylim_right</span> <span class="op">&lt;-</span> <span class="va">ylim_right</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">1.1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">n_vars</span>, <span class="va">log_kappa</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"b"</span>,</span>
<span>  pch  <span class="op">=</span> <span class="fl">17</span>,</span>
<span>  cex  <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  col  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  lwd  <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  xaxt <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  yaxt <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>  ylim <span class="op">=</span> <span class="va">ylim_right</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Right-hand axis ticks using pretty() on log scale</span></span>
<span><span class="va">log_ticks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="va">log_kappa</span><span class="op">)</span></span>
<span><span class="va">kappa_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="va">log_ticks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">4</span>, at <span class="op">=</span> <span class="va">log_ticks</span>, labels <span class="op">=</span> <span class="va">kappa_labels</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Condition Number (κ)"</span>, side <span class="op">=</span> <span class="fl">4</span>, line <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Legend centered at top</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"top"</span>,</span>
<span>  inset <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Adjusted R² (higher better)"</span>, <span class="st">"κ (lower better)"</span><span class="op">)</span>,</span>
<span>  col    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  pch    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fl">17</span><span class="op">)</span>,</span>
<span>  lwd    <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  horiz  <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bty    <span class="op">=</span> <span class="st">"o"</span>,</span>
<span>  bg <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  x.intersp <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><div class="svg-container"><button type="button" class="btn btn-primary btn-copy-svg" title="Copy SVG to clipboard" aria-label="Copy SVG to clipboard" data-bs-toggle="tooltip" data-bs-placement="left"><i class="fa fa-copy"></i></button>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='576.00pt' height='360.00pt' viewBox='0 0 576.00 360.00' class="r-plt inline-svg" style="max-width:100%;width:100%;height:auto;">
<g class='svglite'>
<defs>
  <style type='text/css'><![CDATA[
    /* theme-aware-processed */
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite circle {
      fill: none;
      stroke: #3E3F3A;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite > g > rect {
      fill: none;
      stroke: #3E3F3A;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
      fill: #3E3F3A;
    }
    .svglite g.glyphgroup path {
      fill: inherit;
      stroke: none;
    }
  ]]></style>
</defs>
<rect width='100%' height='100%' style='stroke: none; fill: #F5F6F8;'/>
<defs>
  <clipPath id='cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA='>
    <rect x='0.00' y='0.00' width='576.00' height='360.00' />
  </clipPath>
</defs>
<g clip-path='url(#cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA=)'>
</g>
<defs>
  <clipPath id='cpNTcuNjB8NTE4LjQwfDU3LjYwfDI4OC4wMA=='>
    <rect x='57.60' y='57.60' width='460.80' height='230.40' />
  </clipPath>
</defs>
<g clip-path='url(#cpNTcuNjB8NTE4LjQwfDU3LjYwfDI4OC4wMA==)'>
<line x1='494.14' y1='70.24' x2='81.86' y2='87.95' style='stroke-width: 1.50; stroke: #3380CC;' />
<circle cx='501.33' cy='69.93' r='4.05' style='stroke-width: 1.50; stroke: #3380CC; fill: #3380CC;' />
<circle cx='74.67' cy='88.26' r='4.05' style='stroke-width: 1.50; stroke: #3380CC; fill: #3380CC;' />
<circle cx='74.67' cy='88.26' r='4.05' style='stroke-width: 1.50; stroke: #3380CC; fill: #3380CC;' />
</g>
<g clip-path='url(#cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA=)'>
<line x1='74.67' y1='288.00' x2='501.33' y2='288.00' style='stroke-width: 0.75;' />
<line x1='74.67' y1='288.00' x2='74.67' y2='295.20' style='stroke-width: 0.75;' />
<line x1='135.62' y1='288.00' x2='135.62' y2='295.20' style='stroke-width: 0.75;' />
<line x1='196.57' y1='288.00' x2='196.57' y2='295.20' style='stroke-width: 0.75;' />
<line x1='257.52' y1='288.00' x2='257.52' y2='295.20' style='stroke-width: 0.75;' />
<line x1='318.48' y1='288.00' x2='318.48' y2='295.20' style='stroke-width: 0.75;' />
<line x1='379.43' y1='288.00' x2='379.43' y2='295.20' style='stroke-width: 0.75;' />
<line x1='440.38' y1='288.00' x2='440.38' y2='295.20' style='stroke-width: 0.75;' />
<line x1='501.33' y1='288.00' x2='501.33' y2='295.20' style='stroke-width: 0.75;' />
<text x='74.67' y='313.92' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>12</text>
<text x='135.62' y='313.92' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>13</text>
<text x='196.57' y='313.92' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>14</text>
<text x='257.52' y='313.92' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>15</text>
<text x='318.48' y='313.92' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>16</text>
<text x='379.43' y='313.92' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>17</text>
<text x='440.38' y='313.92' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>18</text>
<text x='501.33' y='313.92' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>19</text>
<line x1='57.60' y1='279.47' x2='57.60' y2='66.13' style='stroke-width: 0.75;' />
<line x1='57.60' y1='279.47' x2='50.40' y2='279.47' style='stroke-width: 0.75;' />
<line x1='57.60' y1='236.80' x2='50.40' y2='236.80' style='stroke-width: 0.75;' />
<line x1='57.60' y1='194.13' x2='50.40' y2='194.13' style='stroke-width: 0.75;' />
<line x1='57.60' y1='151.47' x2='50.40' y2='151.47' style='stroke-width: 0.75;' />
<line x1='57.60' y1='108.80' x2='50.40' y2='108.80' style='stroke-width: 0.75;' />
<line x1='57.60' y1='66.13' x2='50.40' y2='66.13' style='stroke-width: 0.75;' />
<text transform='translate(40.32,279.47) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.0</text>
<text transform='translate(40.32,236.80) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.2</text>
<text transform='translate(40.32,194.13) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.4</text>
<text transform='translate(40.32,151.47) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.6</text>
<text transform='translate(40.32,108.80) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.8</text>
<text transform='translate(40.32,66.13) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>1.0</text>
<polygon points='57.60,288.00 518.40,288.00 518.40,57.60 57.60,57.60 ' style='stroke-width: 0.75;' />
<text x='288.00' y='33.95' text-anchor='middle' style='font-size: 14.40px; font-weight: bold; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='343.08px' lengthAdjust='spacingAndGlyphs'>Pruning Reduces Collinearity While Preserving Fit</text>
<text x='288.00' y='342.72' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='113.36px' lengthAdjust='spacingAndGlyphs'>Number of Predictors</text>
<text transform='translate(11.52,172.80) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='62.69px' lengthAdjust='spacingAndGlyphs'>Adjusted R²</text>
</g>
<g clip-path='url(#cpNTcuNjB8NTE4LjQwfDU3LjYwfDI4OC4wMA==)'>
<line x1='494.21' y1='146.16' x2='81.79' y2='205.59' style='stroke-width: 1.50; stroke: #CC3333;' />
<polygon points='501.33,138.84 506.79,148.28 495.88,148.28 ' style='stroke-width: 1.50; stroke: none; fill: #CC3333;' />
<polygon points='74.67,200.32 80.12,209.76 69.21,209.76 ' style='stroke-width: 1.50; stroke: none; fill: #CC3333;' />
<polygon points='74.67,200.32 80.12,209.76 69.21,209.76 ' style='stroke-width: 1.50; stroke: none; fill: #CC3333;' />
</g>
<g clip-path='url(#cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA=)'>
<polygon points='57.60,288.00 518.40,288.00 518.40,57.60 57.60,57.60 ' style='stroke-width: 0.75;' />
<line x1='518.40' y1='214.85' x2='518.40' y2='134.82' style='stroke-width: 0.75;' />
<line x1='518.40' y1='214.85' x2='525.60' y2='214.85' style='stroke-width: 0.75;' />
<line x1='518.40' y1='201.51' x2='525.60' y2='201.51' style='stroke-width: 0.75;' />
<line x1='518.40' y1='188.17' x2='525.60' y2='188.17' style='stroke-width: 0.75;' />
<line x1='518.40' y1='174.83' x2='525.60' y2='174.83' style='stroke-width: 0.75;' />
<line x1='518.40' y1='161.50' x2='525.60' y2='161.50' style='stroke-width: 0.75;' />
<line x1='518.40' y1='148.16' x2='525.60' y2='148.16' style='stroke-width: 0.75;' />
<line x1='518.40' y1='134.82' x2='525.60' y2='134.82' style='stroke-width: 0.75;' />
<text transform='translate(544.32,214.85) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='20.02px' lengthAdjust='spacingAndGlyphs'>501</text>
<text transform='translate(544.32,174.83) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='20.02px' lengthAdjust='spacingAndGlyphs'>708</text>
<text transform='translate(544.32,134.82) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='26.69px' lengthAdjust='spacingAndGlyphs'>1000</text>
<text transform='translate(573.12,172.80) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='114.05px' lengthAdjust='spacingAndGlyphs'>Condition Number (κ)</text>
</g>
<g clip-path='url(#cpNTcuNjB8NTE4LjQwfDU3LjYwfDI4OC4wMA==)'>
<rect rx='4' x='110.44' y='62.21' width='355.11' height='28.80' style='stroke-width: 0.75; stroke: #DFD7CA; fill: #F5F6F8;' />
<line x1='113.68' y1='76.61' x2='135.28' y2='76.61' style='stroke-width: 1.50; stroke: #3380CC;' />
<line x1='288.54' y1='76.61' x2='310.14' y2='76.61' style='stroke-width: 1.50; stroke: #CC3333;' />
<circle cx='124.48' cy='76.61' r='2.70' style='stroke-width: 1.50; stroke: #3380CC; fill: #3380CC;' />
<polygon points='299.34,72.41 302.98,78.71 295.70,78.71 ' style='stroke-width: 1.50; stroke: none; fill: #CC3333;' />
<text x='143.92' y='80.91' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='141.38px' lengthAdjust='spacingAndGlyphs'>Adjusted R² (higher better)</text>
<text x='318.78' y='80.91' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='80.02px' lengthAdjust='spacingAndGlyphs'>κ (lower better)</text>
</g>
</g>
</svg></div></p>
</div>
<div class="section level4">
<h4 id="coefficient-stability">Coefficient stability<a class="anchor" aria-label="anchor" href="#coefficient-stability"></a>
</h4>
<p>Multicollinearity inflates coefficient variance, making estimates
unstable. The plot below compares coefficients between the full model
(19 variables) and the final pruned model. Notice how:</p>
<ul>
<li><p>Variables dropped in the pruned model (shown as red-only bars)
had unstable estimates</p></li>
<li><p>Variables retained in both models (overlapping bars) show more
consistent magnitudes</p></li>
<li><p>The pruned model yields clearer, more interpretable effect
sizes</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract coefficients (excluding intercept)</span></span>
<span><span class="va">coef_full</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model_full</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">coef_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model_final</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Use *all* variables (not just common ones)</span></span>
<span><span class="va">all_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/union.html" class="external-link">union</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef_full</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef_final</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Align coefficients to the same full variable list</span></span>
<span><span class="va">vals_full</span>   <span class="op">&lt;-</span> <span class="va">coef_full</span><span class="op">[</span><span class="va">all_vars</span><span class="op">]</span></span>
<span><span class="va">vals_pruned</span> <span class="op">&lt;-</span> <span class="va">coef_final</span><span class="op">[</span><span class="va">all_vars</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Replace missing values (variables dropped in a model) with 0</span></span>
<span><span class="va">vals_full</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">vals_full</span><span class="op">)</span><span class="op">]</span>     <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">vals_pruned</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">vals_pruned</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Colours</span></span>
<span><span class="va">col_full</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">col_pruned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">all_vars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Symmetric Y range</span></span>
<span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vals_full</span>, <span class="va">vals_pruned</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.15</span></span>
<span></span>
<span><span class="co"># Empty plot first</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>, <span class="va">vals_full</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  xaxt <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Coefficient"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Coefficient Comparison (Full vs modelPrune)"</span>,</span>
<span>  ylim <span class="op">=</span> <span class="va">ylim</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="va">x</span>, labels <span class="op">=</span> <span class="va">all_vars</span>, las <span class="op">=</span> <span class="fl">2</span>, cex.axis <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Full model bars</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span> <span class="op">-</span> <span class="fl">0.4</span>, <span class="fl">0</span>,</span>
<span>  <span class="va">x</span> <span class="op">+</span> <span class="fl">0.4</span>, <span class="va">vals_full</span>,</span>
<span>  col <span class="op">=</span> <span class="va">col_full</span>, border <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pruned model bars</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span> <span class="op">-</span> <span class="fl">0.4</span>, <span class="fl">0</span>,</span>
<span>  <span class="va">x</span> <span class="op">+</span> <span class="fl">0.4</span>, <span class="va">vals_pruned</span>,</span>
<span>  col <span class="op">=</span> <span class="va">col_pruned</span>, border <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"topright"</span>,</span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Full (%d vars)"</span>, <span class="va">n_full</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Final (%d vars)"</span>, <span class="va">n_final</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_full</span>, <span class="va">col_pruned</span><span class="op">)</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">"o"</span>,</span>
<span>  bg <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<div class="svg-container"><button type="button" class="btn btn-primary btn-copy-svg" title="Copy SVG to clipboard" aria-label="Copy SVG to clipboard" data-bs-toggle="tooltip" data-bs-placement="left"><i class="fa fa-copy"></i></button>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='504.00pt' height='360.00pt' viewBox='0 0 504.00 360.00' class="r-plt inline-svg" style="max-width:100%;width:100%;height:auto;">
<g class='svglite'>
<defs>
  <style type='text/css'><![CDATA[
    /* theme-aware-processed */
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite circle {
      fill: none;
      stroke: #3E3F3A;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite > g > rect {
      fill: none;
      stroke: #3E3F3A;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
      fill: #3E3F3A;
    }
    .svglite g.glyphgroup path {
      fill: inherit;
      stroke: none;
    }
  ]]></style>
</defs>
<rect width='100%' height='100%' style='stroke: none; fill: #F5F6F8;'/>
<defs>
  <clipPath id='cpMC4wMHw1MDQuMDB8MC4wMHwzNjAuMDA='>
    <rect x='0.00' y='0.00' width='504.00' height='360.00' />
  </clipPath>
</defs>
<g clip-path='url(#cpMC4wMHw1MDQuMDB8MC4wMHwzNjAuMDA=)'>
<line x1='59.04' y1='274.20' x2='59.04' y2='129.75' style='stroke-width: 0.75;' />
<line x1='59.04' y1='274.20' x2='51.84' y2='274.20' style='stroke-width: 0.75;' />
<line x1='59.04' y1='201.98' x2='51.84' y2='201.98' style='stroke-width: 0.75;' />
<line x1='59.04' y1='129.75' x2='51.84' y2='129.75' style='stroke-width: 0.75;' />
<text transform='translate(41.76,274.20) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='20.67px' lengthAdjust='spacingAndGlyphs'>-0.5</text>
<text transform='translate(41.76,201.98) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.0</text>
<text transform='translate(41.76,129.75) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='16.67px' lengthAdjust='spacingAndGlyphs'>0.5</text>
<polygon points='59.04,286.56 473.76,286.56 473.76,59.04 59.04,59.04 ' style='stroke-width: 0.75;' />
<text x='266.40' y='34.67' text-anchor='middle' style='font-size: 14.40px; font-weight: bold; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='308.70px' lengthAdjust='spacingAndGlyphs'>Coefficient Comparison (Full vs modelPrune)</text>
<text transform='translate(12.96,172.80) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='56.47px' lengthAdjust='spacingAndGlyphs'>Coefficient</text>
<line x1='74.40' y1='286.56' x2='458.40' y2='286.56' style='stroke-width: 0.75;' />
<line x1='74.40' y1='286.56' x2='74.40' y2='293.76' style='stroke-width: 0.75;' />
<line x1='95.73' y1='286.56' x2='95.73' y2='293.76' style='stroke-width: 0.75;' />
<line x1='117.07' y1='286.56' x2='117.07' y2='293.76' style='stroke-width: 0.75;' />
<line x1='138.40' y1='286.56' x2='138.40' y2='293.76' style='stroke-width: 0.75;' />
<line x1='159.73' y1='286.56' x2='159.73' y2='293.76' style='stroke-width: 0.75;' />
<line x1='181.07' y1='286.56' x2='181.07' y2='293.76' style='stroke-width: 0.75;' />
<line x1='202.40' y1='286.56' x2='202.40' y2='293.76' style='stroke-width: 0.75;' />
<line x1='223.73' y1='286.56' x2='223.73' y2='293.76' style='stroke-width: 0.75;' />
<line x1='245.07' y1='286.56' x2='245.07' y2='293.76' style='stroke-width: 0.75;' />
<line x1='266.40' y1='286.56' x2='266.40' y2='293.76' style='stroke-width: 0.75;' />
<line x1='287.73' y1='286.56' x2='287.73' y2='293.76' style='stroke-width: 0.75;' />
<line x1='309.07' y1='286.56' x2='309.07' y2='293.76' style='stroke-width: 0.75;' />
<line x1='330.40' y1='286.56' x2='330.40' y2='293.76' style='stroke-width: 0.75;' />
<line x1='351.73' y1='286.56' x2='351.73' y2='293.76' style='stroke-width: 0.75;' />
<line x1='373.07' y1='286.56' x2='373.07' y2='293.76' style='stroke-width: 0.75;' />
<line x1='394.40' y1='286.56' x2='394.40' y2='293.76' style='stroke-width: 0.75;' />
<line x1='415.73' y1='286.56' x2='415.73' y2='293.76' style='stroke-width: 0.75;' />
<line x1='437.07' y1='286.56' x2='437.07' y2='293.76' style='stroke-width: 0.75;' />
<line x1='458.40' y1='286.56' x2='458.40' y2='293.76' style='stroke-width: 0.75;' />
<text transform='translate(77.40,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='19.12px' lengthAdjust='spacingAndGlyphs'>BIO1</text>
<text transform='translate(98.74,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='19.12px' lengthAdjust='spacingAndGlyphs'>BIO2</text>
<text transform='translate(120.07,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='19.12px' lengthAdjust='spacingAndGlyphs'>BIO3</text>
<text transform='translate(141.40,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='19.12px' lengthAdjust='spacingAndGlyphs'>BIO4</text>
<text transform='translate(162.74,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='19.12px' lengthAdjust='spacingAndGlyphs'>BIO5</text>
<text transform='translate(184.07,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='19.12px' lengthAdjust='spacingAndGlyphs'>BIO6</text>
<text transform='translate(205.40,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='19.12px' lengthAdjust='spacingAndGlyphs'>BIO7</text>
<text transform='translate(226.74,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='19.12px' lengthAdjust='spacingAndGlyphs'>BIO8</text>
<text transform='translate(248.07,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='19.12px' lengthAdjust='spacingAndGlyphs'>BIO9</text>
<text transform='translate(269.40,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='23.80px' lengthAdjust='spacingAndGlyphs'>BIO10</text>
<text transform='translate(290.74,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='23.17px' lengthAdjust='spacingAndGlyphs'>BIO11</text>
<text transform='translate(312.07,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='23.80px' lengthAdjust='spacingAndGlyphs'>BIO12</text>
<text transform='translate(333.40,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='23.80px' lengthAdjust='spacingAndGlyphs'>BIO13</text>
<text transform='translate(354.74,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='23.80px' lengthAdjust='spacingAndGlyphs'>BIO14</text>
<text transform='translate(376.07,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='23.80px' lengthAdjust='spacingAndGlyphs'>BIO15</text>
<text transform='translate(397.40,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='23.80px' lengthAdjust='spacingAndGlyphs'>BIO16</text>
<text transform='translate(418.74,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='23.80px' lengthAdjust='spacingAndGlyphs'>BIO17</text>
<text transform='translate(440.07,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='23.80px' lengthAdjust='spacingAndGlyphs'>BIO18</text>
<text transform='translate(461.40,300.96) rotate(-90)' text-anchor='end' style='font-size: 8.40px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='23.80px' lengthAdjust='spacingAndGlyphs'>BIO19</text>
</g>
<defs>
  <clipPath id='cpNTkuMDR8NDczLjc2fDU5LjA0fDI4Ni41Ng=='>
    <rect x='59.04' y='59.04' width='414.72' height='227.52' />
  </clipPath>
</defs>
<g clip-path='url(#cpNTkuMDR8NDczLjc2fDU5LjA0fDI4Ni41Ng==)'>
<rect x='65.87' y='85.01' width='17.07' height='116.97' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='87.20' y='201.98' width='17.07' height='61.32' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='108.53' y='186.99' width='17.07' height='14.99' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='129.87' y='201.98' width='17.07' height='19.87' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='151.20' y='200.65' width='17.07' height='1.33' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='172.53' y='187.26' width='17.07' height='14.72' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='193.87' y='191.88' width='17.07' height='10.10' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='215.20' y='189.86' width='17.07' height='12.11' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='236.53' y='156.07' width='17.07' height='45.91' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='257.87' y='201.98' width='17.07' height='66.22' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='279.20' y='183.83' width='17.07' height='18.15' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='300.53' y='158.41' width='17.07' height='43.57' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='321.87' y='201.98' width='17.07' height='0.68' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='343.20' y='201.98' width='17.07' height='0.31' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='364.53' y='174.05' width='17.07' height='27.93' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='385.87' y='200.74' width='17.07' height='1.24' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='407.20' y='201.78' width='17.07' height='0.20' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='428.53' y='201.95' width='17.07' height='0.030' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='449.87' y='201.98' width='17.07' height='0.22' style='stroke-width: 0.75; stroke: none; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='65.87' y='137.23' width='17.07' height='64.75' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='87.20' y='201.98' width='17.07' height='0.00' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='108.53' y='201.98' width='17.07' height='42.47' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='129.87' y='201.98' width='17.07' height='0.00' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='151.20' y='201.98' width='17.07' height='0.00' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='172.53' y='201.98' width='17.07' height='55.98' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='193.87' y='201.98' width='17.07' height='0.00' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='215.20' y='201.98' width='17.07' height='0.00' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='236.53' y='91.66' width='17.07' height='110.32' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='257.87' y='201.98' width='17.07' height='0.00' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='279.20' y='201.98' width='17.07' height='63.61' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='300.53' y='161.50' width='17.07' height='40.47' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='321.87' y='199.80' width='17.07' height='2.18' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='343.20' y='189.27' width='17.07' height='12.71' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='364.53' y='201.98' width='17.07' height='0.00' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='385.87' y='193.00' width='17.07' height='8.97' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='407.20' y='199.18' width='17.07' height='2.79' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='428.53' y='201.98' width='17.07' height='0.078' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect x='449.87' y='201.98' width='17.07' height='0.89' style='stroke-width: 0.75; stroke: none; fill: #3380CC; fill-opacity: 0.50;' />
<rect rx='4' x='361.43' y='59.04' width='112.33' height='43.20' style='stroke-width: 0.75; stroke: #DFD7CA; fill: #F5F6F8;' />
<rect x='372.23' y='69.84' width='8.64' height='7.20' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #CC3333; fill-opacity: 0.50;' />
<rect x='372.23' y='84.24' width='8.64' height='7.20' style='stroke-width: 0.75; stroke: #FFFFFF; fill: #3380CC; fill-opacity: 0.50;' />
<text x='391.67' y='77.74' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='70.02px' lengthAdjust='spacingAndGlyphs'>Full (19 vars)</text>
<text x='391.67' y='92.14' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='76.69px' lengthAdjust='spacingAndGlyphs'>Final (12 vars)</text>
</g>
</g>
</svg></div>
</div>
</div>
<div class="section level2">
<h2 id="workflow-2-survey-data-analysis">Workflow 2: Survey Data Analysis<a class="anchor" aria-label="anchor" href="#workflow-2-survey-data-analysis"></a>
</h2>
<p><strong>Goal</strong>: Reduce questionnaire length while preserving
construct coverage and protecting key demographic variables.</p>
<p><strong>Challenge</strong>: Survey instruments often contain
redundant items within constructs (e.g., multiple satisfaction questions
that are highly correlated). Reducing the number of items improves
response rates and reduces respondent burden without losing measurement
quality.</p>
<p><strong>Strategy</strong>: Use <code><a href="../reference/corrPrune.html">corrPrune()</a></code> with
<code>force_in</code> to:</p>
<ol style="list-style-type: decimal">
<li><p>Ensure critical variables (like age) appear in the final
model</p></li>
<li><p>Remove redundant Likert items within constructs</p></li>
<li><p>Maintain balanced representation across satisfaction, engagement,
and loyalty domains</p></li>
</ol>
<div class="section level4">
<h4 id="data-1">Data<a class="anchor" aria-label="anchor" href="#data-1"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">survey_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">survey_example</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 200  35</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">survey_example</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>  <span class="co"># First 10 columns</span></span>
<span><span class="co">#&gt; 'data.frame':    200 obs. of  10 variables:</span></span>
<span><span class="co">#&gt;  $ respondent_id       : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ age                 : num  38 32 18 18 19 39 33 26 26 42 ...</span></span>
<span><span class="co">#&gt;  $ gender              : Factor w/ 3 levels "Female","Male",..: 2 3 1 2 2 1 1 2 2 1 ...</span></span>
<span><span class="co">#&gt;  $ education           : Ord.factor w/ 4 levels "High School"&lt;..: 3 1 4 2 2 1 1 1 2 3 ...</span></span>
<span><span class="co">#&gt;  $ overall_satisfaction: num  58 40 44 40 58 67 61 49 51 52 ...</span></span>
<span><span class="co">#&gt;  $ satisfaction_1      : Ord.factor w/ 7 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 6 4 5 3 4 5 4 5 4 6 ...</span></span>
<span><span class="co">#&gt;  $ satisfaction_2      : Ord.factor w/ 7 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 6 3 4 3 4 6 6 4 4 4 ...</span></span>
<span><span class="co">#&gt;  $ satisfaction_3      : Ord.factor w/ 7 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 6 3 4 4 3 4 5 3 4 4 ...</span></span>
<span><span class="co">#&gt;  $ satisfaction_4      : Ord.factor w/ 7 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 7 3 4 4 4 5 4 3 2 4 ...</span></span>
<span><span class="co">#&gt;  $ satisfaction_5      : Ord.factor w/ 7 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 7 4 5 4 5 4 3 5 3 6 ...</span></span></code></pre></div>
<p>The dataset contains 200 respondents, 30 Likert-scale items (10 each
for satisfaction, engagement, loyalty), plus demographics (age, gender,
education) and an overall satisfaction outcome.</p>
</div>
<div class="section level4">
<h4 id="prune-with-protected-variables">Prune with protected variables<a class="anchor" aria-label="anchor" href="#prune-with-protected-variables"></a>
</h4>
<p>We use <code>force_in = "age"</code> to ensure age remains in the
analysis regardless of its correlation with other variables. This is
useful when domain knowledge identifies theoretically important
covariates that must not be removed.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exclude respondent_id, overall_satisfaction, and factor variables</span></span>
<span><span class="va">survey_predictors</span> <span class="op">&lt;-</span> <span class="va">survey_example</span><span class="op">[</span>, <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">survey_example</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>                                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"respondent_id"</span>, <span class="st">"overall_satisfaction"</span>,</span>
<span>                                           <span class="st">"gender"</span>, <span class="st">"education"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Convert ordered factors (Likert items 1-7) to numeric for correlation analysis</span></span>
<span><span class="va">survey_numeric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">survey_predictors</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">is.ordered</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prune with protected variables</span></span>
<span><span class="va">survey_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">survey_numeric</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  force_in <span class="op">=</span> <span class="st">"age"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># How many items remain?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Reduced from %d → %d variables\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_numeric</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_clean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reduced from 31 → 7 variables</span></span>
<span></span>
<span><span class="co"># Which items were kept?</span></span>
<span><span class="va">selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">survey_clean</span>, <span class="st">"selected_vars"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">selected</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "age"            "satisfaction_1" "engagement_1"   "loyalty_1"     </span></span>
<span><span class="co">#&gt; [5] "loyalty_5"      "loyalty_7"      "loyalty_10"</span></span></code></pre></div>
<p>The pruning reduced the questionnaire substantially while ensuring
age was retained. The remaining items span all three constructs,
avoiding the loss of entire domains.</p>
</div>
<div class="section level4">
<h4 id="construct-coverage">Construct coverage<a class="anchor" aria-label="anchor" href="#construct-coverage"></a>
</h4>
<p>It’s important to verify that pruning didn’t eliminate entire
constructs. We check how many items from each domain (satisfaction,
engagement, loyalty) survived the correlation threshold.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Count items per construct</span></span>
<span><span class="va">satisfaction_kept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"satisfaction_"</span>, <span class="va">selected</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">engagement_kept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"engagement_"</span>, <span class="va">selected</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loyalty_kept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"loyalty_"</span>, <span class="va">selected</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Satisfaction: %d/10 items kept\n"</span>, <span class="va">satisfaction_kept</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Satisfaction: 1/10 items kept</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Engagement: %d/10 items kept\n"</span>, <span class="va">engagement_kept</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Engagement: 1/10 items kept</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Loyalty: %d/10 items kept\n"</span>, <span class="va">loyalty_kept</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loyalty: 4/10 items kept</span></span></code></pre></div>
<p>Good balance: all three constructs retained representation, ensuring
the reduced questionnaire still measures all intended dimensions.</p>
</div>
<div class="section level4">
<h4 id="visualization-1">Visualization<a class="anchor" aria-label="anchor" href="#visualization-1"></a>
</h4>
<p>The barplots show (1) how many items survived pruning within each
construct and (2) the overall variable reduction.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Items kept per construct</span></span>
<span><span class="va">construct_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">satisfaction_kept</span>, <span class="va">engagement_kept</span>, <span class="va">loyalty_kept</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">construct_data</span>,</span>
<span>        beside <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Satisfaction"</span>, <span class="st">"Engagement"</span>, <span class="st">"Loyalty"</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lightgray"</span>, <span class="st">"lightblue"</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original (10)"</span>, <span class="st">"After pruning"</span><span class="op">)</span>,</span>
<span>        args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topright"</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Items per Construct"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Number of Items"</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Percentage reduction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_numeric</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_clean</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before"</span>, <span class="st">"After"</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"salmon"</span>, <span class="st">"lightgreen"</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Total Variables"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_numeric</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_numeric</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_numeric</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1.9</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_clean</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">survey_clean</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><div class="svg-container"><button type="button" class="btn btn-primary btn-copy-svg" title="Copy SVG to clipboard" aria-label="Copy SVG to clipboard" data-bs-toggle="tooltip" data-bs-placement="left"><i class="fa fa-copy"></i></button>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='576.00pt' height='360.00pt' viewBox='0 0 576.00 360.00' class="r-plt inline-svg" style="max-width:100%;width:100%;height:auto;">
<g class='svglite'>
<defs>
  <style type='text/css'><![CDATA[
    /* theme-aware-processed */
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite circle {
      fill: none;
      stroke: #3E3F3A;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite > g > rect {
      fill: none;
      stroke: #3E3F3A;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
      fill: #3E3F3A;
    }
    .svglite g.glyphgroup path {
      fill: inherit;
      stroke: none;
    }
  ]]></style>
</defs>
<rect width='100%' height='100%' style='stroke: none; fill: #F5F6F8;'/>
<defs>
  <clipPath id='cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA='>
    <rect x='0.00' y='0.00' width='576.00' height='360.00' />
  </clipPath>
</defs>
<g clip-path='url(#cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA=)'>
</g>
<defs>
  <clipPath id='cpMC4wMHwyODguMDB8MC4wMHwzNjAuMDA='>
    <rect x='0.00' y='0.00' width='288.00' height='360.00' />
  </clipPath>
</defs>
<g clip-path='url(#cpMC4wMHwyODguMDB8MC4wMHwzNjAuMDA=)'>
<rect x='66.40' y='96.96' width='23.00' height='189.60' style='stroke-width: 0.75; fill: #D3D3D3;' />
<rect x='89.40' y='267.60' width='23.00' height='18.96' style='stroke-width: 0.75; fill: #ADD8E6;' />
<rect x='135.40' y='96.96' width='23.00' height='189.60' style='stroke-width: 0.75; fill: #D3D3D3;' />
<rect x='158.40' y='267.60' width='23.00' height='18.96' style='stroke-width: 0.75; fill: #ADD8E6;' />
<rect x='204.40' y='96.96' width='23.00' height='189.60' style='stroke-width: 0.75; fill: #D3D3D3;' />
<rect x='227.40' y='210.72' width='23.00' height='75.84' style='stroke-width: 0.75; fill: #ADD8E6;' />
</g>
<g clip-path='url(#cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA=)'>
<text x='89.40' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='62.02px' lengthAdjust='spacingAndGlyphs'>Satisfaction</text>
<text x='227.40' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='38.02px' lengthAdjust='spacingAndGlyphs'>Loyalty</text>
</g>
<g clip-path='url(#cpMC4wMHwyODguMDB8MC4wMHwzNjAuMDA=)'>
<rect x='164.23' y='69.84' width='8.64' height='7.20' style='stroke-width: 0.75; fill: #D3D3D3;' />
<rect x='164.23' y='84.24' width='8.64' height='7.20' style='stroke-width: 0.75; fill: #ADD8E6;' />
<text x='183.67' y='77.74' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='66.03px' lengthAdjust='spacingAndGlyphs'>Original (10)</text>
<text x='183.67' y='92.14' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='68.69px' lengthAdjust='spacingAndGlyphs'>After pruning</text>
<text x='158.40' y='34.67' text-anchor='middle' style='font-size: 14.40px; font-weight: bold; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='135.95px' lengthAdjust='spacingAndGlyphs'>Items per Construct</text>
<text transform='translate(12.96,172.80) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='88.67px' lengthAdjust='spacingAndGlyphs'>Number of Items</text>
</g>
<g clip-path='url(#cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA=)'>
<line x1='59.04' y1='286.56' x2='59.04' y2='59.04' style='stroke-width: 0.75;' />
<line x1='59.04' y1='286.56' x2='51.84' y2='286.56' style='stroke-width: 0.75;' />
<line x1='59.04' y1='248.64' x2='51.84' y2='248.64' style='stroke-width: 0.75;' />
<line x1='59.04' y1='210.72' x2='51.84' y2='210.72' style='stroke-width: 0.75;' />
<line x1='59.04' y1='172.80' x2='51.84' y2='172.80' style='stroke-width: 0.75;' />
<line x1='59.04' y1='134.88' x2='51.84' y2='134.88' style='stroke-width: 0.75;' />
<line x1='59.04' y1='96.96' x2='51.84' y2='96.96' style='stroke-width: 0.75;' />
<line x1='59.04' y1='59.04' x2='51.84' y2='59.04' style='stroke-width: 0.75;' />
<text transform='translate(41.76,286.56) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>0</text>
<text transform='translate(41.76,248.64) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>2</text>
<text transform='translate(41.76,210.72) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>4</text>
<text transform='translate(41.76,172.80) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>6</text>
<text transform='translate(41.76,134.88) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>8</text>
<text transform='translate(41.76,96.96) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>10</text>
<text transform='translate(41.76,59.04) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>12</text>
</g>
<defs>
  <clipPath id='cpMjg4LjAwfDU3Ni4wMHwwLjAwfDM2MC4wMA=='>
    <rect x='288.00' y='0.00' width='288.00' height='360.00' />
  </clipPath>
</defs>
<g clip-path='url(#cpMjg4LjAwfDU3Ni4wMHwwLjAwfDM2MC4wMA==)'>
<rect x='354.40' y='96.96' width='83.64' height='189.60' style='stroke-width: 0.75; fill: #FA8072;' />
<rect x='454.76' y='243.75' width='83.64' height='42.81' style='stroke-width: 0.75; fill: #90EE90;' />
</g>
<g clip-path='url(#cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA=)'>
<text x='396.22' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='35.34px' lengthAdjust='spacingAndGlyphs'>Before</text>
<text x='496.58' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='25.33px' lengthAdjust='spacingAndGlyphs'>After</text>
</g>
<g clip-path='url(#cpMjg4LjAwfDU3Ni4wMHwwLjAwfDM2MC4wMA==)'>
<text x='446.40' y='34.67' text-anchor='middle' style='font-size: 14.40px; font-weight: bold; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='100.52px' lengthAdjust='spacingAndGlyphs'>Total Variables</text>
<text transform='translate(300.96,172.80) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='32.02px' lengthAdjust='spacingAndGlyphs'>Count</text>
</g>
<g clip-path='url(#cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA=)'>
<line x1='347.04' y1='286.56' x2='347.04' y2='72.50' style='stroke-width: 0.75;' />
<line x1='347.04' y1='286.56' x2='339.84' y2='286.56' style='stroke-width: 0.75;' />
<line x1='347.04' y1='255.98' x2='339.84' y2='255.98' style='stroke-width: 0.75;' />
<line x1='347.04' y1='225.40' x2='339.84' y2='225.40' style='stroke-width: 0.75;' />
<line x1='347.04' y1='194.82' x2='339.84' y2='194.82' style='stroke-width: 0.75;' />
<line x1='347.04' y1='164.24' x2='339.84' y2='164.24' style='stroke-width: 0.75;' />
<line x1='347.04' y1='133.66' x2='339.84' y2='133.66' style='stroke-width: 0.75;' />
<line x1='347.04' y1='103.08' x2='339.84' y2='103.08' style='stroke-width: 0.75;' />
<line x1='347.04' y1='72.50' x2='339.84' y2='72.50' style='stroke-width: 0.75;' />
<text transform='translate(329.76,286.56) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>0</text>
<text transform='translate(329.76,255.98) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>5</text>
<text transform='translate(329.76,225.40) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>10</text>
<text transform='translate(329.76,194.82) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>15</text>
<text transform='translate(329.76,164.24) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>20</text>
<text transform='translate(329.76,133.66) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>25</text>
<text transform='translate(329.76,103.08) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>30</text>
<text transform='translate(329.76,72.50) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>35</text>
</g>
<defs>
  <clipPath id='cpMzQ3LjA0fDU0NS43Nnw1OS4wNHwyODYuNTY='>
    <rect x='347.04' y='59.04' width='198.72' height='227.52' />
  </clipPath>
</defs>
<g clip-path='url(#cpMzQ3LjA0fDU0NS43Nnw1OS4wNHwyODYuNTY=)'>
<text x='396.22' y='83.64' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>31</text>
<text x='496.58' y='230.43' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>7</text>
</g>
</g>
</svg></div></p>
</div>
<div class="section level4">
<h4 id="model-satisfaction">Model satisfaction<a class="anchor" aria-label="anchor" href="#model-satisfaction"></a>
</h4>
<p>Now we fit a regression model predicting overall satisfaction from
the pruned item set. Despite using fewer predictors, the model should
maintain good explanatory power because we removed only redundant
items.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add response back</span></span>
<span><span class="va">survey_model_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  overall_satisfaction <span class="op">=</span> <span class="va">survey_example</span><span class="op">$</span><span class="va">overall_satisfaction</span>,</span>
<span>  <span class="va">survey_clean</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit regression model</span></span>
<span><span class="va">model_survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">overall_satisfaction</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">survey_model_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_survey</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = overall_satisfaction ~ ., data = survey_model_data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -19.8718  -3.9671  -0.2193   4.0766  20.0132 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    26.01351    2.11317  12.310   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; age             0.02558    0.04152   0.616   0.5385    </span></span>
<span><span class="co">#&gt; satisfaction_1  4.97997    0.32940  15.118   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; engagement_1    0.26170    0.30292   0.864   0.3887    </span></span>
<span><span class="co">#&gt; loyalty_1       0.37258    0.32254   1.155   0.2495    </span></span>
<span><span class="co">#&gt; loyalty_5       0.30218    0.30068   1.005   0.3162    </span></span>
<span><span class="co">#&gt; loyalty_7       0.01332    0.32027   0.042   0.9669    </span></span>
<span><span class="co">#&gt; loyalty_10     -0.51598    0.30702  -1.681   0.0945 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.397 on 192 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6916, Adjusted R-squared:  0.6804 </span></span>
<span><span class="co">#&gt; F-statistic: 61.52 on 7 and 192 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-comparison-1">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison-1"></a>
</h4>
<p>Comparing the pruned model against the full 33-variable model shows
that we retain most of the explanatory power (R²) while dramatically
reducing model complexity.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Full model (all 30 items + demographics)</span></span>
<span><span class="va">full_survey_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  overall_satisfaction <span class="op">=</span> <span class="va">survey_example</span><span class="op">$</span><span class="va">overall_satisfaction</span>,</span>
<span>  <span class="va">survey_predictors</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_full_survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">overall_satisfaction</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">full_survey_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Full (33 vars)"</span>, <span class="st">"Pruned (10 vars)"</span><span class="op">)</span>,</span>
<span>  R2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_full_survey</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_survey</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span><span class="op">)</span>,</span>
<span>  Adj_R2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_full_survey</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_survey</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span><span class="op">)</span>,</span>
<span>  Num_Predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">33</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;              Model        R2    Adj_R2 Num_Predictors</span></span>
<span><span class="co">#&gt; 1   Full (33 vars) 0.9822173 0.8034025             33</span></span>
<span><span class="co">#&gt; 2 Pruned (10 vars) 0.6916262 0.6803834             10</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="workflow-3-high-dimensional-data">Workflow 3: High-Dimensional Data<a class="anchor" aria-label="anchor" href="#workflow-3-high-dimensional-data"></a>
</h2>
<p><strong>Goal</strong>: Reduce dimensionality in a gene expression
dataset where the number of predictors far exceeds the number of samples
(p &gt;&gt; n).</p>
<p><strong>Challenge</strong>: With 200 genes and only 100 samples,
exact enumeration of all maximal subsets becomes computationally
expensive. Standard regression is also impossible due to rank
deficiency.</p>
<p><strong>Strategy</strong>: Use <code>mode = "greedy"</code> for fast,
approximate pruning:</p>
<ul>
<li><p>The greedy algorithm scales linearly with the number of
variables</p></li>
<li><p>While not guaranteed to find the largest subset, it provides a
high-quality solution orders of magnitude faster</p></li>
<li><p>Ideal for exploratory analysis in high-dimensional
settings</p></li>
</ul>
<div class="section level4">
<h4 id="data-2">Data<a class="anchor" aria-label="anchor" href="#data-2"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">genes_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">genes_example</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 100 202</span></span>
<span></span>
<span><span class="co"># Disease prevalence</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">genes_example</span><span class="op">$</span><span class="va">disease_status</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Healthy Disease </span></span>
<span><span class="co">#&gt;       2      98</span></span></code></pre></div>
<p>The dataset contains gene expression measurements for 200 genes
across 100 samples, with a binary disease outcome. This is a classic p
&gt;&gt; n scenario where regularization or dimensionality reduction is
essential.</p>
</div>
<div class="section level4">
<h4 id="greedy-pruning">Greedy pruning<a class="anchor" aria-label="anchor" href="#greedy-pruning"></a>
</h4>
<p>The greedy algorithm iteratively selects variables, prioritizing
those with the lowest maximum correlation to already-selected variables.
This heuristic runs in O(p²) time compared to the exponential complexity
of exact methods.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract gene expression data (exclude ID and outcome)</span></span>
<span><span class="va">gene_expr</span> <span class="op">&lt;-</span> <span class="va">genes_example</span><span class="op">[</span>, <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Greedy pruning with timing</span></span>
<span><span class="va">greedy_timing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="va">genes_pruned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">gene_expr</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    mode <span class="op">=</span> <span class="st">"greedy"</span>  <span class="co"># Fast for large p</span></span>
<span>  <span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span><span class="va">greedy_ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">greedy_timing</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e6</span></span>
<span></span>
<span><span class="co"># Reduction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Reduced from %d → %d genes (%.1f ms)\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gene_expr</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">genes_pruned</span><span class="op">)</span>,</span>
<span>            <span class="va">greedy_ms</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reduced from 200 → 177 genes (10.4 ms)</span></span></code></pre></div>
<p>The greedy algorithm completed in milliseconds while ensuring all
pairwise correlations remain below 0.8.</p>
</div>
<div class="section level4">
<h4 id="dimensionality-reduction">Dimensionality reduction<a class="anchor" aria-label="anchor" href="#dimensionality-reduction"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Barplot showing reduction</span></span>
<span><span class="va">reduction_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gene_expr</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">genes_pruned</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">reduction_data</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original"</span>, <span class="st">"After Pruning"</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Gene Dimensionality Reduction"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Number of Genes"</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"salmon"</span>, <span class="st">"lightblue"</span><span class="op">)</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">reduction_data</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="va">reduction_data</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">reduction_data</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"genes"</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1.9</span>, <span class="va">reduction_data</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">reduction_data</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"genes\n("</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">reduction_data</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="va">reduction_data</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"% retained)"</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><div class="svg-container"><button type="button" class="btn btn-primary btn-copy-svg" title="Copy SVG to clipboard" aria-label="Copy SVG to clipboard" data-bs-toggle="tooltip" data-bs-placement="left"><i class="fa fa-copy"></i></button>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='576.00pt' height='360.00pt' viewBox='0 0 576.00 360.00' class="r-plt inline-svg" style="max-width:100%;width:100%;height:auto;">
<g class='svglite'>
<defs>
  <style type='text/css'><![CDATA[
    /* theme-aware-processed */
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite circle {
      fill: none;
      stroke: #3E3F3A;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite > g > rect {
      fill: none;
      stroke: #3E3F3A;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
      fill: #3E3F3A;
    }
    .svglite g.glyphgroup path {
      fill: inherit;
      stroke: none;
    }
  ]]></style>
</defs>
<rect width='100%' height='100%' style='stroke: none; fill: #F5F6F8;'/>
<defs>
  <clipPath id='cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA='>
    <rect x='0.00' y='0.00' width='576.00' height='360.00' />
  </clipPath>
</defs>
<g clip-path='url(#cpMC4wMHw1NzYuMDB8MC4wMHwzNjAuMDA=)'>
<rect x='77.07' y='96.96' width='204.85' height='189.60' style='stroke-width: 0.75; fill: #FA8072;' />
<rect x='322.88' y='118.76' width='204.85' height='167.80' style='stroke-width: 0.75; fill: #ADD8E6;' />
<text x='179.49' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='41.36px' lengthAdjust='spacingAndGlyphs'>Original</text>
<text x='425.31' y='312.48' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='70.02px' lengthAdjust='spacingAndGlyphs'>After Pruning</text>
<text x='302.40' y='34.67' text-anchor='middle' style='font-size: 14.40px; font-weight: bold; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='216.73px' lengthAdjust='spacingAndGlyphs'>Gene Dimensionality Reduction</text>
<text transform='translate(12.96,172.80) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='94.69px' lengthAdjust='spacingAndGlyphs'>Number of Genes</text>
<line x1='59.04' y1='286.56' x2='59.04' y2='96.96' style='stroke-width: 0.75;' />
<line x1='59.04' y1='286.56' x2='51.84' y2='286.56' style='stroke-width: 0.75;' />
<line x1='59.04' y1='239.16' x2='51.84' y2='239.16' style='stroke-width: 0.75;' />
<line x1='59.04' y1='191.76' x2='51.84' y2='191.76' style='stroke-width: 0.75;' />
<line x1='59.04' y1='144.36' x2='51.84' y2='144.36' style='stroke-width: 0.75;' />
<line x1='59.04' y1='96.96' x2='51.84' y2='96.96' style='stroke-width: 0.75;' />
<text transform='translate(41.76,286.56) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='6.67px' lengthAdjust='spacingAndGlyphs'>0</text>
<text transform='translate(41.76,239.16) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='13.34px' lengthAdjust='spacingAndGlyphs'>50</text>
<text transform='translate(41.76,191.76) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='20.02px' lengthAdjust='spacingAndGlyphs'>100</text>
<text transform='translate(41.76,144.36) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='20.02px' lengthAdjust='spacingAndGlyphs'>150</text>
<text transform='translate(41.76,96.96) rotate(-90)' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='20.02px' lengthAdjust='spacingAndGlyphs'>200</text>
</g>
<defs>
  <clipPath id='cpNTkuMDR8NTQ1Ljc2fDU5LjA0fDI4Ni41Ng=='>
    <rect x='59.04' y='59.04' width='486.72' height='227.52' />
  </clipPath>
</defs>
<g clip-path='url(#cpNTkuMDR8NTQ1Ljc2fDU5LjA0fDI4Ni41Ng==)'>
<text x='179.49' y='80.28' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='56.03px' lengthAdjust='spacingAndGlyphs'>200 genes</text>
<text x='425.31' y='87.68' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='56.03px' lengthAdjust='spacingAndGlyphs'>177 genes</text>
<text x='425.31' y='102.08' text-anchor='middle' style='font-size: 12.00px; font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;' textLength='95.36px' lengthAdjust='spacingAndGlyphs'>( 88.5 % retained)</text>
</g>
</g>
</svg></div></p>
</div>
<div class="section level4">
<h4 id="exact-vs-greedy-comparison">Exact vs greedy comparison<a class="anchor" aria-label="anchor" href="#exact-vs-greedy-comparison"></a>
</h4>
<p>To demonstrate the speed advantage of the greedy algorithm, we
benchmark both approaches on a smaller subset. The performance gap
widens dramatically as the number of variables increases.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset for comparison (use smaller subset for vignette build speed)</span></span>
<span><span class="va">gene_subset</span> <span class="op">&lt;-</span> <span class="va">gene_expr</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>  <span class="co"># Reduced from 50 to 20 for faster builds</span></span>
<span></span>
<span><span class="co"># Benchmark exact mode</span></span>
<span><span class="va">exact_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="va">exact_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span><span class="va">gene_subset</span>, threshold <span class="op">=</span> <span class="fl">0.8</span>, mode <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"ms"</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e6</span>  <span class="co"># Convert nanoseconds to milliseconds</span></span>
<span></span>
<span><span class="co"># Benchmark greedy mode</span></span>
<span><span class="va">greedy_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="va">greedy_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span><span class="va">gene_subset</span>, threshold <span class="op">=</span> <span class="fl">0.8</span>, mode <span class="op">=</span> <span class="st">"greedy"</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"ms"</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e6</span>  <span class="co"># Convert nanoseconds to milliseconds</span></span>
<span></span>
<span><span class="co"># Run once more to get actual results for comparison</span></span>
<span><span class="va">exact_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span><span class="va">gene_subset</span>, threshold <span class="op">=</span> <span class="fl">0.8</span>, mode <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span><span class="va">greedy_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span><span class="va">gene_subset</span>, threshold <span class="op">=</span> <span class="fl">0.8</span>, mode <span class="op">=</span> <span class="st">"greedy"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Exact mode: %d genes kept (%.1f ms)\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">exact_result</span><span class="op">)</span>, <span class="va">exact_time</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Exact mode: 11 genes kept (3.5 ms)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Greedy mode: %d genes kept (%.1f ms)\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">greedy_result</span><span class="op">)</span>, <span class="va">greedy_time</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Greedy mode: 10 genes kept (0.5 ms)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Speedup: %.1fx faster\n"</span>, <span class="va">exact_time</span> <span class="op">/</span> <span class="va">greedy_time</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Speedup: 6.6x faster</span></span></code></pre></div>
<p>The greedy mode is substantially faster. For the full 200-gene
dataset, exact enumeration would be prohibitively slow, while greedy
mode completes in milliseconds.</p>
</div>
<div class="section level4">
<h4 id="classification">Classification<a class="anchor" aria-label="anchor" href="#classification"></a>
</h4>
<p>Finally, we demonstrate that the pruned gene set is suitable for
downstream classification, despite the dramatic dimensionality
reduction.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare classification data</span></span>
<span><span class="va">classification_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  disease_status <span class="op">=</span> <span class="va">genes_example</span><span class="op">$</span><span class="va">disease_status</span>,</span>
<span>  <span class="va">genes_pruned</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Logistic regression</span></span>
<span><span class="va">model_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">disease_status</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">classification_data</span>,</span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prediction accuracy</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_genes</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.5</span>,</span>
<span>                     <span class="st">"Disease"</span>, <span class="st">"Healthy"</span><span class="op">)</span></span>
<span><span class="va">accuracy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">predictions</span> <span class="op">==</span> <span class="va">genes_example</span><span class="op">$</span><span class="va">disease_status</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Classification accuracy: %.1f%%\n"</span>, <span class="va">accuracy</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classification accuracy: 100.0%</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="workflow-4-mixed-models">Workflow 4: Mixed Models<a class="anchor" aria-label="anchor" href="#workflow-4-mixed-models"></a>
</h2>
<p><strong>Goal</strong>: Apply correlation-based pruning to fixed
effects in a mixed-effects model with longitudinal data.</p>
<p><strong>Challenge</strong>: Longitudinal data has hierarchical
structure (observations nested within subjects, subjects nested within
sites). Standard VIF calculations don’t account for random effects, but
we still need to control multicollinearity among fixed-effect
predictors.</p>
<p><strong>Strategy</strong>: Use <code><a href="../reference/modelPrune.html">modelPrune()</a></code> with
<code>engine = "lme4"</code>:</p>
<ul>
<li><p>Only fixed effects are pruned based on VIF</p></li>
<li><p>Random effects <code>(1|subject)</code> and <code>(1|site)</code>
are preserved in the model formula</p></li>
<li><p>This maintains the hierarchical structure while reducing
collinearity</p></li>
</ul>
<p><strong>Note</strong>: This workflow requires the <code>lme4</code>
package and is shown with <code>eval=FALSE</code> for portability.</p>
<div class="section level4">
<h4 id="data-3">Data<a class="anchor" aria-label="anchor" href="#data-3"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 500  25</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">)</span></span>
<span><span class="co">#&gt;   obs_id subject site time  outcome          x1         x2          x3</span></span>
<span><span class="co">#&gt; 1      1       1    1    1 12.10893 -0.62045078 -0.8629274 -0.39625483</span></span>
<span><span class="co">#&gt; 2      2       1    1    2 13.97195  0.04255998  0.4086801  0.27069591</span></span>
<span><span class="co">#&gt; 3      3       1    1    3 15.71622  0.20445067 -1.0457672  1.69557480</span></span>
<span><span class="co">#&gt; 4      4       1    1    4 12.61343  0.38437289  2.0301256 -1.17894923</span></span>
<span><span class="co">#&gt; 5      5       1    1    5 15.73139 -0.06402543  1.1645219 -0.19757260</span></span>
<span><span class="co">#&gt; 6      6       1    1    6 13.19571  0.65208588 -1.5040345  0.07671762</span></span>
<span><span class="co">#&gt;           x4         x5          x6         x7         x8           x9</span></span>
<span><span class="co">#&gt; 1 -0.4557709 -1.2550770 -0.35966846 -1.9288176  0.8393628  0.151111346</span></span>
<span><span class="co">#&gt; 2 -0.7652493 -1.2136755 -0.05181211 -0.4759841  0.9063848  1.429621637</span></span>
<span><span class="co">#&gt; 3  0.5569423 -1.4962408  0.23986408 -1.7077822  1.0343806  0.797974670</span></span>
<span><span class="co">#&gt; 4  0.1604224 -0.8192580 -0.94858863 -1.9314095 -0.0639552  0.887413164</span></span>
<span><span class="co">#&gt; 5 -1.3331022 -0.6162473 -0.61339605 -0.9439486 -0.1220047 -0.796244469</span></span>
<span><span class="co">#&gt; 6  0.5205094 -0.8547461  0.24120308 -1.3083776  0.8716209  0.005423635</span></span>
<span><span class="co">#&gt;          x10        x11       x12         x13        x14        x15         x16</span></span>
<span><span class="co">#&gt; 1  0.9681971 -0.1384342 0.2598923  0.37082493 -0.1829715 -1.1853721 -0.72703262</span></span>
<span><span class="co">#&gt; 2  2.0989531  0.6303914 0.6211064 -0.91103843 -0.1125705 -0.3458058 -0.44331165</span></span>
<span><span class="co">#&gt; 3  0.2329831 -0.8618361 2.0854289  0.02634099 -1.3522055 -1.2151804  0.00311954</span></span>
<span><span class="co">#&gt; 4  1.5491815  1.7595441 0.8198899  0.18115372 -0.5638401 -1.3637072 -0.55274223</span></span>
<span><span class="co">#&gt; 5  2.3485234 -0.1267969 2.6230203 -1.13918808 -1.1559678 -0.3214032 -0.87713586</span></span>
<span><span class="co">#&gt; 6 -0.1860167 -0.4620834 1.6075140 -1.81586413 -0.0172986 -0.1041232 -0.56268259</span></span>
<span><span class="co">#&gt;           x17        x18        x19       x20</span></span>
<span><span class="co">#&gt; 1  0.91333399  1.2398417  1.2973339 1.0590334</span></span>
<span><span class="co">#&gt; 2 -0.09799793 -1.3670758 -1.0050198 0.9990451</span></span>
<span><span class="co">#&gt; 3 -0.14957945 -0.8573087  0.9004974 0.5399732</span></span>
<span><span class="co">#&gt; 4  0.55650397  0.7458841  0.7415159 1.7067212</span></span>
<span><span class="co">#&gt; 5  0.36401595 -0.4019171  1.1669136 0.7799264</span></span>
<span><span class="co">#&gt; 6  0.30234421 -0.6646296 -0.6615620 1.5092899</span></span>
<span></span>
<span><span class="co"># Study design</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Subjects: %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">$</span><span class="va">subject</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Subjects: 50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Sites: %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">$</span><span class="va">site</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sites: 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Observations per subject: %d\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">longitudinal_example</span><span class="op">$</span><span class="va">subject</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observations per subject: 10</span></span></code></pre></div>
<p>The dataset has 500 observations from 50 subjects across 5 sites,
with 10 measurements per subject. We have 5 correlated fixed-effect
predictors (x1-x5).</p>
</div>
<div class="section level4">
<h4 id="prune-fixed-effects">Prune fixed effects<a class="anchor" aria-label="anchor" href="#prune-fixed-effects"></a>
</h4>
<p>The <code><a href="../reference/modelPrune.html">modelPrune()</a></code> function with
<code>engine = "lme4"</code> respects the random-effects structure. Only
the fixed effects (x1-x5) are candidates for removal; the random
intercepts for subject and site remain untouched.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note: This example requires lme4 package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define formula with random effects</span></span>
<span><span class="co"># Note: Only fixed effects (x1-x5) will be pruned</span></span>
<span><span class="co">#       Random effects (1|subject), (1|site) are preserved</span></span>
<span></span>
<span><span class="va">pruned_mixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modelPrune.html">modelPrune</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">outcome</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span> <span class="op">+</span> <span class="va">x5</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">site</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">longitudinal_example</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"lme4"</span>,</span>
<span>  limit <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Which fixed effects were kept?</span></span>
<span><span class="va">selected_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">pruned_mixed</span>, <span class="st">"selected_vars"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fixed effects kept:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">selected_fixed</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Which were removed?</span></span>
<span><span class="va">removed_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">pruned_mixed</span>, <span class="st">"removed_vars"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFixed effects removed:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">removed_fixed</span><span class="op">)</span></span></code></pre></div>
<p>The algorithm sequentially removes fixed effects with VIF &gt; 5
until all remaining predictors satisfy the limit. The random effects
structure is never modified.</p>
</div>
<div class="section level4">
<h4 id="final-model">Final model<a class="anchor" aria-label="anchor" href="#final-model"></a>
</h4>
<p>The final model contains only the fixed effects that passed the VIF
threshold, along with the original random effects.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">final_mixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">pruned_mixed</span>, <span class="st">"final_model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">final_mixed</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="vif-verification">VIF verification<a class="anchor" aria-label="anchor" href="#vif-verification"></a>
</h4>
<p>We can manually verify that the pruning successfully reduced
multicollinearity by comparing VIF values before and after pruning.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note: This example requires lme4 package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit full model</span></span>
<span><span class="va">full_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"outcome ~"</span>,</span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span>,</span>
<span>                                 <span class="st">"+ (1|subject) + (1|site)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_full_mixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">full_formula</span>, data <span class="op">=</span> <span class="va">longitudinal_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract fixed effects design matrices</span></span>
<span><span class="va">X_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/getME.html" class="external-link">getME</a></span><span class="op">(</span><span class="va">model_full_mixed</span>, <span class="st">"X"</span><span class="op">)</span></span>
<span><span class="va">X_pruned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/getME.html" class="external-link">getME</a></span><span class="op">(</span><span class="va">final_mixed</span>, <span class="st">"X"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute VIF</span></span>
<span><span class="va">compute_vif</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">X_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>  <span class="co"># Remove intercept</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X_scaled</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">X_scaled</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="va">X_scaled</span><span class="op">[</span>, <span class="op">-</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span>
<span>    <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r2</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">vif_full</span> <span class="op">&lt;-</span> <span class="fu">compute_vif</span><span class="op">(</span><span class="va">X_full</span><span class="op">)</span></span>
<span><span class="va">vif_pruned</span> <span class="op">&lt;-</span> <span class="fu">compute_vif</span><span class="op">(</span><span class="va">X_pruned</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare</span></span>
<span><span class="va">comparison_vif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Predictor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X_pruned</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  VIF_Before <span class="op">=</span> <span class="va">vif_full</span>,</span>
<span>  VIF_After <span class="op">=</span> <span class="va">vif_pruned</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison_vif</span><span class="op">)</span></span></code></pre></div>
<p>All remaining predictors now have VIF &lt; 5, indicating acceptable
multicollinearity levels for mixed-effects modeling.</p>
</div>
<div class="section level4">
<h4 id="vif-reduction-visualization">VIF reduction visualization<a class="anchor" aria-label="anchor" href="#vif-reduction-visualization"></a>
</h4>
<p>The plot below shows how pruning reduced VIF values across the
retained fixed effects:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract VIF values</span></span>
<span><span class="va">predictors</span> <span class="op">&lt;-</span> <span class="va">comparison_vif</span><span class="op">$</span><span class="va">Predictor</span></span>
<span><span class="va">vif_before</span> <span class="op">&lt;-</span> <span class="va">comparison_vif</span><span class="op">$</span><span class="va">VIF_Before</span></span>
<span><span class="va">vif_after</span> <span class="op">&lt;-</span> <span class="va">comparison_vif</span><span class="op">$</span><span class="va">VIF_After</span></span>
<span></span>
<span><span class="co"># Set up bar positions</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span></span>
<span><span class="va">width</span> <span class="op">&lt;-</span> <span class="fl">0.35</span></span>
<span></span>
<span><span class="co"># Create plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>, <span class="va">vif_before</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  xaxt <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Fixed Effects"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"VIF"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"VIF Reduction After Pruning (Mixed Model)"</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">vif_before</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.15</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add horizontal line at VIF = 5 threshold</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Before bars (darker)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span> <span class="op">-</span> <span class="va">width</span>, <span class="fl">0</span>,</span>
<span>  <span class="va">x</span>, <span class="va">vif_before</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># After bars (lighter)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>, <span class="fl">0</span>,</span>
<span>  <span class="va">x</span> <span class="op">+</span> <span class="va">width</span>, <span class="va">vif_after</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add x-axis labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="va">x</span>, labels <span class="op">=</span> <span class="va">predictors</span>, las <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"topright"</span>,</span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before Pruning"</span>, <span class="st">"After Pruning"</span>, <span class="st">"VIF = 5 Threshold"</span><span class="op">)</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"white"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">"o"</span>,</span>
<span>  bg <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>These four workflows demonstrate how <strong>corrselect</strong>
integrates into diverse analytical pipelines:</p>
<p><strong>Key takeaways</strong>:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Ecological modeling</strong>: Two-stage pruning
(correlation → VIF) balances fit and stability</p></li>
<li><p><strong>Survey analysis</strong>: <code>force_in</code> protects
theoretically important variables while reducing redundancy</p></li>
<li><p><strong>High-dimensional data</strong>: Greedy mode enables fast
pruning when p &gt;&gt; n</p></li>
<li><p><strong>Mixed models</strong>: VIF-based pruning respects
hierarchical structure by targeting only fixed effects</p></li>
</ol>
<p><strong>Workflow selection guide</strong>:</p>
<table class="table">
<colgroup>
<col width="27%">
<col width="27%">
<col width="44%">
</colgroup>
<thead><tr class="header">
<th>Scenario</th>
<th>Function</th>
<th>Key Parameters</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Small to moderate p (&lt; 50)</td>
<td><code><a href="../reference/corrPrune.html">corrPrune()</a></code></td>
<td>
<code>mode = "auto"</code> or <code>"exact"</code>
</td>
</tr>
<tr class="even">
<td>High-dimensional (p &gt;&gt; n)</td>
<td><code><a href="../reference/corrPrune.html">corrPrune()</a></code></td>
<td><code>mode = "greedy"</code></td>
</tr>
<tr class="odd">
<td>Model-based refinement</td>
<td><code><a href="../reference/modelPrune.html">modelPrune()</a></code></td>
<td>
<code>limit</code> (VIF threshold)</td>
</tr>
<tr class="even">
<td>Protected variables</td>
<td><code><a href="../reference/corrPrune.html">corrPrune()</a></code></td>
<td><code>force_in</code></td>
</tr>
<tr class="odd">
<td>Mixed-effects models</td>
<td><code><a href="../reference/modelPrune.html">modelPrune()</a></code></td>
<td><code>engine = "lme4"</code></td>
</tr>
</tbody>
</table>
<p><strong>When to use each approach</strong>:</p>
<ul>
<li><p><strong>corrPrune()</strong>: First-stage dimensionality
reduction based purely on pairwise correlations</p></li>
<li><p><strong>modelPrune()</strong>: Second-stage refinement that
accounts for model-specific multicollinearity (VIF)</p></li>
<li><p><strong>Combining both</strong>: Often yields best results
(correlation pruning → VIF refinement → final model)</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li><p><code><a href="../articles/quickstart.html">vignette("quickstart")</a></code> - Interface overview</p></li>
<li><p><code><a href="../articles/advanced.html">vignette("advanced")</a></code> - Custom engines and
algorithmic control</p></li>
<li><p><code><a href="../articles/comparison.html">vignette("comparison")</a></code> - Comparison with
alternatives</p></li>
<li><p><code><a href="../articles/theory.html">vignette("theory")</a></code> - Mathematical
foundations</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p><strong>Thresholds</strong>:</p>
<ul>
<li><p>O’Brien, R. M. (2007). A caution regarding rules of thumb for
variance inflation factors. <em>Quality &amp; Quantity</em>, 41(5),
673-690.</p></li>
<li><p>Dormann, C. F., et al. (2013). Collinearity: a review of methods
to deal with it. <em>Ecography</em>, 36(1), 27-46.</p></li>
</ul>
<p><strong>Methods</strong>: - See package documentation and JOSS paper
for algorithm details</p>
<div class="section level3">
<h3 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31 ucrt)</span></span>
<span><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64</span></span>
<span><span class="co">#&gt; Running under: Windows 11 x64 (build 26200)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt;   LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] LC_COLLATE=English_United States.utf8 </span></span>
<span><span class="co">#&gt; [2] LC_CTYPE=English_United States.utf8   </span></span>
<span><span class="co">#&gt; [3] LC_MONETARY=English_United States.utf8</span></span>
<span><span class="co">#&gt; [4] LC_NUMERIC=C                          </span></span>
<span><span class="co">#&gt; [5] LC_TIME=English_United States.utf8    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Luxembourg</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] microbenchmark_1.5.0 corrselect_3.1.0    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] svglite_2.2.2     cli_3.6.5         knitr_1.51        rlang_1.1.7      </span></span>
<span><span class="co">#&gt;  [5] xfun_0.55         otel_0.2.0        textshaping_1.0.4 jsonlite_2.0.0   </span></span>
<span><span class="co">#&gt;  [9] htmltools_0.5.9   sass_0.4.10       rmarkdown_2.30    evaluate_1.0.5   </span></span>
<span><span class="co">#&gt; [13] jquerylib_0.1.4   fastmap_1.2.0     yaml_2.3.12       lifecycle_1.0.5  </span></span>
<span><span class="co">#&gt; [17] compiler_4.5.2    codetools_0.2-20  fs_1.6.6          htmlwidgets_1.6.4</span></span>
<span><span class="co">#&gt; [21] Rcpp_1.1.1        systemfonts_1.3.1 digest_0.6.39     R6_2.6.1         </span></span>
<span><span class="co">#&gt; [25] bslib_0.9.0       tools_4.5.2       pkgdown_2.2.0     cachem_1.1.0     </span></span>
<span><span class="co">#&gt; [29] desc_1.4.3</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gcol33" class="external-link">Gilles Colling</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  
<script>
/* SVG Copy Button Functionality */
(function() {
  "use strict";

  // Initialize SVG copy buttons after DOM is ready
  document.addEventListener("DOMContentLoaded", function() {
    if (typeof ClipboardJS === "undefined") {
      console.warn("ClipboardJS not loaded - SVG copy buttons disabled");
      return;
    }

    // Initialize clipboard for SVG copy buttons
    var svgClipboard = new ClipboardJS(".btn-copy-svg", {
      text: function(trigger) {
        var container = trigger.closest(".svg-container");
        if (!container) return "";

        var svg = container.querySelector("svg");
        if (!svg) return "";

        // Clone SVG to avoid modifying the original
        var clone = svg.cloneNode(true);

        // Remove inline-svg class (not needed in copied version)
        clone.classList.remove("inline-svg");

        // Add XML declaration and serialize
        var serializer = new XMLSerializer();
        var svgString = serializer.serializeToString(clone);

        // Add XML declaration if not present
        if (!svgString.startsWith("<?xml")) {
          svgString = '<?xml version="1.0" encoding="UTF-8"?>\n' + svgString;
        }

        return svgString;
      }
    });

    // Handle success
    svgClipboard.on("success", function(e) {
      var btn = e.trigger;
      var originalTitle = btn.getAttribute("data-bs-original-title") || btn.getAttribute("title");

      // Update tooltip to show "Copied!"
      btn.setAttribute("data-bs-original-title", "Copied!");
      var tooltip = bootstrap.Tooltip.getInstance(btn);
      if (tooltip) {
        tooltip.show();
      }

      // Reset after delay
      setTimeout(function() {
        btn.setAttribute("data-bs-original-title", originalTitle);
      }, 1500);

      e.clearSelection();
    });

    // Handle error
    svgClipboard.on("error", function(e) {
      var btn = e.trigger;
      btn.setAttribute("data-bs-original-title", "Press Ctrl+C to copy");
      var tooltip = bootstrap.Tooltip.getInstance(btn);
      if (tooltip) {
        tooltip.show();
      }
    });

    // Initialize tooltips for SVG copy buttons
    var svgCopyButtons = document.querySelectorAll(".btn-copy-svg");
    svgCopyButtons.forEach(function(btn) {
      new bootstrap.Tooltip(btn, { container: "body" });
    });
  });
})();
</script>
</body>
</html>
