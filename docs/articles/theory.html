<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Theory and Formulation ‚Ä¢ corrselect</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Theory and Formulation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">corrselect</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/quickstart.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/quickstart.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/workflows.html">Workflows</a></li>
    <li><a class="dropdown-item" href="../articles/comparison.html">Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/advanced.html">Advanced</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">Theory</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gcol33/corrselect" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Theory and Formulation</h1>
                        <h4 data-toc-skip class="author">Gilles
Colling</h4>
            
            <h4 data-toc-skip class="date">2025-11-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gcol33/corrselect/blob/HEAD/vignettes/theory.Rmd" class="external-link"><code>vignettes/theory.Rmd</code></a></small>
      <div class="d-none name"><code>theory.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette presents the mathematical formulation and
graph-theoretic foundations underlying <strong>corrselect</strong>.
Variable subset selection under correlation constraints is formulated as
a maximal independent set problem on threshold graphs, enabling exact
enumeration via established algorithms from computational graph theory.
The vignette defines the formal problem statement, explains the
graph-theoretic representation, details the three implemented algorithms
(Bron-Kerbosch, Eppstein-L√∂ffler-Strash, and greedy heuristic), analyzes
their computational complexity, and provides comprehensive references to
the theoretical literature. For practical usage examples, see
<code><a href="../articles/quickstart.html">vignette("quickstart")</a></code> and
<code><a href="../articles/workflows.html">vignette("workflows")</a></code>. For algorithmic control and
performance tuning, see <code><a href="../articles/advanced.html">vignette("advanced")</a></code>.</p>
<hr>
</div>
<div class="section level2">
<h2 id="terminology">Terminology<a class="anchor" aria-label="anchor" href="#terminology"></a>
</h2>
<p>This section defines the core terms used throughout the
documentation. All other vignettes refer back to these definitions.</p>
<div class="section level3">
<h3 id="association-measure">
<strong>Association measure</strong><a class="anchor" aria-label="anchor" href="#association-measure"></a>
</h3>
<p>A symmetric function<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>:</mo><mi>ùí≥</mi><mo>√ó</mo><mi>ùí≥</mi><mo>‚Üí</mo><mi>‚Ñù</mi></mrow><annotation encoding="application/x-tex">a: \mathcal{X} \times \mathcal{X} \to \mathbb{R}</annotation></semantics></math><br>
that quantifies the relationship between two variables.</p>
<p>Common cases:</p>
<ul>
<li>
<strong>Numeric‚Äìnumeric:</strong> Pearson‚Äôs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>,
Spearman‚Äôs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\rho_s</annotation></semantics></math>,
Kendall‚Äôs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÑ</mi><mi>K</mi></msub><annotation encoding="application/x-tex">\tau_K</annotation></semantics></math><br>
</li>
<li>
<strong>Categorical‚Äìcategorical:</strong> Cram√©r‚Äôs V<br>
</li>
<li>
<strong>Numeric‚Äìfactor:</strong> eta-squared
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Œ∑</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\eta^2</annotation></semantics></math>
</li>
</ul>
<p>All measures used in the package are normalized so that<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>‚àà</mo><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">|a_{ij}| \in [0,1]</annotation></semantics></math>.</p>
<hr>
</div>
<div class="section level3">
<h3 id="association-matrix">
<strong>Association matrix</strong><a class="anchor" aria-label="anchor" href="#association-matrix"></a>
</h3>
<p>A symmetric
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>√ó</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">p \times p</annotation></semantics></math>
matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
whose entry
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">a_{ij}</annotation></semantics></math>
is the association between variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.<br>
The diagonal satisfies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a_{ii} = 1</annotation></semantics></math>.<br>
For correlation-based analysis,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
typically comes from <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor()</a></code>.</p>
<hr>
</div>
<div class="section level3">
<h3 id="threshold-tau">
<strong>Threshold</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#threshold-tau"></a>
</h3>
<p>A user-defined cutoff in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0,1)</annotation></semantics></math>.<br>
Pairs with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>‚â•</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">|a_{ij}| \ge \tau</annotation></semantics></math>
are considered too strongly associated and cannot both appear in a valid
subset.</p>
<p>Common choices:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÑ</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">\tau = 0.7</annotation></semantics></math>:
modelling<br>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÑ</mi><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\tau = 0.8</annotation></semantics></math>:
genomics<br>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÑ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\tau = 0.5</annotation></semantics></math>:
stringent pruning</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="valid-subset">
<strong>Valid subset</strong><a class="anchor" aria-label="anchor" href="#valid-subset"></a>
</h3>
<p>A subset
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>‚äÜ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">S \subseteq \{1,\dots,p\}</annotation></semantics></math>
satisfying<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">|a_{ij}| &lt; \tau</annotation></semantics></math>
for all distinct
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>‚àà</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">i, j \in S</annotation></semantics></math>.<br>
All pairwise associations within
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
remain below the threshold.</p>
<hr>
</div>
<div class="section level3">
<h3 id="maximal-valid-subset">
<strong>Maximal valid subset</strong><a class="anchor" aria-label="anchor" href="#maximal-valid-subset"></a>
</h3>
<p>A valid subset that cannot be enlarged.<br>
Formally, no variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>‚àâ</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">v \notin S</annotation></semantics></math>
satisfies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>v</mi><mi>i</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">|a_{vi}| &lt; \tau</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>‚àà</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">i \in S</annotation></semantics></math>.</p>
<p>(‚ÄúMaximal‚Äù is not the same as ‚Äúmaximum‚Äù, which refers to the largest
possible subset.)</p>
<hr>
</div>
<div class="section level3">
<h3 id="threshold-graph">
<strong>Threshold graph</strong><a class="anchor" aria-label="anchor" href="#threshold-graph"></a>
</h3>
<p>An undirected graph
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">G = (V, E)</annotation></semantics></math>
where:</p>
<ul>
<li>each vertex in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
represents a variable<br>
</li>
<li>an edge
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math>
exists exactly when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">|a_{ij}| &lt; \tau</annotation></semantics></math>
</li>
</ul>
<p>Edges therefore connect <em>compatible</em> (low-association)
variables.</p>
<hr>
</div>
<div class="section level3">
<h3 id="clique">
<strong>Clique</strong><a class="anchor" aria-label="anchor" href="#clique"></a>
</h3>
<p>A subset of vertices in which every pair is connected by an
edge.<br>
In the threshold graph, cliques correspond to valid subsets.</p>
<hr>
</div>
<div class="section level3">
<h3 id="maximal-clique">
<strong>Maximal clique</strong><a class="anchor" aria-label="anchor" href="#maximal-clique"></a>
</h3>
<p>A clique that cannot be extended by adding any additional
vertex.<br>
Maximal cliques correspond exactly to maximal valid subsets.</p>
<hr>
</div>
<div class="section level3">
<h3 id="forced-in-variables-force_in">
<strong>Forced-in variables</strong> (<code>force_in</code>)<a class="anchor" aria-label="anchor" href="#forced-in-variables-force_in"></a>
</h3>
<p>A set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>‚äÜ</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">F \subseteq V</annotation></semantics></math>
of variables that must appear in all returned solutions.<br>
Only maximal cliques containing all elements of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
are considered.</p>
<hr>
</div>
<div class="section level3">
<h3 id="els-eppsteinl√∂fflerstrash">
<strong>ELS (Eppstein‚ÄìL√∂ffler‚ÄìStrash)</strong><a class="anchor" aria-label="anchor" href="#els-eppsteinl%C3%B6fflerstrash"></a>
</h3>
<p>A degeneracy-based algorithm for maximal clique enumeration.<br>
Recommended when <code>force_in</code> is used.</p>
<p>Complexity:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><mi>d</mi><mo>‚ãÖ</mo><msup><mn>3</mn><mrow><mi>d</mi><mi>/</mi><mn>3</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(d \cdot 3^{d/3})</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
is the graph‚Äôs degeneracy.</p>
<hr>
</div>
<div class="section level3">
<h3 id="bronkerbosch">
<strong>Bron‚ÄìKerbosch</strong><a class="anchor" aria-label="anchor" href="#bronkerbosch"></a>
</h3>
<p>A classical backtracking algorithm for enumerating maximal cliques,
optionally with pivoting.<br>
Used by default when <code>force_in</code> is not specified.</p>
<p>Worst-case complexity:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mn>3</mn><mrow><mi>p</mi><mi>/</mi><mn>3</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(3^{p/3})</annotation></semantics></math>.</p>
<hr>
</div>
<div class="section level3">
<h3 id="greedy-mode">
<strong>Greedy mode</strong><a class="anchor" aria-label="anchor" href="#greedy-mode"></a>
</h3>
<p>A fast heuristic that constructs a single maximal clique via greedy
selection.<br>
Runs in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mn>2</mn></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(p^2)</annotation></semantics></math>.<br>
Does not guarantee the largest possible subset.</p>
<hr>
</div>
<div class="section level3">
<h3 id="exact-mode">
<strong>Exact mode</strong><a class="anchor" aria-label="anchor" href="#exact-mode"></a>
</h3>
<p>Enumerates <em>all</em> maximal cliques using ELS or
Bron‚ÄìKerbosch.<br>
Identifies the maximum (largest) valid subset.</p>
<hr>
</div>
<div class="section level3">
<h3 id="auto-mode">
<strong>Auto mode</strong><a class="anchor" aria-label="anchor" href="#auto-mode"></a>
</h3>
<p>Chooses the method automatically:</p>
<ul>
<li>exact mode for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>‚â§</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">p \le 20</annotation></semantics></math><br>
</li>
<li>greedy mode for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">p &gt; 20</annotation></semantics></math>
</li>
</ul>
<p>This balances optimality with computational cost.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="intuitive-overview">Intuitive Overview<a class="anchor" aria-label="anchor" href="#intuitive-overview"></a>
</h2>
<p>Before diving into formal definitions, let‚Äôs build intuition with a
simple conceptual overview.</p>
<div class="section level3">
<h3 id="the-core-idea">The Core Idea<a class="anchor" aria-label="anchor" href="#the-core-idea"></a>
</h3>
<p>Imagine you have a dataset with many predictors, some of which are
highly correlated. For example:</p>
<ul>
<li>Temperature at noon and temperature at 2pm (likely correlated
~0.9)</li>
<li>Monthly income and annual income (perfectly correlated)</li>
<li>Survey items ‚ÄúI am satisfied‚Äù and ‚ÄúI feel happy‚Äù (correlated
~0.7)</li>
</ul>
<p>When building statistical models, including highly correlated
predictors creates problems:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Coefficient instability</strong>: Small data changes cause
large coefficient swings</li>
<li>
<strong>Inflated variance</strong>: Standard errors become
unreliable</li>
<li>
<strong>Interpretability issues</strong>: Hard to isolate individual
predictor effects</li>
</ol>
<p>The solution: <strong>remove redundant predictors</strong> while
keeping as many variables as possible.</p>
</div>
<div class="section level3">
<h3 id="how-corrselect-works">How corrselect Works<a class="anchor" aria-label="anchor" href="#how-corrselect-works"></a>
</h3>
<p>corrselect transforms this statistical problem into a <strong>graph
problem</strong>:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Represent variables as nodes</strong> in a graph</li>
<li>
<strong>Draw edges between compatible variables</strong>
(correlation below threshold œÑ)</li>
<li>
<strong>Find maximal groups</strong> where all nodes are connected
(maximal cliques)</li>
</ol>
<p>Each maximal clique represents a valid subset: a group of variables
where every pair has correlation below œÑ.</p>
</div>
<div class="section level3">
<h3 id="why-maximal-not-maximum">Why ‚ÄúMaximal‚Äù Not ‚ÄúMaximum‚Äù?<a class="anchor" aria-label="anchor" href="#why-maximal-not-maximum"></a>
</h3>
<p>A <strong>maximal</strong> subset cannot be extended by adding more
variables‚Äîit‚Äôs locally complete.</p>
<p>A <strong>maximum</strong> subset is the single largest possible
subset‚Äîglobally optimal.</p>
<p>corrselect finds <strong>all maximal</strong> subsets because:</p>
<ul>
<li>Real datasets often have multiple equally good solutions</li>
<li>You may prefer a smaller subset containing specific variables</li>
<li>Comparing alternatives reveals correlation structure</li>
<li>Exact enumeration is feasible for typical problem sizes</li>
</ul>
</div>
<div class="section level3">
<h3 id="toy-example-4-variables">Toy Example (4 Variables)<a class="anchor" aria-label="anchor" href="#toy-example-4-variables"></a>
</h3>
<p>Consider 4 variables with this correlation matrix:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gillescolling.com/corrselect/">corrselect</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Construct a simple 4x4 correlation matrix</span></span>
<span><span class="va">cor_4var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1.00</span>, <span class="fl">0.85</span>, <span class="fl">0.10</span>, <span class="fl">0.15</span>,</span>
<span>  <span class="fl">0.85</span>, <span class="fl">1.00</span>, <span class="fl">0.12</span>, <span class="fl">0.18</span>,</span>
<span>  <span class="fl">0.10</span>, <span class="fl">0.12</span>, <span class="fl">1.00</span>, <span class="fl">0.75</span>,</span>
<span>  <span class="fl">0.15</span>, <span class="fl">0.18</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_4var</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cor_4var</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cor_4var</span><span class="op">)</span></span>
<span><span class="co">#&gt;      V1   V2   V3   V4</span></span>
<span><span class="co">#&gt; V1 1.00 0.85 0.10 0.15</span></span>
<span><span class="co">#&gt; V2 0.85 1.00 0.12 0.18</span></span>
<span><span class="co">#&gt; V3 0.10 0.12 1.00 0.75</span></span>
<span><span class="co">#&gt; V4 0.15 0.18 0.75 1.00</span></span></code></pre></div>
<p>Observations:</p>
<ul>
<li>
<strong>V1 and V2 are highly correlated</strong> (0.85) - likely
redundant</li>
<li>
<strong>V3 and V4 are moderately correlated</strong> (0.75)</li>
<li>
<strong>Between-group correlations are low</strong> (0.10-0.18)</li>
</ul>
<p>Set threshold œÑ = 0.7. Which pairs violate the threshold?</p>
<ul>
<li>V1-V2: |0.85| ‚â• 0.7 ‚úó (too high)</li>
<li>V3-V4: |0.75| ‚â• 0.7 ‚úó (too high)</li>
<li>All other pairs: &lt; 0.7 ‚úì (acceptable)</li>
</ul>
</div>
<div class="section level3">
<h3 id="graph-representation">Graph Representation<a class="anchor" aria-label="anchor" href="#graph-representation"></a>
</h3>
<p>Now we build the <strong>threshold graph</strong> where edges connect
<em>compatible</em> variables (correlation &lt; 0.7).</p>
<p><strong>Text representation</strong>:</p>
<pre><code>Variables: V1, V2, V3, V4

Edges (|correlation| &lt; 0.7):
  V1 ‚Äî‚Äî V3  (cor = 0.10)
  V1 ‚Äî‚Äî V4  (cor = 0.15)
  V2 ‚Äî‚Äî V3  (cor = 0.12)
  V2 ‚Äî‚Äî V4  (cor = 0.18)

Missing edges (|correlation| ‚â• 0.7):
  V1 ‚®Ø V2  (cor = 0.85, too high)
  V3 ‚®Ø V4  (cor = 0.75, too high)

Maximal cliques (maximal variable subsets):
  {V1, V3}: Both connected, cannot add V2 or V4
  {V1, V4}: Both connected, cannot add V2 or V3
  {V2, V3}: Both connected, cannot add V1 or V4
  {V2, V4}: Both connected, cannot add V1 or V3</code></pre>
<p>Let‚Äôs verify this with code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adjacency matrix for threshold graph (edges where |cor| &lt; 0.7)</span></span>
<span><span class="va">adj_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_4var</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">adj_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>  <span class="co"># No self-loops</span></span>
<span></span>
<span><span class="co"># Visualize as adjacency matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Threshold graph edges (1 = edge exists):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Threshold graph edges (1 = edge exists):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">adj_matrix</span> <span class="op">*</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;    V1 V2 V3 V4</span></span>
<span><span class="co">#&gt; V1  0  0  1  1</span></span>
<span><span class="co">#&gt; V2  0  0  1  1</span></span>
<span><span class="co">#&gt; V3  1  1  0  0</span></span>
<span><span class="co">#&gt; V4  1  1  0  0</span></span></code></pre></div>
<p><strong>Interpretation</strong>: An edge exists between Vi and Vj if
they can coexist in a valid subset.</p>
<ul>
<li>
<strong>V1 connects to</strong>: V3, V4 (not V2)</li>
<li>
<strong>V2 connects to</strong>: V3, V4 (not V1)</li>
<li>
<strong>V3 connects to</strong>: V1, V2 (not V4)</li>
<li>
<strong>V4 connects to</strong>: V1, V2 (not V3)</li>
</ul>
</div>
<div class="section level3">
<h3 id="visual-graph-representation">Visual Graph Representation<a class="anchor" aria-label="anchor" href="#visual-graph-representation"></a>
</h3>
<p>Let‚Äôs visualize this threshold graph with nodes and edges:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Node positions (arranged in a square for clarity)</span></span>
<span><span class="va">node_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0</span>, <span class="fl">1</span>,    <span class="co"># V1 (top-left)</span></span>
<span>  <span class="fl">2</span>, <span class="fl">1</span>,    <span class="co"># V2 (top-right)</span></span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>,    <span class="co"># V3 (bottom-left)</span></span>
<span>  <span class="fl">2</span>, <span class="fl">0</span>     <span class="co"># V4 (bottom-right)</span></span>
<span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot setup</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">node_pos</span>, type <span class="op">=</span> <span class="st">"n"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">2.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Threshold Graph (œÑ = 0.7)\nEdges connect variables with |correlation| &lt; 0.7"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draw edges (where correlation &lt; 0.7)</span></span>
<span><span class="va">edge_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">edge_lwd</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">&lt;</span> <span class="va">j</span> <span class="op">&amp;&amp;</span> <span class="va">adj_matrix</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">node_pos</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">node_pos</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>               <span class="va">node_pos</span><span class="op">[</span><span class="va">j</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">node_pos</span><span class="op">[</span><span class="va">j</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>               col <span class="op">=</span> <span class="va">edge_color</span>, lwd <span class="op">=</span> <span class="va">edge_lwd</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Draw nodes</span></span>
<span><span class="va">node_size</span> <span class="op">&lt;-</span> <span class="fl">0.15</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Node circle</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/symbols.html" class="external-link">symbols</a></span><span class="op">(</span><span class="va">node_pos</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">node_pos</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>          circles <span class="op">=</span> <span class="va">node_size</span>, add <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          inches <span class="op">=</span> <span class="cn">FALSE</span>, bg <span class="op">=</span> <span class="st">"white"</span>, fg <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Node label</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">node_pos</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">node_pos</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="va">i</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.2</span>, font <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Add correlation annotations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.35</span>, <span class="st">"cor = 0.85\n(too high, no edge)"</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.35</span>, <span class="st">"cor = 0.75\n(too high, no edge)"</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Legend showing maximal cliques</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"right"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Maximal cliques:"</span>, <span class="st">"{V1, V3}"</span>, <span class="st">"{V1, V4}"</span>, <span class="st">"{V2, V3}"</span>, <span class="st">"{V2, V4}"</span><span class="op">)</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"o"</span>, bg <span class="op">=</span> <span class="st">"white"</span>, cex <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"black"</span>, <span class="st">"black"</span>, <span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add box around graph</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="theory_files/figure-html/unnamed-chunk-3-1.svg" class="r-plt" alt="Graph visualization with 4 nodes (V1, V2, V3, V4) arranged in a square pattern. Blue edges connect variable pairs with absolute correlation below 0.7 threshold. Red labels on edges show actual correlation values. Large red circles highlight nodes, with white labels. The graph structure reveals two maximal cliques: {V1,V3} and {V2,V4}, corresponding to maximal subsets where all pairwise correlations remain below threshold." width="768"></p>
<p><strong>Graph interpretation</strong>:</p>
<ul>
<li>
<strong>Nodes</strong>: Each variable is a vertex</li>
<li>
<strong>Edges</strong> (blue lines): Connect variables with
correlation &lt; 0.7 (compatible pairs)</li>
<li>
<strong>Missing edges</strong> (no connection): Variables with
correlation ‚â• 0.7 (cannot coexist)
<ul>
<li>V1-V2: No edge (corr = 0.85)</li>
<li>V3-V4: No edge (corr = 0.75)</li>
</ul>
</li>
</ul>
<p><strong>Maximal cliques</strong> (groups where everyone connects to
everyone):</p>
<ol style="list-style-type: decimal">
<li>{V1, V3}: V1‚ÄîV3 edge exists ‚úì, cannot add V2 (no V1‚ÄîV2 edge) or V4
(no V3‚ÄîV4 edge)</li>
<li>{V1, V4}: V1‚ÄîV4 edge exists ‚úì, cannot add V2 (no V1‚ÄîV2 edge) or V3
(no V3‚ÄîV4 edge)</li>
<li>{V2, V3}: V2‚ÄîV3 edge exists ‚úì, cannot add V1 (no V1‚ÄîV2 edge) or V4
(no V3‚ÄîV4 edge)</li>
<li>{V2, V4}: V2‚ÄîV4 edge exists ‚úì, cannot add V1 (no V1‚ÄîV2 edge) or V3
(no V3‚ÄîV4 edge)</li>
</ol>
<p>This visual representation makes the graph-theoretic formulation
concrete: finding maximal valid variable subsets is equivalent to
finding maximal cliques in the threshold graph.</p>
</div>
<div class="section level3">
<h3 id="network-visualization-with-cor_example">Network Visualization with cor_example<a class="anchor" aria-label="anchor" href="#network-visualization-with-cor_example"></a>
</h3>
<p>For larger matrices, we can use igraph to visualize the threshold
graph structure. Let‚Äôs demonstrate with <code>cor_example</code>, which
has 20 variables with known block structure:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cor_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build threshold graph (edges where |correlation| &lt; 0.7)</span></span>
<span><span class="va">threshold</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">adj_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_example</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">threshold</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">adj_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"igraph"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Create graph from adjacency matrix</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">adj_mat</span>, mode <span class="op">=</span> <span class="st">"undirected"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Find maximal cliques</span></span>
<span>  <span class="va">cliques</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/cliques.html" class="external-link">max_cliques</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Found %d maximal cliques at threshold %.1f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cliques</span><span class="op">)</span>, <span class="va">threshold</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Color nodes by which block they belong to</span></span>
<span>  <span class="va">block_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#d73027"</span>, <span class="fl">5</span><span class="op">)</span>,   <span class="co"># Block 1 (V1-V5): high correlation</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#fc8d59"</span>, <span class="fl">5</span><span class="op">)</span>,   <span class="co"># Block 2 (V6-V10): moderate</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#91bfdb"</span>, <span class="fl">5</span><span class="op">)</span>,   <span class="co"># Block 3 (V11-V15): low</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#4575b4"</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>   <span class="co"># Block 4 (V16-V20): minimal</span></span>
<span></span>
<span>  <span class="co"># Plot network</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g</span>,</span>
<span>       vertex.size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>       vertex.color <span class="op">=</span> <span class="va">block_colors</span>,</span>
<span>       vertex.label.cex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>       vertex.label.color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>       edge.color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>       edge.width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       layout <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/layout_with_fr.html" class="external-link">layout_with_fr</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>,</span>
<span>       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Threshold Graph (œÑ = %.1f): Variables with |cor| &lt; %.1f are connected"</span>,</span>
<span>                     <span class="va">threshold</span>, <span class="va">threshold</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Add legend</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,</span>
<span>         legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Block 1 (V1-V5): High cor"</span>,</span>
<span>                   <span class="st">"Block 2 (V6-V10): Moderate cor"</span>,</span>
<span>                   <span class="st">"Block 3 (V11-V15): Low cor"</span>,</span>
<span>                   <span class="st">"Block 4 (V16-V20): Minimal cor"</span><span class="op">)</span>,</span>
<span>         fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#d73027"</span>, <span class="st">"#fc8d59"</span>, <span class="st">"#91bfdb"</span>, <span class="st">"#4575b4"</span><span class="op">)</span>,</span>
<span>         bty <span class="op">=</span> <span class="st">"o"</span>, bg <span class="op">=</span> <span class="st">"white"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Install igraph for network visualization: install.packages('igraph')\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Adjacency matrix (first 5√ó5 block):\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">adj_mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'igraph'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     decompose, spectrum</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     union</span></span>
<span><span class="co">#&gt; Found 5 maximal cliques at threshold 0.7</span></span></code></pre></div>
<p><img src="theory_files/figure-html/unnamed-chunk-4-1.svg" class="r-plt" alt="Network graph visualization of 20 variables organized into 4 correlation blocks. Nodes are colored by block: red (Block 1, V1-V5, high correlation), orange (Block 2, V6-V10, moderate), light blue (Block 3, V11-V15, low), and dark blue (Block 4, V16-V20, minimal). Gray edges connect variables with absolute correlation below 0.7 threshold. The force-directed layout clusters highly correlated variables together, revealing the block structure. Variables within blocks have few connections (high correlation), while variables across blocks have many connections (low correlation), illustrating which combinations can form maximal cliques." width="768"></p>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>Variables within high-correlation blocks (red, orange) have
<strong>few or no edges</strong> because their pairwise correlations
exceed 0.7</li>
<li>Variables within low-correlation blocks (light blue, dark blue) have
<strong>many edges</strong> because their correlations are below
0.7</li>
<li>Maximal cliques tend to include variables from multiple
low-correlation blocks</li>
<li>This explains why corrselect tends to select variables from Block 3
and Block 4: they have more compatible neighbors</li>
</ul>
</div>
<div class="section level3">
<h3 id="finding-maximal-cliques">Finding Maximal Cliques<a class="anchor" aria-label="anchor" href="#finding-maximal-cliques"></a>
</h3>
<p>A <strong>clique</strong> is a group where every pair is connected.
In our graph:</p>
<p><strong>Potential cliques</strong>:</p>
<ul>
<li>{V1, V3}: Both connect to each other ‚úì</li>
<li>{V1, V4}: Both connect to each other ‚úì</li>
<li>{V2, V3}: Both connect to each other ‚úì</li>
<li>{V2, V4}: Both connect to each other ‚úì</li>
<li>{V1, V3, V4}: Does V3 connect to V4? No ‚úó</li>
<li>{V2, V3, V4}: Does V3 connect to V4? No ‚úó</li>
</ul>
<p><strong>Maximal cliques:</strong> Can any 2-variable clique be
extended?</p>
<ul>
<li><p><strong>{V1, V3}</strong><br>
Add V2? No (V1‚ÄìV2 not connected).<br>
Add V4? No (V3‚ÄìV4 not connected).<br><strong>Maximal ‚úì</strong></p></li>
<li><p><strong>{V1, V4}</strong><br>
Add V2? No (V1‚ÄìV2 not connected).<br>
Add V3? No (V3‚ÄìV4 not connected).<br><strong>Maximal ‚úì</strong></p></li>
<li><p><strong>{V2, V3}</strong><br>
Add V1? No (V1‚ÄìV2 not connected).<br>
Add V4? No (V3‚ÄìV4 not connected).<br><strong>Maximal ‚úì</strong></p></li>
<li><p><strong>{V2, V4}</strong><br>
Add V1? No (V1‚ÄìV2 not connected).<br>
Add V3? No (V3‚ÄìV4 not connected).<br><strong>Maximal ‚úì</strong></p></li>
</ul>
<p>So there are <strong>4 maximal cliques of size 2</strong>, each
representing a valid variable subset.</p>
<p>Let corrselect confirm this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MatSelect.html">MatSelect</a></span><span class="op">(</span><span class="va">cor_4var</span>, threshold <span class="op">=</span> <span class="fl">0.7</span>, method <span class="op">=</span> <span class="st">"bron-kerbosch"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; CorrCombo object</span></span>
<span><span class="co">#&gt; -----------------</span></span>
<span><span class="co">#&gt;   Method:      bron-kerbosch</span></span>
<span><span class="co">#&gt;   Threshold:   0.700</span></span>
<span><span class="co">#&gt;   Subsets:     4 valid combinations</span></span>
<span><span class="co">#&gt;   Data Rows:   4 used in correlation</span></span>
<span><span class="co">#&gt;   Pivot:       TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Top combinations:</span></span>
<span><span class="co">#&gt;   No.  Variables                          Avg    Max    Size</span></span>
<span><span class="co">#&gt;   ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   [ 1] V1, V3                            0.100  0.100     2</span></span>
<span><span class="co">#&gt;   [ 2] V2, V3                            0.120  0.120     2</span></span>
<span><span class="co">#&gt;   [ 3] V1, V4                            0.150  0.150     2</span></span>
<span><span class="co">#&gt;   [ 4] V2, V4                            0.180  0.180     2</span></span></code></pre></div>
<p><strong>Result interpretation</strong>:</p>
<ul>
<li>4 maximal subsets found (as predicted)</li>
<li>All have size 2 (cannot be extended further)</li>
<li>Each satisfies |correlation| &lt; 0.7 for all pairs</li>
<li>Mean/max correlations are low (well below threshold)</li>
</ul>
</div>
<div class="section level3">
<h3 id="key-insight">Key Insight<a class="anchor" aria-label="anchor" href="#key-insight"></a>
</h3>
<p>This toy example shows why corrselect enumerates all solutions:</p>
<ul>
<li>There‚Äôs no single ‚Äúbest‚Äù subset‚Äîall 4 are equally valid</li>
<li>Choice depends on domain knowledge (which variables are
theoretically important?)</li>
<li>Seeing all options reveals the correlation structure (two clusters:
{V1,V2} and {V3,V4})</li>
</ul>
<p>Real datasets have similar structure but with more variables and more
complex clustering.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="problem-formulation">Problem Formulation<a class="anchor" aria-label="anchor" href="#problem-formulation"></a>
</h2>
<div class="section level3">
<h3 id="intuitive-problem-statement">Intuitive Problem Statement<a class="anchor" aria-label="anchor" href="#intuitive-problem-statement"></a>
</h3>
<p>The core problem is straightforward: given a set of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
variables with known pairwise associations (correlations), identify all
largest possible subsets where every pair of variables has an
association below a user-defined threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>.</p>
<p>Think of this as a social network where variables are people and
edges represent ‚Äúget along well‚Äù (low correlation). We want to find all
maximal groups of people where everyone gets along with everyone else in
the group. A group is ‚Äúmaximal‚Äù if we cannot add any more people without
introducing a conflict.</p>
<p>Some variables may be designated as ‚Äúmust include‚Äù (forced-in). In
the social network analogy, these are VIPs who must be in every group,
so we only search for groups containing all VIPs.</p>
</div>
<div class="section level3">
<h3 id="formal-problem-statement">Formal Problem Statement<a class="anchor" aria-label="anchor" href="#formal-problem-statement"></a>
</h3>
<p><strong>Input:</strong></p>
<ul>
<li>Association matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mi>p</mi><mo>√ó</mo><mi>p</mi></mrow></msup></mrow><annotation encoding="application/x-tex">A \in \mathbb{R}^{p \times p}</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>a</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{ij} = a_{ji}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a_{ii} = 1</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
</li>
<li>Threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÑ</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\tau \in (0, 1)</annotation></semantics></math>
</li>
<li>Optional forced-in set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>‚äÜ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">F \subseteq \{1, \dots, p\}</annotation></semantics></math>
</li>
</ul>
<p><strong>Constraints:</strong></p>
<p>A subset
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>‚äÜ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">S \subseteq \{1, \dots, p\}</annotation></semantics></math>
is valid if:</p>
<ol style="list-style-type: decimal">
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>‚äÜ</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">F \subseteq S</annotation></semantics></math>
(if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
specified)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">|a_{ij}| &lt; \tau</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>‚àà</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">i, j \in S</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>‚â†</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i \neq j</annotation></semantics></math>
</li>
</ol>
<p><strong>Objective:</strong></p>
<p>Find all maximal valid subsets
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùíÆ</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>S</mi><mn>1</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>S</mi><mi>m</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{S} = \{S_1, \dots, S_m\}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mi>k</mi></msub><annotation encoding="application/x-tex">S_k</annotation></semantics></math>
is maximal if no variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>‚àâ</mo><msub><mi>S</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">v \notin S_k</annotation></semantics></math>
satisfies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>v</mi><mi>i</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">|a_{vi}| &lt; \tau</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>‚àà</mo><msub><mi>S</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">i \in S_k</annotation></semantics></math>.</p>
<p><strong>Output:</strong></p>
<p>Collection
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùíÆ</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation></semantics></math>
containing all maximal valid subsets.</p>
<hr>
</div>
<div class="section level3">
<h3 id="association-matrix-1">Association Matrix<a class="anchor" aria-label="anchor" href="#association-matrix-1"></a>
</h3>
<p>Given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
variables, compute an association matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mi>p</mi><mo>√ó</mo><mi>p</mi></mrow></msup></mrow><annotation encoding="application/x-tex">A \in \mathbb{R}^{p \times p}</annotation></semantics></math>
where:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mtext mathvariant="normal">association</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
a_{ij} = \text{association}(X_i, X_j)
</annotation></semantics></math></p>
<p>For numeric variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">a_{ij}</annotation></semantics></math>
may be a correlation coefficient (Pearson, Spearman, Kendall, etc.). For
mixed-type variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">a_{ij}</annotation></semantics></math>
is chosen based on variable types:</p>
<table class="table">
<thead><tr class="header">
<th>Type
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(X_i, X_j)</annotation></semantics></math>
</th>
<th>Measure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>numeric, numeric</td>
<td>Pearson/Spearman/Kendall</td>
</tr>
<tr class="even">
<td>numeric, factor</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Œ∑</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\eta^2</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>numeric, ordered</td>
<td>Spearman/Kendall</td>
</tr>
<tr class="even">
<td>factor, factor</td>
<td>Cram√©r‚Äôs V</td>
</tr>
<tr class="odd">
<td>factor, ordered</td>
<td>Cram√©r‚Äôs V</td>
</tr>
<tr class="even">
<td>ordered, ordered</td>
<td>Spearman/Kendall</td>
</tr>
</tbody>
</table>
<p>All measures are bounded:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>‚àà</mo><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">a_{ij} \in [0, 1]</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>‚àà</mo><mo stretchy="false" form="prefix">[</mo><mi>‚àí</mi><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">a_{ij} \in [-1, 1]</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="threshold-constraint">Threshold Constraint<a class="anchor" aria-label="anchor" href="#threshold-constraint"></a>
</h3>
<p>Fix a threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÑ</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\tau \in (0, 1)</annotation></semantics></math>.
A subset
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>‚äÜ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">S \subseteq \{1, \dots, p\}</annotation></semantics></math>
is <strong>valid</strong> if:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àÄ</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>‚àà</mo><mi>S</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>i</mi><mo>‚â†</mo><mi>j</mi><mo>:</mo><mspace width="1.0em"></mspace><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">
\forall i, j \in S,\ i \neq j: \quad |a_{ij}| &lt; \tau
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="maximal-valid-subsets">Maximal Valid Subsets<a class="anchor" aria-label="anchor" href="#maximal-valid-subsets"></a>
</h3>
<p>A valid subset
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
is <strong>maximal</strong> if no variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>‚àâ</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">k \notin S</annotation></semantics></math>
satisfies:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for all </mtext><mspace width="0.333em"></mspace></mrow><mi>i</mi><mo>‚àà</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">
|a_{ki}| &lt; \tau \quad \text{for all } i \in S
</annotation></semantics></math></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="graph-theoretic-interpretation">Graph-Theoretic Interpretation<a class="anchor" aria-label="anchor" href="#graph-theoretic-interpretation"></a>
</h2>
<div class="section level3">
<h3 id="why-graphs">Why Graphs?<a class="anchor" aria-label="anchor" href="#why-graphs"></a>
</h3>
<p>The variable selection problem has a natural graph representation
that connects it to decades of research in computational graph theory.
By viewing variables as nodes and ‚Äúcompatible pairs‚Äù (low correlation)
as edges, we transform the statistical problem into a well-studied graph
problem with proven algorithms.</p>
<p>This representation is powerful because:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Efficiency</strong>: Graph algorithms exploit structural
properties (sparsity, degeneracy) for faster computation</li>
<li>
<strong>Exactness</strong>: We can enumerate all solutions, not just
find one</li>
<li>
<strong>Forced variables</strong>: Graph algorithms naturally handle
constraints (forced-in sets)</li>
</ol>
<p>The key insight: a group of mutually compatible variables (valid
subset) is exactly a <strong>clique</strong> in a graph where edges
represent compatibility.</p>
</div>
<div class="section level3">
<h3 id="threshold-graph-1">Threshold Graph<a class="anchor" aria-label="anchor" href="#threshold-graph-1"></a>
</h3>
<p>Define the <strong>threshold graph</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">G = (V, E)</annotation></semantics></math>
where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">V = \{1, \dots, p\}</annotation></semantics></math>
(nodes represent variables)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo>‚àà</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">(i, j) \in E</annotation></semantics></math>
if and only if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">|a_{ij}| &lt; \tau</annotation></semantics></math>
(edges connect compatible variables)</li>
</ul>
<p><strong>Note the reversal</strong>: An edge
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math>
means variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
have <em>low</em> correlation (can coexist). This is the complement of
the typical ‚Äúcorrelation graph‚Äù where edges represent high
correlation.</p>
</div>
<div class="section level3">
<h3 id="maximal-cliques">Maximal Cliques<a class="anchor" aria-label="anchor" href="#maximal-cliques"></a>
</h3>
<p>A valid subset
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
corresponds to a <strong>clique</strong> in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>:
all pairs in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
are connected.</p>
<p>A maximal valid subset corresponds to a <strong>maximal
clique</strong>: a clique that cannot be extended.</p>
<p>Finding all maximal valid subsets is equivalent to enumerating all
maximal cliques in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="example-6-variable-threshold-graph">Example: 6-Variable Threshold Graph<a class="anchor" aria-label="anchor" href="#example-6-variable-threshold-graph"></a>
</h3>
<p>Consider 6 variables with correlation matrix:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create example correlation matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">cor_6var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1.00</span>, <span class="fl">0.85</span>, <span class="fl">0.75</span>, <span class="fl">0.20</span>, <span class="fl">0.15</span>, <span class="fl">0.10</span>,</span>
<span>  <span class="fl">0.85</span>, <span class="fl">1.00</span>, <span class="fl">0.80</span>, <span class="fl">0.25</span>, <span class="fl">0.20</span>, <span class="fl">0.15</span>,</span>
<span>  <span class="fl">0.75</span>, <span class="fl">0.80</span>, <span class="fl">1.00</span>, <span class="fl">0.30</span>, <span class="fl">0.25</span>, <span class="fl">0.20</span>,</span>
<span>  <span class="fl">0.20</span>, <span class="fl">0.25</span>, <span class="fl">0.30</span>, <span class="fl">1.00</span>, <span class="fl">0.65</span>, <span class="fl">0.55</span>,</span>
<span>  <span class="fl">0.15</span>, <span class="fl">0.20</span>, <span class="fl">0.25</span>, <span class="fl">0.65</span>, <span class="fl">1.00</span>, <span class="fl">0.60</span>,</span>
<span>  <span class="fl">0.10</span>, <span class="fl">0.15</span>, <span class="fl">0.20</span>, <span class="fl">0.55</span>, <span class="fl">0.60</span>, <span class="fl">1.00</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">6</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cor_6var</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_6var</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display correlation matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cor_6var</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      V1   V2   V3   V4   V5   V6</span></span>
<span><span class="co">#&gt; V1 1.00 0.85 0.75 0.20 0.15 0.10</span></span>
<span><span class="co">#&gt; V2 0.85 1.00 0.80 0.25 0.20 0.15</span></span>
<span><span class="co">#&gt; V3 0.75 0.80 1.00 0.30 0.25 0.20</span></span>
<span><span class="co">#&gt; V4 0.20 0.25 0.30 1.00 0.65 0.55</span></span>
<span><span class="co">#&gt; V5 0.15 0.20 0.25 0.65 1.00 0.60</span></span>
<span><span class="co">#&gt; V6 0.10 0.15 0.20 0.55 0.60 1.00</span></span></code></pre></div>
<p>Threshold graph construction with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÑ</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">\tau = 0.7</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gillescolling.com/corrselect/">corrselect</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build adjacency matrix for threshold graph</span></span>
<span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">adj_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_6var</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">tau</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">adj_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="co"># Visualize correlation structure and threshold graph</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Panel 1: Correlation heatmap</span></span>
<span><span class="va">col_pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#3B4992"</span>, <span class="st">"white"</span>, <span class="st">"#EE0000"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">cor_6var</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>      col <span class="op">=</span> <span class="va">col_pal</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>      main <span class="op">=</span> <span class="st">"Correlation Matrix"</span>,</span>
<span>      axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_6var</span><span class="op">)</span>, cex.axis <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_6var</span><span class="op">)</span>, cex.axis <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add correlation values</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">col_text</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_6var</span><span class="op">[</span><span class="va">j</span>, <span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span> <span class="st">"white"</span> <span class="kw">else</span> <span class="st">"black"</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">i</span>, <span class="fl">7</span> <span class="op">-</span> <span class="va">j</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">cor_6var</span><span class="op">[</span><span class="va">j</span>, <span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         cex <span class="op">=</span> <span class="fl">0.7</span>, col <span class="op">=</span> <span class="va">col_text</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">3.5</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">3.5</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Panel 2: Threshold graph (edges where |cor| &lt; tau)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html" class="external-link">plot.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">plot.window</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Threshold Graph (œÑ = %.1f)"</span>, <span class="va">tau</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Node positions (2 groups based on correlation structure)</span></span>
<span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.2</span>, <span class="fl">0.8</span>,  <span class="co"># V1</span></span>
<span>  <span class="fl">0.3</span>, <span class="fl">0.6</span>,  <span class="co"># V2</span></span>
<span>  <span class="fl">0.1</span>, <span class="fl">0.4</span>,  <span class="co"># V3</span></span>
<span>  <span class="fl">0.7</span>, <span class="fl">0.8</span>,  <span class="co"># V4</span></span>
<span>  <span class="fl">0.8</span>, <span class="fl">0.5</span>,  <span class="co"># V5</span></span>
<span>  <span class="fl">0.9</span>, <span class="fl">0.3</span>   <span class="co"># V6</span></span>
<span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draw edges (compatible variable pairs)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="op">(</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">adj_matrix</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">pos</span><span class="op">[</span><span class="va">j</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">pos</span><span class="op">[</span><span class="va">j</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>            col <span class="op">=</span> <span class="st">"gray70"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Draw nodes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">pos</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">21</span>, cex <span class="op">=</span> <span class="fl">4</span>,</span>
<span>       bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.7</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">pos</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_6var</span><span class="op">)</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"white"</span>, font <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Clique 1 (V1-V3)"</span>, <span class="st">"Clique 2 (V4-V6)"</span>, <span class="st">"Edge: |cor| &lt; 0.7"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">21</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>       pt.bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>       pt.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"black"</span>, <span class="st">"gray70"</span><span class="op">)</span>,</span>
<span>       lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"o"</span>,</span>
<span>       bg <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>       cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="theory_files/figure-html/unnamed-chunk-7-1.svg" class="r-plt" alt="Two side-by-side visualizations for 6-variable example. Left panel: correlation matrix heatmap with blue (negative), white (zero), and red (positive) colors, numerical values overlaid, and black dashed lines separating two correlation blocks. Right panel: threshold graph showing 6 nodes positioned in two groups based on correlation structure, with blue edges connecting variables where absolute correlation is below 0.7. The dual visualization demonstrates how correlation matrix structure translates to threshold graph topology, revealing maximal cliques within and across correlation blocks." width="768"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Interpreting the visualization</strong>:</p>
<p>The left panel shows the correlation matrix with clear block
structure. Variables V1-V3 are highly correlated with each other
(correlations 0.75-0.85, shown in red), as are V4-V6 (correlations
0.55-0.65). Between-block correlations are low (0.10-0.30, shown in
blue/white).</p>
<p>The right panel shows the corresponding threshold graph with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÑ</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">\tau = 0.7</annotation></semantics></math>.
An edge connects two variables if their absolute correlation is
<em>below</em> 0.7 (compatible variables). Note that:</p>
<ul>
<li>
<strong>Within high-correlation groups</strong>: V1-V3 have no edges
connecting them (correlations exceed 0.7). Similarly, V4-V6 are not
fully connected.</li>
<li>
<strong>Between groups</strong>: All V1-V3 to V4-V6 pairs have edges
(low between-group correlation).</li>
</ul>
<p>This graph structure immediately reveals the two maximal cliques:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>V</mi><mn>1</mn><mo>,</mo><mi>V</mi><mn>2</mn><mo>,</mo><mi>V</mi><mn>3</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{V1, V2, V3\}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>V</mi><mn>4</mn><mo>,</mo><mi>V</mi><mn>5</mn><mo>,</mo><mi>V</mi><mn>6</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{V4, V5, V6\}</annotation></semantics></math>.
No variable can be added to either clique without violating the
threshold constraint.</p>
<p>Identify maximal cliques:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run MatSelect to find all maximal subsets</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MatSelect.html">MatSelect</a></span><span class="op">(</span><span class="va">cor_6var</span>, threshold <span class="op">=</span> <span class="fl">0.7</span>, method <span class="op">=</span> <span class="st">"els"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; CorrCombo object</span></span>
<span><span class="co">#&gt; -----------------</span></span>
<span><span class="co">#&gt;   Method:      els</span></span>
<span><span class="co">#&gt;   Threshold:   0.700</span></span>
<span><span class="co">#&gt;   Subsets:     3 valid combinations</span></span>
<span><span class="co">#&gt;   Data Rows:   6 used in correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Top combinations:</span></span>
<span><span class="co">#&gt;   No.  Variables                          Avg    Max    Size</span></span>
<span><span class="co">#&gt;   ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   [ 1] V1, V4, V5, V6                    0.375  0.650     4</span></span>
<span><span class="co">#&gt;   [ 2] V2, V4, V5, V6                    0.400  0.650     4</span></span>
<span><span class="co">#&gt;   [ 3] V3, V4, V5, V6                    0.425  0.650     4</span></span></code></pre></div>
<p><strong>Interpreting the results</strong>:</p>
<p>MatSelect identified two maximal subsets of size 3, exactly matching
the visual graph analysis. Both subsets satisfy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">|a_{ij}| &lt; 0.7</annotation></semantics></math>
for all pairs within the subset.</p>
<ul>
<li>
<strong>Subset 1</strong> (V1, V2, V3): Mean correlation 0.80, max
0.85 - highly redundant within-group</li>
<li>
<strong>Subset 2</strong> (V4, V5, V6): Mean correlation 0.60, max
0.65 - moderately correlated within-group</li>
</ul>
<p>Neither subset can be extended: adding any variable from the other
group would introduce a pair with correlation above 0.7. For this
symmetric example, both subsets have equal size and are equally valid
solutions. In practice, you might choose based on domain knowledge
(prefer variables with established theory) or downstream model
performance.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="from-theory-to-implementation">From Theory to Implementation<a class="anchor" aria-label="anchor" href="#from-theory-to-implementation"></a>
</h2>
<p>The mathematical concepts defined earlier map directly onto the
function arguments and behavior of the package. The correspondence is
outlined below.</p>
<hr>
<div class="section level3">
<h3 id="threshold-tau-threshold-argument">
<strong>Threshold
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>)
‚Üí <code>threshold</code> argument</strong><a class="anchor" aria-label="anchor" href="#threshold-tau-threshold-argument"></a>
</h3>
<p>Controls which edges appear in the threshold graph.</p>
<ul>
<li>
<code>corrPrune(data, threshold = 0.7)</code> keeps an edge only if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">|a_{ij}| &lt; 0.7</annotation></semantics></math>
</li>
<li>Lower thresholds ‚Üí stricter pruning ‚Üí sparser graphs ‚Üí smaller valid
subsets</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="maximal-cliques-returned-subsets">
<strong>Maximal cliques ‚Üí Returned subsets</strong><a class="anchor" aria-label="anchor" href="#maximal-cliques-returned-subsets"></a>
</h3>
<ul>
<li>
<code><a href="../reference/corrSelect.html">corrSelect()</a></code> returns <strong>all</strong> maximal
cliques (full exact enumeration)</li>
<li>
<code><a href="../reference/corrPrune.html">corrPrune()</a></code> returns <strong>one</strong> maximal clique
(greedy or exact, depending on mode)</li>
<li>Each clique corresponds exactly to a valid variable subset
satisfying the threshold constraint</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="forced-in-set-f-force_in-argument">
<strong>Forced-in set
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>)
‚Üí <code>force_in</code> argument</strong><a class="anchor" aria-label="anchor" href="#forced-in-set-f-force_in-argument"></a>
</h3>
<p>Ensures that certain variables appear in every returned subset.</p>
<ul>
<li><code>corrPrune(data, threshold = 0.7, force_in = c("age", "gender"))</code></li>
<li>Internally, the algorithm verifies that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
itself is a valid subset (all pairs in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
satisfy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">|a_{ij}| &lt; \tau</annotation></semantics></math>)</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="search-type-mode-and-method-arguments">
<strong>Search type ‚Üí <code>mode</code> and <code>method</code>
arguments</strong><a class="anchor" aria-label="anchor" href="#search-type-mode-and-method-arguments"></a>
</h3>
<ul>
<li>
<code>mode = "exact"</code><br>
Enumerates all maximal cliques using ELS or Bron‚ÄìKerbosch</li>
<li>
<code>mode = "greedy"</code><br>
Constructs a single maximal clique via a greedy heuristic</li>
<li>
<code>mode = "auto"</code><br>
Uses exact mode for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>‚â§</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">p \le 20</annotation></semantics></math>,
greedy mode for larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
</li>
</ul>
<p>Choice of enumeration algorithm:</p>
<ul>
<li>
<code>method = "els"</code><br>
Eppstein‚ÄìL√∂ffler‚ÄìStrash; recommended when <code>force_in</code> is
specified</li>
<li>
<code>method = "bron-kerbosch"</code><br>
Bron‚ÄìKerbosch with pivoting (default)</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="association-matrix-a-data-input-and-matrix-based-functions">
<strong>Association matrix
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>)
‚Üí Data input and matrix-based functions</strong><a class="anchor" aria-label="anchor" href="#association-matrix-a-data-input-and-matrix-based-functions"></a>
</h3>
<p>How the association structure enters the algorithm:</p>
<ul>
<li>
<code>corrPrune(data)</code><br>
Computes the correlation matrix internally and finds cliques</li>
<li>
<code>MatSelect(cor_matrix)</code><br>
Uses a precomputed association matrix directly</li>
<li>
<code>assocSelect(data)</code><br>
Computes mixed association measures (Pearson, eta-squared, Cram√©r‚Äôs V)
before selection</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="graph-density-performance-considerations">
<strong>Graph density ‚Üí Performance considerations</strong><a class="anchor" aria-label="anchor" href="#graph-density-performance-considerations"></a>
</h3>
<p>Depends directly on the threshold:</p>
<ul>
<li>Sparse graphs (low
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>)<br>
Few edges ‚Üí fast exact enumeration</li>
<li>Dense graphs (high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>)<br>
Many edges ‚Üí potentially exponential growth in maximal cliques</li>
</ul>
<p>These properties motivate the <code>auto</code> mode: exact for small
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,
greedy for larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>.</p>
<hr>
</div>
<div class="section level3">
<h3 id="example-mapping">
<strong>Example mapping</strong><a class="anchor" aria-label="anchor" href="#example-mapping"></a>
</h3>
<p>Mathematical formulation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mtext mathvariant="normal">Find all maximal </mtext><mspace width="0.333em"></mspace></mrow><mi>S</mi><mo>‚äÜ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> such that </mtext><mspace width="0.333em"></mspace></mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mn>0.7</mn><mspace width="0.222em"></mspace><mo>‚àÄ</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>‚àà</mo><mi>S</mi><mo>,</mo><mspace width="0.222em"></mspace><mrow><mtext mathvariant="normal">with </mtext><mspace width="0.333em"></mspace></mrow><mo stretchy="false" form="prefix">{</mo><mtext mathvariant="normal">age</mtext><mo stretchy="false" form="postfix">}</mo><mo>‚äÜ</mo><mi>S</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{Find all maximal } S \subseteq \{1,\dots,p\} \text{ such that } |a_{ij}| &lt; 0.7\ \forall i, j \in S,\ \text{with } \{ \text{age} \} \subseteq S.
</annotation></semantics></math></p>
<p>Implementation:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrSelect.html">corrSelect</a></span><span class="op">(</span></span>
<span>  data      <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.7</span>,      <span class="co"># œÑ = 0.7</span></span>
<span>  force_in  <span class="op">=</span> <span class="st">"age"</span>,    <span class="co"># F = {age}</span></span>
<span>  mode      <span class="op">=</span> <span class="st">"exact"</span>,  <span class="co"># enumerate all maximal cliques</span></span>
<span>  method    <span class="op">=</span> <span class="st">"els"</span>     <span class="co"># use ELS algorithm (recommended with force_in)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The returned object contains all maximal cliques, each representing a
valid variable subset that satisfies the threshold constraint and
includes the required variables.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="search-algorithms">Search Algorithms<a class="anchor" aria-label="anchor" href="#search-algorithms"></a>
</h2>
<div class="section level3">
<h3 id="exact-enumeration">Exact Enumeration<a class="anchor" aria-label="anchor" href="#exact-enumeration"></a>
</h3>
<p>Two algorithms enumerate all maximal cliques exactly:</p>
<div class="section level4">
<h4 id="eppsteinl√∂fflerstrash-els">Eppstein‚ÄìL√∂ffler‚ÄìStrash (ELS)<a class="anchor" aria-label="anchor" href="#eppsteinl%C3%B6fflerstrash-els"></a>
</h4>
<p>Uses degeneracy ordering to structure the search:</p>
<ol style="list-style-type: decimal">
<li>Compute degeneracy ordering
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>v</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">v_1, \dots, v_p</annotation></semantics></math>
</li>
<li>For each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mi>i</mi></msub><annotation encoding="application/x-tex">v_i</annotation></semantics></math>,
extend cliques within candidates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>v</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>v</mi><mi>p</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{v_{i+1}, \dots, v_p\}</annotation></semantics></math>
</li>
<li>Recursively build cliques, pruning when no extension is
possible</li>
</ol>
<p>Formally, define:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">extend</mtext><mo stretchy="false" form="prefix">(</mo><mi>R</mi><mo>,</mo><mi>P</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mo stretchy="false" form="prefix">{</mo><mi>R</mi><mo stretchy="false" form="postfix">}</mo><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>P</mi><mo>=</mo><mi>‚àÖ</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><munder><mo>‚ãÉ</mo><mrow><mi>v</mi><mo>‚àà</mo><mi>P</mi></mrow></munder><mtext mathvariant="normal">extend</mtext><mo stretchy="false" form="prefix">(</mo><mi>R</mi><mo>‚à™</mo><mo stretchy="false" form="prefix">{</mo><mi>v</mi><mo stretchy="false" form="postfix">}</mo><mo>,</mo><mi>P</mi><mo>‚à©</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mi>v</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{extend}(R, P) =
\begin{cases}
\{R\}, &amp; P = \emptyset \\
\bigcup_{v \in P} \text{extend}(R \cup \{v\}, P \cap N(v)), &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mi>v</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">N(v)</annotation></semantics></math>
denotes neighbors of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="bronkerbosch-1">Bron‚ÄìKerbosch<a class="anchor" aria-label="anchor" href="#bronkerbosch-1"></a>
</h4>
<p>Classical recursive backtracking with optional pivoting.</p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
= current clique,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
= candidates,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
= excluded nodes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">BK</mtext><mo stretchy="false" form="prefix">(</mo><mi>R</mi><mo>,</mo><mi>P</mi><mo>,</mo><mi>X</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">report</mtext><mo stretchy="false" form="prefix">(</mo><mi>R</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>P</mi><mo>=</mo><mi>X</mi><mo>=</mo><mi>‚àÖ</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">for each </mtext><mspace width="0.333em"></mspace></mrow><mi>v</mi><mo>‚àà</mo><mi>P</mi><mo>\</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mi>u</mi><mo stretchy="false" form="postfix">)</mo><mo>:</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mspace width="1.0em"></mspace><mtext mathvariant="normal">BK</mtext><mo stretchy="false" form="prefix">(</mo><mi>R</mi><mo>‚à™</mo><mo stretchy="false" form="prefix">{</mo><mi>v</mi><mo stretchy="false" form="postfix">}</mo><mo>,</mo><mi>P</mi><mo>‚à©</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mi>v</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>X</mi><mo>‚à©</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mi>v</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mspace width="1.0em"></mspace><mi>P</mi><mo>‚Üê</mo><mi>P</mi><mo>\</mo><mo stretchy="false" form="prefix">{</mo><mi>v</mi><mo stretchy="false" form="postfix">}</mo><mo>,</mo><mspace width="1.0em"></mspace><mi>X</mi><mo>‚Üê</mo><mi>X</mi><mo>‚à™</mo><mo stretchy="false" form="prefix">{</mo><mi>v</mi><mo stretchy="false" form="postfix">}</mo></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{BK}(R, P, X) =
\begin{cases}
\text{report}(R), &amp; P = X = \emptyset \\
\text{for each } v \in P \setminus N(u): \\
\quad \text{BK}(R \cup \{v\}, P \cap N(v), X \cap N(v)) \\
\quad P \leftarrow P \setminus \{v\}, \quad X \leftarrow X \cup \{v\}
\end{cases}
</annotation></semantics></math></p>
<p>Pivot
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>‚àà</mo><mi>P</mi><mo>‚à™</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">u \in P \cup X</annotation></semantics></math>
reduces recursive calls.</p>
</div>
<div class="section level4">
<h4 id="pseudocode-for-practitioners">Pseudocode for Practitioners<a class="anchor" aria-label="anchor" href="#pseudocode-for-practitioners"></a>
</h4>
<p><strong>Eppstein-L√∂ffler-Strash (ELS) Algorithm</strong>:</p>
<pre><code>Algorithm: ELS_MaxCliques(Graph G, ForceIn F)
Input: Threshold graph G = (V, E), forced variables F ‚äÜ V
Output: All maximal cliques containing F

1. Validate F forms a clique in G
2. Compute degeneracy ordering: v‚ÇÅ, v‚ÇÇ, ..., v‚Çö
3. Initialize results = []

4. For each vertex v·µ¢ in ordering:
   a. If v·µ¢ ‚àâ F and v·µ¢ not adjacent to all in F:
      Skip v·µ¢ (cannot extend F)

   b. candidates = {v‚±º : j &gt; i and v‚±º adjacent to v·µ¢} ‚à© N(F)
   c. Extend(clique = {v·µ¢} ‚à™ F, candidates, results)

5. Return results

Subroutine: Extend(R, P, results)
  If P is empty:
    Add R to results if maximal
    Return

  For each v in P:
    neighbors = P ‚à© N(v)
    Extend(R ‚à™ {v}, neighbors, results)</code></pre>
<p><strong>Bron-Kerbosch Algorithm</strong>:</p>
<pre><code>Algorithm: BronKerbosch(Graph G, use_pivot = TRUE)
Input: Threshold graph G = (V, E), pivot flag
Output: All maximal cliques

1. Initialize: R = ‚àÖ (current clique)
              P = V (candidates)
              X = ‚àÖ (excluded)
2. Call BK(R, P, X, results)
3. Return results

Subroutine: BK(R, P, X, results)
  If P = ‚àÖ and X = ‚àÖ:
    Add R to results (R is maximal)
    Return

  If use_pivot:
    Choose pivot u from P ‚à™ X with max |P ‚à© N(u)|
    iterate = P \ N(u)  # Skip neighbors of pivot
  Else:
    iterate = P

  For each vertex v in iterate:
    BK(R ‚à™ {v},
       P ‚à© N(v),     # Only candidates adjacent to v
       X ‚à© N(v),     # Only excluded adjacent to v
       results)

    P = P \ {v}      # Remove v from candidates
    X = X ‚à™ {v}      # Add v to excluded</code></pre>
<p><strong>Complexity</strong>:</p>
<ul>
<li>
<strong>ELS</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><mi>d</mi><mo>‚ãÖ</mo><msup><mn>3</mn><mrow><mi>d</mi><mi>/</mi><mn>3</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(d \cdot 3^{d/3})</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
is degeneracy (much faster on sparse graphs)</li>
<li>
<strong>Bron-Kerbosch</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mn>3</mn><mrow><mi>p</mi><mi>/</mi><mn>3</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(3^{p/3})</annotation></semantics></math>
worst case, improved with pivoting</li>
<li>
<strong>Greedy</strong> (below):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mn>2</mn></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(p^2)</annotation></semantics></math>
deterministic polynomial time</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="greedy-heuristic">Greedy Heuristic<a class="anchor" aria-label="anchor" href="#greedy-heuristic"></a>
</h3>
<p>Iteratively removes variables with highest average absolute
association until all pairs satisfy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">|a_{ij}| &lt; \tau</annotation></semantics></math>.</p>
<p>Returns a single valid subset (not necessarily maximal or
optimal).</p>
<p>Complexity:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mn>2</mn></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(p^2)</annotation></semantics></math>
vs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mn>2</mn><mi>p</mi></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(2^p)</annotation></semantics></math>
for exact enumeration.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="algorithm-pseudocode">Algorithm Pseudocode<a class="anchor" aria-label="anchor" href="#algorithm-pseudocode"></a>
</h2>
<div class="section level3">
<h3 id="eppsteinl√∂fflerstrash-els-1">Eppstein‚ÄìL√∂ffler‚ÄìStrash (ELS)<a class="anchor" aria-label="anchor" href="#eppsteinl%C3%B6fflerstrash-els-1"></a>
</h3>
<p><strong>Input</strong>: Graph
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">G = (V, E)</annotation></semantics></math>,
forced-in set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math></p>
<p><strong>Output</strong>: All maximal cliques containing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math></p>
<pre><code>Algorithm ELS(G, F):
  # Step 1: Compute degeneracy ordering
  deg_order ‚Üê ComputeDegeneracyOrdering(G)

  # Step 2: Initialize with forced-in variables
  R ‚Üê F  (current clique)
  P ‚Üê V \ F  (candidate vertices)
  X ‚Üê ‚àÖ  (excluded vertices)

  # Step 3: Validate forced-in set
  for each i, j ‚àà F:
    if (i, j) ‚àâ E:
      return ‚àÖ  (infeasible)

  # Step 4: Recursively enumerate maximal cliques
  return EnumerateCliques(R, P, X, deg_order)

Subroutine EnumerateCliques(R, P, X, ordering):
  # Base case: no candidates, no exclusions ‚Üí maximal clique
  if P = ‚àÖ and X = ‚àÖ:
    report R as maximal clique
    return

  # Recursive case: extend with each candidate
  for each v ‚àà P (in degeneracy order):
    # Extend clique
    R' ‚Üê R ‚à™ {v}

    # Update candidates: keep only neighbors of v
    P' ‚Üê P ‚à© N(v)

    # Update exclusions: keep only neighbors of v
    X' ‚Üê X ‚à© N(v)

    # Recurse
    EnumerateCliques(R', P', X', ordering)

    # Move v from candidates to exclusions
    P ‚Üê P \ {v}
    X ‚Üê X ‚à™ {v}

Subroutine ComputeDegeneracyOrdering(G):
  # Degeneracy ordering: v_1, ..., v_p where each v_i has
  # minimum degree in G[{v_i, ..., v_p}]

  ordering ‚Üê [ ]
  remaining ‚Üê V

  while remaining ‚â† ‚àÖ:
    # Find vertex with minimum degree in induced subgraph
    v ‚Üê argmin_{u ‚àà remaining} |N(u) ‚à© remaining|

    # Add to ordering (reverse order)
    ordering.prepend(v)
    remaining ‚Üê remaining \ {v}

  return ordering</code></pre>
<p><strong>Complexity</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><mi>d</mi><mo>‚ãÖ</mo><msup><mn>3</mn><mrow><mi>d</mi><mi>/</mi><mn>3</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(d \cdot 3^{d/3})</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
is the degeneracy of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>.</p>
<p><strong>Properties:</strong></p>
<ul>
<li>
<strong>Exact:</strong> enumerates all maximal cliques<br>
</li>
<li>
<strong>Efficient on sparse graphs:</strong> performs best when the
threshold graph has low density<br>
</li>
<li>
<strong>Forced-in support:</strong> implemented by initializing the
search with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mi>F</mi></mrow><annotation encoding="application/x-tex">R = F</annotation></semantics></math>
</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="bronkerbosch-with-pivoting">Bron‚ÄìKerbosch with Pivoting<a class="anchor" aria-label="anchor" href="#bronkerbosch-with-pivoting"></a>
</h3>
<p><strong>Input</strong>: Graph
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">G = (V, E)</annotation></semantics></math>,
forced-in set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math></p>
<p><strong>Output</strong>: All maximal cliques containing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math></p>
<pre><code>Algorithm BronKerbosch(G, F):
  # Step 1: Initialize
  R ‚Üê F  (current clique)
  P ‚Üê V \ F  (candidate vertices)
  X ‚Üê ‚àÖ  (excluded vertices)

  # Step 2: Validate forced-in set
  for each i, j ‚àà F:
    if (i, j) ‚àâ E:
      return ‚àÖ  (infeasible)

  # Step 3: Restrict candidates to neighbors of forced-in set
  if F ‚â† ‚àÖ:
    P ‚Üê P ‚à© (‚ãÇ_{v ‚àà F} N(v))

  # Step 4: Enumerate
  return BK(R, P, X)

Subroutine BK(R, P, X):
  # Base case: no candidates, no exclusions ‚Üí maximal clique
  if P = ‚àÖ and X = ‚àÖ:
    report R as maximal clique
    return

  # Choose pivot: vertex with most neighbors in P
  u ‚Üê argmax_{v ‚àà P ‚à™ X} |N(v) ‚à© P|

  # Iterate over non-neighbors of pivot (reduces recursion)
  for each v ‚àà P \ N(u):
    # Extend clique
    R' ‚Üê R ‚à™ {v}

    # Update candidates: keep only neighbors of v
    P' ‚Üê P ‚à© N(v)

    # Update exclusions: keep only neighbors of v
    X' ‚Üê X ‚à© N(v)

    # Recurse
    BK(R', P', X')

    # Move v from candidates to exclusions
    P ‚Üê P \ {v}
    X ‚Üê X ‚à™ {v}</code></pre>
<p><strong>Complexity</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mn>3</mn><mrow><mi>p</mi><mi>/</mi><mn>3</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(3^{p/3})</annotation></semantics></math>
maximal cliques (worst-case).</p>
<p><strong>Properties:</strong></p>
<ul>
<li>
<strong>Exact:</strong> enumerates all maximal cliques<br>
</li>
<li>
<strong>Pivoting reduces recursion:</strong> fewer recursive calls
and tighter branching<br>
</li>
<li><strong>Classical algorithm (1973)</strong></li>
</ul>
<p><strong>Pivot selection:</strong></p>
<ul>
<li>Choosing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
with maximum degree in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
minimizes branching<br>
</li>
<li>Without pivoting:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mn>2</mn><mi>p</mi></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(2^p)</annotation></semantics></math>
recursive calls (exponential)<br>
</li>
<li>With pivoting:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mn>3</mn><mrow><mi>p</mi><mi>/</mi><mn>3</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(3^{p/3})</annotation></semantics></math>
recursive calls (still exponential but significantly tighter)</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="greedy-heuristic-1">Greedy Heuristic<a class="anchor" aria-label="anchor" href="#greedy-heuristic-1"></a>
</h3>
<p><strong>Input</strong>: Association matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,
threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>,
forced-in set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math></p>
<p><strong>Output</strong>: Single valid subset (not necessarily
maximal)</p>
<pre><code>Algorithm GreedyPrune(A, œÑ, F):
  # Step 1: Initialize with all variables
  S ‚Üê {1, ..., p}

  # Step 2: Validate forced-in set
  if F ‚â† ‚àÖ:
    for each i, j ‚àà F:
      if |a_ij| ‚â• œÑ:
        return ‚àÖ  (infeasible)

  # Step 3: Iteratively remove highest-correlated variables
  while ‚àÉ i, j ‚àà S: |a_ij| ‚â• œÑ:
    # Compute average absolute correlation for each variable
    for each v ‚àà S \ F:
      avg[v] ‚Üê (1 / |S| - 1) √ó Œ£_{u ‚àà S, u ‚â† v} |a_vu|

    # Remove variable with highest average correlation
    v_max ‚Üê argmax_{v ‚àà S \ F} avg[v]
    S ‚Üê S \ {v_max}

  # Step 4: Return pruned subset
  return S</code></pre>
<p><strong>Complexity:</strong><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mn>2</mn></msup><mi>k</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(p^2 k)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is the number of variables removed.</p>
<p><strong>Properties:</strong></p>
<ul>
<li>
<strong>Fast:</strong> polynomial-time procedure<br>
</li>
<li>
<strong>Deterministic:</strong> identical input always yields
identical output<br>
</li>
<li>
<strong>Non-optimal:</strong> does not guarantee a maximal or
largest subset<br>
</li>
<li>
<strong>Forced-in support:</strong> variables in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
are never removed</li>
</ul>
<p><strong>Tie-breaking:</strong> When several variables share the same
average absolute correlation:</p>
<ol style="list-style-type: decimal">
<li>Prefer the variable with the lower median absolute correlation<br>
</li>
<li>If still tied, prefer the lexicographically first variable name</li>
</ol>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="forced-variables">Forced Variables<a class="anchor" aria-label="anchor" href="#forced-variables"></a>
</h2>
<p>Constraint: variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>‚äÜ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">F \subseteq \{1, \dots, p\}</annotation></semantics></math>
must appear in all returned subsets.</p>
<div class="section level3">
<h3 id="graph-modification">Graph Modification<a class="anchor" aria-label="anchor" href="#graph-modification"></a>
</h3>
<p>Modify the search:</p>
<ul>
<li>Require
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>‚äÜ</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">F \subseteq S</annotation></semantics></math>
for all valid
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
</li>
<li>Verify
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">|a_{ij}| &lt; \tau</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>‚àà</mo><mi>F</mi></mrow><annotation encoding="application/x-tex">i, j \in F</annotation></semantics></math>
(else problem is infeasible)</li>
<li>Search for maximal extensions of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
within remaining variables</li>
</ul>
<p>Formally, find maximal cliques in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
containing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="correlation-vs-association">Correlation vs Association<a class="anchor" aria-label="anchor" href="#correlation-vs-association"></a>
</h2>
<p><strong>Correlation</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>‚àà</mo><mo stretchy="false" form="prefix">[</mo><mi>‚àí</mi><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">a_{ij} \in [-1, 1]</annotation></semantics></math>,
use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|a_{ij}|</annotation></semantics></math>
in threshold constraint</p>
<p><strong>Association</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>‚àà</mo><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">a_{ij} \in [0, 1]</annotation></semantics></math>,
use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">a_{ij}</annotation></semantics></math>
directly</p>
<p>Mixed-type data uses association matrix with measures chosen per
variable-pair type.</p>
<hr>
</div>
<div class="section level2">
<h2 id="complexity-analysis">Complexity Analysis<a class="anchor" aria-label="anchor" href="#complexity-analysis"></a>
</h2>
<div class="section level3">
<h3 id="exact-enumeration-1">Exact Enumeration<a class="anchor" aria-label="anchor" href="#exact-enumeration-1"></a>
</h3>
<p>Worst-case:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mn>3</mn><mrow><mi>p</mi><mi>/</mi><mn>3</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(3^{p/3})</annotation></semantics></math>
maximal cliques possible</p>
<p>Performance depends on graph density:</p>
<ul>
<li>Sparse (low
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>):
fewer edges, faster enumeration</li>
<li>Dense (high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>):
many edges, exponential growth</li>
</ul>
</div>
<div class="section level3">
<h3 id="greedy-heuristic-2">Greedy Heuristic<a class="anchor" aria-label="anchor" href="#greedy-heuristic-2"></a>
</h3>
<p>Time:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mn>2</mn></msup><mi>k</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(p^2 k)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
= iterations</p>
<p>Space:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mn>2</mn></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(p^2)</annotation></semantics></math>
for storing associations</p>
<p>Deterministic: same input produces same output</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="output-structure">Output Structure<a class="anchor" aria-label="anchor" href="#output-structure"></a>
</h2>
<p>All selection functions return a <code>CorrCombo</code> S4 object
containing:</p>
<ul>
<li>
<code>subset_list</code>: list of character vectors (variable names
per subset)</li>
<li>
<code>avg_corr</code>: numeric vector (mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|a_{ij}|</annotation></semantics></math>
within each subset)</li>
<li>
<code>min_corr</code>: numeric vector (min
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|a_{ij}|</annotation></semantics></math>
within each subset)</li>
<li>
<code>max_corr</code>: numeric vector (max
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|a_{ij}|</annotation></semantics></math>
within each subset)</li>
<li>
<code>threshold</code>: value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
</li>
<li>
<code>forced_in</code>: forced variable names</li>
<li>
<code>cor_method</code>: correlation/association measure used</li>
<li>
<code>n_rows_used</code>: sample size after removing missing
values</li>
</ul>
<p>Results are sorted by:</p>
<ol style="list-style-type: decimal">
<li>Subset size (descending)</li>
<li>Average absolute association (ascending)</li>
</ol>
<hr>
</div>
<div class="section level2">
<h2 id="design-philosophy">Design Philosophy<a class="anchor" aria-label="anchor" href="#design-philosophy"></a>
</h2>
<p>This section explains key design decisions underlying corrselect,
addressing common questions about why certain choices were made.</p>
<div class="section level3">
<h3 id="why-maximal-not-maximum-1">Why ‚ÄúMaximal‚Äù Not ‚ÄúMaximum‚Äù?<a class="anchor" aria-label="anchor" href="#why-maximal-not-maximum-1"></a>
</h3>
<p><strong>Maximal</strong>: Cannot be extended further (locally
optimal) <strong>Maximum</strong>: Largest possible size (globally
optimal)</p>
<p>corrselect enumerates <strong>all maximal</strong> subsets rather
than just finding the <strong>single maximum</strong> subset. Why?</p>
<ol style="list-style-type: decimal">
<li><p><strong>Multiple equally good solutions</strong>: Real datasets
often have many maximal subsets of equal or similar size. Returning only
one discards valuable information about alternative variable
combinations.</p></li>
<li><p><strong>Domain knowledge integration</strong>: Users may prefer a
slightly smaller subset containing specific variables over the globally
largest subset. Having all options enables informed choice.</p></li>
<li><p><strong>Sensitivity analysis</strong>: Comparing multiple maximal
subsets reveals structural properties of the correlation matrix (e.g.,
tight vs loosely connected clusters).</p></li>
<li><p><strong>Computational feasibility</strong>: Finding the maximum
clique is NP-complete and often harder than enumerating all maximal
cliques in practice. Modern maximal clique algorithms (ELS,
Bron-Kerbosch) are highly efficient for typical correlation
structures.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="why-hard-threshold-not-soft-constraint">Why Hard Threshold Not Soft Constraint?<a class="anchor" aria-label="anchor" href="#why-hard-threshold-not-soft-constraint"></a>
</h3>
<p>corrselect enforces a hard threshold:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>œÑ</mi></mrow><annotation encoding="application/x-tex">|a_{ij}| &lt; \tau</annotation></semantics></math>
for all pairs. Alternative approaches use soft constraints (penalty
functions, regularization). Why hard thresholds?</p>
<ol style="list-style-type: decimal">
<li><p><strong>Interpretability</strong>: ‚ÄúNo pair exceeds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>‚Äù
is a clear, verifiable guarantee. Soft constraints produce solutions
where some pairs may exceed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
with unknown magnitude.</p></li>
<li><p><strong>Reproducibility</strong>: Hard thresholds produce
deterministic results. Soft constraints often require tuning parameters
(penalty weights, convergence criteria) that affect
reproducibility.</p></li>
<li><p><strong>Domain-specific requirements</strong>: Fields like
ecological modeling have established thresholds (e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÑ</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">\tau = 0.7</annotation></semantics></math>
for WorldClim variables) based on empirical evidence. Hard thresholds
directly implement these guidelines.</p></li>
<li><p><strong>Exact enumeration</strong>: Hard constraints enable
graph-theoretic formulation with exact algorithms. Soft constraints
typically require heuristic optimization.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="why-graph-algorithms-not-optimization">Why Graph Algorithms Not Optimization?<a class="anchor" aria-label="anchor" href="#why-graph-algorithms-not-optimization"></a>
</h3>
<p>corrselect uses specialized graph algorithms (ELS, Bron-Kerbosch)
rather than general optimization frameworks (integer programming,
metaheuristics). Why?</p>
<ol style="list-style-type: decimal">
<li><p><strong>Asymptotic efficiency</strong>: Graph algorithms exploit
structural properties (sparsity, degeneracy) unavailable to generic
solvers. For sparse graphs (low
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>),
this yields orders-of-magnitude speedups.</p></li>
<li><p><strong>Exact enumeration</strong>: Graph algorithms guarantee
finding all maximal cliques. Optimization approaches typically find one
solution.</p></li>
<li><p><strong>Forced variables</strong>: Graph algorithms naturally
handle forced-in constraints via initialization. Optimization approaches
require additional constraints that may degrade performance.</p></li>
<li><p><strong>Established theory</strong>: Maximal clique enumeration
has 50+ years of algorithmic development with proven complexity bounds
and implementation strategies.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="why-pairwise-associations-only">Why Pairwise Associations Only?<a class="anchor" aria-label="anchor" href="#why-pairwise-associations-only"></a>
</h3>
<p>corrselect considers only pairwise associations, not higher-order
interactions (partial correlations, conditional independence). Why?</p>
<ol style="list-style-type: decimal">
<li><p><strong>Computational tractability</strong>: Higher-order
interactions require exponentially more computation. For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
variables, pairwise methods scale as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mn>2</mn></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(p^2)</annotation></semantics></math>,
while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-way
interactions scale as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mi>k</mi></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(p^k)</annotation></semantics></math>.</p></li>
<li><p><strong>Clear interpretation</strong>: ‚ÄúVariables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
correlate at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0.85</mn></mrow><annotation encoding="application/x-tex">r = 0.85</annotation></semantics></math>‚Äù
is directly interpretable. Partial correlations require careful
conditioning set selection and can be counterintuitive.</p></li>
<li><p><strong>Robustness</strong>: Pairwise correlations are stable
with moderate sample sizes. Partial correlations require
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â´</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n \gg p</annotation></semantics></math>
and are sensitive to model misspecification.</p></li>
<li><p><strong>Method generality</strong>: Pairwise associations work
for any variable type (numeric, categorical, mixed). Higher-order
methods often require strong distributional assumptions.</p></li>
</ol>
<p><strong>When higher-order methods are appropriate</strong>: If your
goal is causal discovery (identifying conditional independence
structure), use methods like PC algorithm or constraint-based causal
inference. corrselect focuses on reducing redundancy for predictive
modeling and descriptive analysis.</p>
</div>
<div class="section level3">
<h3 id="why-enumerate-all-solutions-not-just-return-one">Why Enumerate All Solutions Not Just Return One?<a class="anchor" aria-label="anchor" href="#why-enumerate-all-solutions-not-just-return-one"></a>
</h3>
<p>Many correlation-pruning tools (e.g., caret::findCorrelation) return
a single subset. corrselect can return all maximal subsets (exact mode)
or one (greedy mode). Why offer exhaustive enumeration?</p>
<ol style="list-style-type: decimal">
<li><p><strong>Alternative solutions</strong>: Multiple maximal subsets
represent genuinely different variable combinations that all satisfy the
threshold constraint. Arbitrarily choosing one discards
information.</p></li>
<li><p><strong>Downstream analysis</strong>: Different subsets may be
preferred for different models or research questions. Enumerating all
options enables post-hoc selection criteria.</p></li>
<li><p><strong>Documentation</strong>: For reproducible research
(especially JOSS/CRAN submissions), documenting all valid solutions
provides transparency about algorithmic choices.</p></li>
<li><p><strong>Computational cost</strong>: For typical use cases
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>‚â§</mo><mn>30</mn></mrow><annotation encoding="application/x-tex">p \leq 30</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÑ</mi><mo>‚â•</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\tau \geq 0.5</annotation></semantics></math>),
exhaustive enumeration completes in milliseconds. When infeasible,
greedy mode provides a fast approximation.</p></li>
</ol>
<p><strong>When to use greedy mode</strong>: High-dimensional data
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">p &gt; 50</annotation></semantics></math>),
dense correlation structure (high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>),
or when a single solution suffices (e.g., automated pipelines).</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div class="section level3">
<h3 id="graph-theoretic-algorithms">Graph-Theoretic Algorithms<a class="anchor" aria-label="anchor" href="#graph-theoretic-algorithms"></a>
</h3>
<p><strong>Maximal clique enumeration</strong></p>
<ul>
<li>
<strong>Eppstein, D., L√∂ffler, M., &amp; Strash, D.
(2010).</strong><br><em>Listing all maximal cliques in sparse graphs in near-optimal
time.</em><br>
Algorithms and Computation: ISAAC 2010, Lecture Notes in Computer
Science 6506, 403‚Äì414.<br><a href="https://doi.org/10.1007/978-3-642-17517-6_36" class="external-link">doi:10.1007/978-3-642-17517-6_36</a>
<ul>
<li>
<strong>Foundation for the ELS algorithm:</strong> degeneracy-based
maximal clique enumeration<br>
</li>
<li>Complexity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><mi>d</mi><mo>‚ãÖ</mo><msup><mn>3</mn><mrow><mi>d</mi><mi>/</mi><mn>3</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(d \cdot 3^{d/3})</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
is graph degeneracy<br>
</li>
<li>Used when <code>force_in</code> is specified</li>
</ul>
</li>
<li>
<strong>Bron, C., &amp; Kerbosch, J. (1973).</strong><br><em>Algorithm 457: Finding all cliques of an undirected
graph.</em><br>
Communications of the ACM, 16(9), 575‚Äì577.<br><a href="https://doi.org/10.1145/362342.362367" class="external-link">doi:10.1145/362342.362367</a>
<ul>
<li>
<strong>Foundation for the Bron‚ÄìKerbosch algorithm:</strong> classic
backtracking with pivoting<br>
</li>
<li>Default exact enumeration method</li>
</ul>
</li>
<li>
<strong>Tomita, E., Tanaka, A., &amp; Takahashi, H.
(2006).</strong><br><em>The worst-case time complexity for generating all maximal cliques
and computational experiments.</em><br>
Theoretical Computer Science, 363(1), 28‚Äì42.<br><a href="https://doi.org/10.1016/j.tcs.2006.06.015" class="external-link">doi:10.1016/j.tcs.2006.06.015</a>
<ul>
<li>
<strong>Pivoting strategy:</strong> refined pivot rules for
Bron‚ÄìKerbosch<br>
</li>
<li>Establishes the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mn>3</mn><mrow><mi>p</mi><mi>/</mi><mn>3</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(3^{p/3})</annotation></semantics></math>
worst-case bound</li>
</ul>
</li>
</ul>
<p><strong>Graph degeneracy</strong>:</p>
<ul>
<li>Matula, D. W., &amp; Beck, L. L. (1983). Smallest-last ordering and
clustering and graph coloring algorithms. <em>Journal of the ACM</em>,
30(3), 417-427. <a href="https://doi.org/10.1145/2402.322385" class="external-link">doi:10.1145/2402.322385</a>
<ul>
<li>
<strong>Degeneracy ordering</strong>: Fundamental concept for sparse
graph algorithms</li>
<li>Used in ELS algorithm for efficient enumeration</li>
</ul>
</li>
</ul>
<p><strong>Independent sets and vertex cover</strong>:</p>
<ul>
<li>Tsukiyama, S., Ide, M., Ariyoshi, H., &amp; Shirakawa, I. (1977). A
new algorithm for generating all the maximal independent sets. <em>SIAM
Journal on Computing</em>, 6(3), 505-517. <a href="https://doi.org/10.1137/0206036" class="external-link">doi:10.1137/0206036</a>
<ul>
<li>
<strong>Maximal independent set enumeration</strong>: Theoretical
foundation for threshold graph problem</li>
<li>Complements maximal clique enumeration (clique in complement
graph)</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="multicollinearity-and-variable-selection">Multicollinearity and Variable Selection<a class="anchor" aria-label="anchor" href="#multicollinearity-and-variable-selection"></a>
</h3>
<p><strong>Variance inflation factor (VIF)</strong>:</p>
<ul>
<li>Belsley, D. A., Kuh, E., &amp; Welsch, R. E. (1980). <em>Regression
Diagnostics: Identifying Influential Data and Sources of
Collinearity</em>. Wiley. <a href="https://doi.org/10.1002/0471725153" class="external-link">doi:10.1002/0471725153</a>
<ul>
<li>
<strong>Standard reference</strong>: VIF computation and condition
indices for collinearity diagnosis</li>
<li>Foundation for modelPrune() approach</li>
</ul>
</li>
<li>O‚ÄôBrien, R. M. (2007). A caution regarding rules of thumb for
variance inflation factors. <em>Quality &amp; Quantity</em>, 41(5),
673-690. <a href="https://doi.org/10.1007/s11135-006-9018-6" class="external-link">doi:10.1007/s11135-006-9018-6</a>
<ul>
<li>
<strong>Critical evaluation</strong>: Common VIF thresholds (5, 10)
may be inappropriate in some contexts</li>
<li>Recommends context-specific threshold selection</li>
</ul>
</li>
<li>Marquaridt, D. W. (1970). Generalized inverses, ridge regression,
biased linear estimation, and nonlinear estimation.
<em>Technometrics</em>, 12(3), 591-612. <a href="https://doi.org/10.2307/1267205" class="external-link">doi:10.2307/1267205</a>
<ul>
<li>
<strong>Ridge regression</strong>: Alternative approach to handling
multicollinearity via regularization</li>
<li>Contrasts with hard variable removal (corrselect approach)</li>
</ul>
</li>
</ul>
<p><strong>Correlation-based variable selection</strong>:</p>
<ul>
<li>Guyon, I., &amp; Elisseeff, A. (2003). An introduction to variable
and feature selection. <em>Journal of Machine Learning Research</em>, 3,
1157-1182.
<ul>
<li>
<strong>Survey</strong>: Overview of filter, wrapper, and embedded
methods for variable selection</li>
<li>Context for correlation-based filtering (filter method)</li>
</ul>
</li>
<li>Hall, M. A. (1999). Correlation-based feature selection for machine
learning. PhD thesis, University of Waikato.
<ul>
<li>
<strong>Correlation-based feature selection (CFS)</strong>:
Alternative criterion combining feature-class correlation and
feature-feature correlation</li>
<li>Differs from corrselect‚Äôs pairwise-only approach</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="association-measures">Association Measures<a class="anchor" aria-label="anchor" href="#association-measures"></a>
</h3>
<p><strong>Numeric associations</strong>:</p>
<ul>
<li>Pearson, K. (1895). Notes on regression and inheritance in the case
of two parents. <em>Proceedings of the Royal Society of London</em>, 58,
240-242.
<ul>
<li>
<strong>Pearson correlation</strong>: Standard linear association
measure</li>
</ul>
</li>
<li>Spearman, C. (1904). The proof and measurement of association
between two things. <em>American Journal of Psychology</em>, 15(1),
72-101. <a href="https://doi.org/10.2307/1412159" class="external-link">doi:10.2307/1412159</a>
<ul>
<li>
<strong>Spearman‚Äôs rank correlation</strong>: Monotonic association
for ordered data</li>
</ul>
</li>
<li>Kendall, M. G. (1938). A new measure of rank correlation.
<em>Biometrika</em>, 30(1/2), 81-93. <a href="https://doi.org/10.2307/2332226" class="external-link">doi:10.2307/2332226</a>
<ul>
<li>
<strong>Kendall‚Äôs tau</strong>: Alternative rank-based measure,
robust to outliers</li>
</ul>
</li>
</ul>
<p><strong>Categorical associations</strong>:</p>
<ul>
<li>Cram√©r, H. (1946). <em>Mathematical Methods of Statistics</em>.
Princeton University Press.
<ul>
<li>
<strong>Cram√©r‚Äôs V</strong>: Chi-squared-based association for
categorical variables</li>
<li>Used in assocSelect() for factor-factor pairs</li>
</ul>
</li>
<li>Pearson, K. (1900). On the criterion that a given system of
deviations from the probable in the case of a correlated system of
variables is such that it can be reasonably supposed to have arisen from
random sampling. <em>Philosophical Magazine</em>, 50(302), 157-175.
<ul>
<li>
<strong>Chi-squared test</strong>: Foundation for Cram√©r‚Äôs V</li>
</ul>
</li>
</ul>
<p><strong>Mixed-type associations</strong>:</p>
<ul>
<li>Kelley, T. L. (1935). An unbiased correlation ratio measure.
<em>Proceedings of the National Academy of Sciences</em>, 21(9),
554-559.
<ul>
<li>
<strong>Eta-squared (correlation ratio)</strong>: Association
between numeric and categorical variables</li>
<li>Used in assocSelect() for numeric-factor pairs</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="threshold-graph-theory">Threshold Graph Theory<a class="anchor" aria-label="anchor" href="#threshold-graph-theory"></a>
</h3>
<ul>
<li>Mahadev, N. V. R., &amp; Peled, U. N. (1995). <em>Threshold Graphs
and Related Topics</em>. Amsterdam: Elsevier, Annals of Discrete
Mathematics, Vol. 56. <a href="https://doi.org/10.1016/S0167-5060(13)71063-X" class="external-link">doi:10.1016/S0167-5060(13)71063-X</a>
<ul>
<li>
<strong>Comprehensive reference</strong>: Mathematical properties of
threshold graphs</li>
<li>Theoretical foundation for threshold-based graph construction</li>
</ul>
</li>
<li>Chv√°tal, V., &amp; Hammer, P. L. (1977). Aggregation of inequalities
in integer programming. <em>Annals of Discrete Mathematics</em>, 1,
145-162.
<ul>
<li>
<strong>Threshold graph characterization</strong>: Alternative
definitions and recognition algorithms</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="computational-complexity">Computational Complexity<a class="anchor" aria-label="anchor" href="#computational-complexity"></a>
</h3>
<ul>
<li>Garey, M. R., &amp; Johnson, D. S. (1979). <em>Computers and
Intractability: A Guide to the Theory of NP-Completeness</em>. W.H.
Freeman.
<ul>
<li>
<strong>Standard reference</strong>: Complexity classes,
NP-completeness</li>
<li>Context for understanding exponential enumeration complexity</li>
</ul>
</li>
<li>Moon, J. W., &amp; Moser, L. (1965). On cliques in graphs.
<em>Israel Journal of Mathematics</em>, 3(1), 23-28. <a href="https://doi.org/10.1007/BF02760024" class="external-link">doi:10.1007/BF02760024</a>
<ul>
<li>
<strong>Theoretical bound</strong>: Proof that graphs can have up to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>3</mn><mrow><mi>p</mi><mi>/</mi><mn>3</mn></mrow></msup><annotation encoding="application/x-tex">3^{p/3}</annotation></semantics></math>
maximal cliques</li>
<li>Justifies worst-case complexity for exact enumeration</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="applications">Applications<a class="anchor" aria-label="anchor" href="#applications"></a>
</h3>
<p><strong>Bioclimatic modeling</strong>:</p>
<ul>
<li>Dormann, C. F., et al.¬†(2013). Collinearity: a review of methods to
deal with it and a simulation study evaluating their performance.
<em>Ecography</em>, 36(1), 27-46. <a href="https://doi.org/10.1111/j.1600-0587.2012.07348.x" class="external-link">doi:10.1111/j.1600-0587.2012.07348.x</a>
<ul>
<li>
<strong>Species distribution models</strong>: Evaluation of
multicollinearity approaches in ecology</li>
<li>Recommends threshold of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÑ</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">\tau = 0.7</annotation></semantics></math>
for bioclimatic variables</li>
</ul>
</li>
</ul>
<p><strong>Genomics</strong>:</p>
<ul>
<li>Saeys, Y., Inza, I., &amp; Larra√±aga, P. (2007). A review of feature
selection techniques in bioinformatics. <em>Bioinformatics</em>, 23(19),
2507-2517. <a href="https://doi.org/10.1093/bioinformatics/btm344" class="external-link">doi:10.1093/bioinformatics/btm344</a>
<ul>
<li>
<strong>High-dimensional biology</strong>: Variable selection in
genomics and proteomics</li>
<li>Context for correlation-based filtering in gene expression
analysis</li>
</ul>
</li>
</ul>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li>
<code><a href="../articles/quickstart.html">vignette("quickstart")</a></code> - Interface overview and
examples</li>
<li>
<code><a href="../articles/workflows.html">vignette("workflows")</a></code> - Real-world workflow
examples</li>
<li>
<code><a href="../articles/advanced.html">vignette("advanced")</a></code> - Algorithmic control and custom
engines</li>
<li>
<code><a href="../articles/comparison.html">vignette("comparison")</a></code> - Comparison with
alternatives</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gcol33" class="external-link">Gilles Colling</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
