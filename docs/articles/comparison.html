<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Comparison with Alternatives • corrselect</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Comparison with Alternatives">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">corrselect</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/quickstart.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/quickstart.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/workflows.html">Workflows</a></li>
    <li><a class="dropdown-item" href="../articles/comparison.html">Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/advanced.html">Advanced</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">Theory</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gcol33/corrselect" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Comparison with Alternatives</h1>
                        <h4 data-toc-skip class="author">Gilles
Colling</h4>
            
            <h4 data-toc-skip class="date">2025-11-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gcol33/corrselect/blob/HEAD/vignettes/comparison.Rmd" class="external-link"><code>vignettes/comparison.Rmd</code></a></small>
      <div class="d-none name"><code>comparison.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette compares corrselect’s graph-theoretic approach to four
established methods for multicollinearity management and variable
selection:</p>
<ol style="list-style-type: decimal">
<li>
<strong>caret::findCorrelation()</strong> - Greedy correlation-based
pruning</li>
<li>
<strong>Boruta</strong> - Random forest permutation importance</li>
<li>
<strong>glmnet</strong> - L1/L2 regularization (LASSO/Ridge)</li>
<li>
<strong>Manual VIF removal</strong> - Iterative variance inflation
factor thresholding</li>
</ol>
<p>Each comparison examines algorithmic differences, performance
characteristics, and appropriate use cases. Evaluations use the
<code>bioclim_example</code> dataset (19 bioclimatic variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">n = 100</annotation></semantics></math>).</p>
<p>See <code><a href="../articles/theory.html">vignette("theory")</a></code> for mathematical foundations. See
<code><a href="../articles/quickstart.html">vignette("quickstart")</a></code> for usage examples.</p>
<hr>
</div>
<div class="section level2">
<h2 id="evaluation-dataset">Evaluation Dataset<a class="anchor" aria-label="anchor" href="#evaluation-dataset"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bioclim_example</span><span class="op">)</span></span>
<span><span class="va">predictors</span> <span class="op">&lt;-</span> <span class="va">bioclim_example</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>  <span class="co"># Exclude response</span></span>
<span><span class="va">response</span> <span class="op">&lt;-</span> <span class="va">bioclim_example</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Variables:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Variables: 19</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Observations:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observations: 100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Response: species_richness (continuous)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Response: species_richness (continuous)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Correlation heatmap</span></span>
<span><span class="va">col_pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#3B4992"</span>, <span class="st">"white"</span>, <span class="st">"#EE0000"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span></span>
<span><span class="va">nr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">[</span><span class="va">nr</span><span class="op">:</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>      col <span class="op">=</span> <span class="va">col_pal</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      main <span class="op">=</span> <span class="st">"Bioclimatic Variable Correlations (p = 19)"</span>,</span>
<span>      zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">2</span>, cex.axis <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="va">nc</span><span class="op">:</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">2</span>, cex.axis <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">text_col</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">[</span><span class="va">j</span>, <span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.6</span><span class="op">)</span> <span class="st">"white"</span> <span class="kw">else</span> <span class="st">"black"</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">nr</span> <span class="op">-</span> <span class="va">j</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">cor_matrix</span><span class="op">[</span><span class="va">j</span>, <span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         cex <span class="op">=</span> <span class="fl">0.5</span>, col <span class="op">=</span> <span class="va">text_col</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="Correlation heatmap of 19 bioclimatic variables displayed as a color-coded matrix. Blue indicates negative correlations, white indicates near-zero correlations, and red indicates positive correlations. Numerical correlation values are overlaid on each cell. The heatmap reveals block structure with correlations ranging from -0.15 to 0.97, showing strong correlations among temperature-related variables and precipitation-related variables." width="768"></p>
<p>Block structure present: correlations range from -0.15 to 0.97.</p>
<hr>
</div>
<div class="section level2">
<h2 id="comparison-1-caretfindcorrelation">Comparison 1: caret::findCorrelation()<a class="anchor" aria-label="anchor" href="#comparison-1-caretfindcorrelation"></a>
</h2>
<div class="section level3">
<h3 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h3>
<p>caret’s <code>findCorrelation()</code> applies greedy iterative
removal:</p>
<ol style="list-style-type: decimal">
<li>Identify pair with maximum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|r_{ij}|</annotation></semantics></math>
</li>
<li>Remove variable with larger mean absolute correlation</li>
<li>Repeat until all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">|r_{ij}| &lt; \tau</annotation></semantics></math>
</li>
</ol>
<p>Non-deterministic: results depend on internal ordering. Typically
removes more variables than graph-theoretic methods.</p>
</div>
<div class="section level3">
<h3 id="execution">Execution<a class="anchor" aria-label="anchor" href="#execution"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"caret"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Apply caret's greedy algorithm</span></span>
<span>  <span class="va">to_remove_caret</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/findCorrelation.html" class="external-link">findCorrelation</a></span><span class="op">(</span><span class="va">cor_matrix</span>, cutoff <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="va">result_caret</span> <span class="op">&lt;-</span> <span class="va">predictors</span><span class="op">[</span>, <span class="op">-</span><span class="va">to_remove_caret</span><span class="op">]</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"caret results:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Variables retained:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">result_caret</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Variables removed:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">to_remove_caret</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Removed:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span><span class="op">[</span><span class="va">to_remove_caret</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; caret results:</span></span>
<span><span class="co">#&gt;   Variables retained: 10 </span></span>
<span><span class="co">#&gt;   Variables removed: 9 </span></span>
<span><span class="co">#&gt;   Removed: BIO8, BIO7, BIO5, BIO4, BIO3, BIO9, BIO1, BIO11, BIO15</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply corrselect (exact mode)</span></span>
<span><span class="va">result_corrselect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span><span class="va">predictors</span>, threshold <span class="op">=</span> <span class="fl">0.7</span>, mode <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\ncorrselect results:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; corrselect results:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Variables retained:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">result_corrselect</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Variables retained: 12</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Variables removed:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result_corrselect</span>, <span class="st">"removed_vars"</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Variables removed: 7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Removed:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result_corrselect</span>, <span class="st">"removed_vars"</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Removed: BIO2, BIO4, BIO5, BIO7, BIO8, BIO10, BIO15</span></span></code></pre></div>
<p>corrselect retains more variables
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>S</mi><mtext mathvariant="normal">corrselect</mtext></msub><mo stretchy="false" form="prefix">|</mo><mo>≥</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>S</mi><mtext mathvariant="normal">caret</mtext></msub><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|S_{\text{corrselect}}| \ge |S_{\text{caret}}|</annotation></semantics></math>)
via maximal clique enumeration while satisfying identical threshold
constraint.</p>
</div>
<div class="section level3">
<h3 id="distribution-comparison">Distribution Comparison<a class="anchor" aria-label="anchor" href="#distribution-comparison"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract correlations</span></span>
<span><span class="va">cor_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span></span>
<span><span class="va">cor_corrselect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">result_corrselect</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"caret"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cor_caret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">result_caret</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Overlaid histogram comparing all three</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_orig</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">cor_orig</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fl">30</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Distribution of Absolute Correlations"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Absolute Correlation"</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>       xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_caret</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">cor_caret</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fl">30</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>       add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_corrselect</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">cor_corrselect</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fl">30</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>       add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0.7</span>, col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>         legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Original ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span>, <span class="st">" vars)"</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"caret ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">result_caret</span><span class="op">)</span>, <span class="st">" vars)"</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"corrselect ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">result_corrselect</span><span class="op">)</span>, <span class="st">" vars)"</span><span class="op">)</span>,</span>
<span>           <span class="st">"Threshold"</span></span>
<span>         <span class="op">)</span>,</span>
<span>         fill   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>           <span class="cn">NA</span></span>
<span>         <span class="op">)</span>,</span>
<span>         border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"white"</span>, <span class="st">"white"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>         lty    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>         lwd    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>         col    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"black"</span><span class="op">)</span>,</span>
<span>         bty    <span class="op">=</span> <span class="st">"o"</span>,</span>
<span>         bg     <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="Overlaid histogram comparing absolute correlation distributions across three methods: original data (gray bars), caret's findCorrelation (red bars), and corrselect (blue bars). Black vertical dashed line marks the 0.7 threshold. All methods successfully reduce correlations below the threshold, but corrselect retains more variables than caret while still satisfying the constraint, demonstrating the advantage of maximal clique enumeration over greedy removal." width="672"></p>
</div>
<div class="section level3">
<h3 id="comparison">Comparison<a class="anchor" aria-label="anchor" href="#comparison"></a>
</h3>
<table class="table">
<colgroup>
<col width="32%">
<col width="25%">
<col width="42%">
</colgroup>
<thead><tr class="header">
<th>Feature</th>
<th>caret</th>
<th>corrselect</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Algorithm</strong></td>
<td>Greedy iterative removal</td>
<td>Maximal clique enumeration</td>
</tr>
<tr class="even">
<td><strong>Optimality</strong></td>
<td>Heuristic</td>
<td>Exact (mode = “exact”)</td>
</tr>
<tr class="odd">
<td><strong>Reproducibility</strong></td>
<td>Non-deterministic</td>
<td>Deterministic</td>
</tr>
<tr class="even">
<td><strong>Variables retained</strong></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≤</mo><annotation encoding="application/x-tex">\le</annotation></semantics></math>
optimal</td>
<td>Maximal</td>
</tr>
<tr class="odd">
<td><strong>Forced variables</strong></td>
<td>No</td>
<td>Yes (<code>force_in</code>)</td>
</tr>
<tr class="even">
<td><strong>Mixed data</strong></td>
<td>No</td>
<td>Yes (<code>assocSelect</code>)</td>
</tr>
<tr class="odd">
<td><strong>Complexity</strong></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mn>2</mn></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(p^2)</annotation></semantics></math></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mn>2</mn></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(p^2)</annotation></semantics></math>
greedy,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><msup><mn>3</mn><mrow><mi>p</mi><mi>/</mi><mn>3</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(3^{p/3})</annotation></semantics></math>
exact</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="applications">Applications<a class="anchor" aria-label="anchor" href="#applications"></a>
</h3>
<p><strong>caret</strong>: Exploratory analysis, non-critical
reproducibility requirements.</p>
<p><strong>corrselect</strong>: Reproducible research, maximal variable
retention, forced variable constraints, mixed data types.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="comparison-2-boruta">Comparison 2: Boruta<a class="anchor" aria-label="anchor" href="#comparison-2-boruta"></a>
</h2>
<div class="section level3">
<h3 id="method-1">Method<a class="anchor" aria-label="anchor" href="#method-1"></a>
</h3>
<p>Boruta tests variable importance via random forest permutation:</p>
<ol style="list-style-type: decimal">
<li>Create shadow features (permuted copies)</li>
<li>Fit random forest on original + shadow features</li>
<li>Test:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">importance</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>&gt;</mo><mrow><mi mathvariant="normal">max</mi><mo>⁡</mo></mrow><mo stretchy="false" form="prefix">(</mo><mtext mathvariant="normal">importance</mtext><mo stretchy="false" form="prefix">(</mo><mtext mathvariant="normal">shadow</mtext><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{importance}(X_i) &gt; \max(\text{importance}(\text{shadow}))</annotation></semantics></math>
</li>
<li>Iteratively confirm/reject until convergence</li>
</ol>
<p><strong>Orthogonal objective</strong>: Boruta selects predictive
variables (supervised). corrselect removes redundant variables
(unsupervised).</p>
</div>
<div class="section level3">
<h3 id="execution-1">Execution<a class="anchor" aria-label="anchor" href="#execution-1"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"Boruta"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Boruta: "Which variables predict species_richness?"</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span>  <span class="va">boruta_result</span> <span class="op">&lt;-</span> <span class="fu">Boruta</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Boruta/man/Boruta.html" class="external-link">Boruta</a></span><span class="op">(</span></span>
<span>    <span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>    data    <span class="op">=</span> <span class="va">bioclim_example</span>,</span>
<span>    maxRuns <span class="op">=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Boruta variable importance screening:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">boruta_result</span><span class="op">$</span><span class="va">finalDecision</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">important_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">boruta_result</span><span class="op">$</span><span class="va">finalDecision</span><span class="op">[</span></span>
<span>    <span class="va">boruta_result</span><span class="op">$</span><span class="va">finalDecision</span> <span class="op">==</span> <span class="st">"Confirmed"</span></span>
<span>  <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n  Confirmed predictors:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">important_vars</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">" "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">important_vars</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Boruta variable importance screening:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tentative Confirmed  Rejected </span></span>
<span><span class="co">#&gt;         0         6        13 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Confirmed predictors: 6 </span></span>
<span><span class="co">#&gt;   BIO12, BIO13, BIO14, BIO15, BIO16, BIO17</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># corrselect: "Which variables are redundant?"</span></span>
<span><span class="va">corrselect_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span><span class="va">predictors</span>, threshold <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\ncorrselect multicollinearity pruning:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; corrselect multicollinearity pruning:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Non-redundant variables:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">corrselect_result</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Non-redundant variables: 12</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">" "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">corrselect_result</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   BIO1, BIO3, BIO6, BIO9, BIO11, BIO12, BIO13, BIO14, BIO16, BIO17, BIO18, BIO19</span></span></code></pre></div>
<p>Different variable sets selected: Boruta optimizes prediction;
corrselect minimizes redundancy.</p>
</div>
<div class="section level3">
<h3 id="comparison-1">Comparison<a class="anchor" aria-label="anchor" href="#comparison-1"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Criterion</th>
<th>Boruta</th>
<th>corrselect</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Objective</strong></td>
<td>Predictive power</td>
<td>Redundancy removal</td>
</tr>
<tr class="even">
<td><strong>Criterion</strong></td>
<td>Permutation importance</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">∥</mo><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">∥</mo><mo>&lt;</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">\|r_{ij}\| &lt; \tau</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><strong>Response</strong></td>
<td>Required</td>
<td>Not required</td>
</tr>
<tr class="even">
<td><strong>Multicollinearity</strong></td>
<td>Indirect</td>
<td>Direct</td>
</tr>
<tr class="odd">
<td><strong>Stochastic</strong></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr class="even">
<td><strong>Complexity</strong></td>
<td>High
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">\ge 100</annotation></semantics></math>
forests)</td>
<td>Low (graph)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="sequential-application">Sequential Application<a class="anchor" aria-label="anchor" href="#sequential-application"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Stage 1: Correlation-based pruning</span></span>
<span><span class="va">data_pruned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span><span class="va">raw_data</span>, threshold <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stage 2: Importance testing</span></span>
<span><span class="va">boruta_result</span> <span class="op">&lt;-</span> <span class="fu">Boruta</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Boruta/man/Boruta.html" class="external-link">Boruta</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">data_pruned</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">final_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">boruta_result</span><span class="op">$</span><span class="va">finalDecision</span><span class="op">[</span></span>
<span>  <span class="va">boruta_result</span><span class="op">$</span><span class="va">finalDecision</span> <span class="op">==</span> <span class="st">"Confirmed"</span></span>
<span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stage 3: Final model</span></span>
<span><span class="va">final_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">data_pruned</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"response"</span>, <span class="va">final_vars</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Stage 1 removes redundancy (reproducible). Stage 2 tests importance
(stochastic). Stage 3 fits model with non-redundant, predictive
variables.</p>
</div>
<div class="section level3">
<h3 id="applications-1">Applications<a class="anchor" aria-label="anchor" href="#applications-1"></a>
</h3>
<p><strong>Boruta</strong>: Prediction-focused analysis with response
variable.</p>
<p><strong>corrselect</strong>: Multicollinearity removal, exploratory
analysis without response, reproducible selection.</p>
<p><strong>Sequential</strong>: High-dimensional correlated data
requiring both redundancy removal and importance testing.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="comparison-3-glmnet-lassoridge">Comparison 3: glmnet (LASSO/Ridge)<a class="anchor" aria-label="anchor" href="#comparison-3-glmnet-lassoridge"></a>
</h2>
<div class="section level3">
<h3 id="method-2">Method<a class="anchor" aria-label="anchor" href="#method-2"></a>
</h3>
<p>glmnet minimizes regularized loss:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mi mathvariant="normal">min</mi><mi>β</mi></munder><mfrac><mn>1</mn><mrow><mn>2</mn><mi>n</mi></mrow></mfrac><mo stretchy="false" form="postfix">∥</mo><mi>y</mi><mo>−</mo><mi>X</mi><mi>β</mi><msubsup><mo stretchy="false" form="postfix">∥</mo><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mi>λ</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>α</mi><mo stretchy="false" form="postfix">∥</mo><mi>β</mi><msub><mo stretchy="false" form="postfix">∥</mo><mn>1</mn></msub><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">∥</mo><mi>β</mi><msubsup><mo stretchy="false" form="postfix">∥</mo><mn>2</mn><mn>2</mn></msubsup><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\min_{\beta} \frac{1}{2n} \|y - X\beta\|_2^2 + \lambda \left[\alpha \|\beta\|_1 + (1-\alpha) \|\beta\|_2^2\right]
</annotation></semantics></math></p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha = 1</annotation></semantics></math>:
LASSO (L1 penalty, sparse
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha = 0</annotation></semantics></math>:
Ridge (L2 penalty, shrinkage)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>:
Cross-validation selected</li>
</ul>
<p><strong>Difference</strong>: glmnet performs soft selection
(shrinkage) optimizing prediction. corrselect performs hard selection
(removal) based on correlation structure.</p>
</div>
<div class="section level3">
<h3 id="execution-2">Execution<a class="anchor" aria-label="anchor" href="#execution-2"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"glmnet"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Fit LASSO with cross-validation</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">response</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span>  <span class="va">cv_lasso</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Extract non-zero coefficients at lambda.1se (conservative choice)</span></span>
<span>  <span class="va">coef_lasso</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cv_lasso</span>, s <span class="op">=</span> <span class="st">"lambda.1se"</span><span class="op">)</span></span>
<span>  <span class="va">selected_lasso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">coef_lasso</span><span class="op">)</span><span class="op">[</span><span class="va">coef_lasso</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>  <span class="co"># Remove intercept</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"glmnet (LASSO, λ = lambda.1se):\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Variables retained:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">selected_lasso</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">" "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">selected_lasso</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; glmnet (LASSO, λ = lambda.1se):</span></span>
<span><span class="co">#&gt;   Variables retained: 4 </span></span>
<span><span class="co">#&gt;   BIO1, BIO12, BIO15, BIO16</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"glmnet"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Compare model performance</span></span>
<span>  <span class="va">model_glmnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">bioclim_example</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species_richness"</span>, <span class="va">selected_lasso</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">model_corrselect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                         data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>species_richness <span class="op">=</span> <span class="va">response</span>, <span class="va">result_corrselect</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nModel comparison (OLS on selected variables):\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  glmnet:     R² ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_glmnet</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      <span class="st">"with"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">selected_lasso</span><span class="op">)</span>, <span class="st">"predictors\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  corrselect: R² ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_corrselect</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      <span class="st">"with"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">result_corrselect</span><span class="op">)</span>, <span class="st">"predictors\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model comparison (OLS on selected variables):</span></span>
<span><span class="co">#&gt;   glmnet:     R² = 0.983 with 4 predictors</span></span>
<span><span class="co">#&gt;   corrselect: R² = 0.909 with 12 predictors</span></span></code></pre></div>
<p>glmnet selects fewer variables
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>S</mi><mtext mathvariant="normal">glmnet</mtext></msub><mo stretchy="false" form="prefix">|</mo><mo>≤</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>S</mi><mtext mathvariant="normal">corrselect</mtext></msub><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|S_{\text{glmnet}}| \le |S_{\text{corrselect}}|</annotation></semantics></math>)
optimizing prediction. corrselect maximizes retention under correlation
constraint.</p>
</div>
<div class="section level3">
<h3 id="coefficient-comparison">Coefficient Comparison<a class="anchor" aria-label="anchor" href="#coefficient-comparison"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"glmnet"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># glmnet coefficients (shrinkage)</span></span>
<span>  <span class="va">coef_vals</span> <span class="op">&lt;-</span> <span class="va">coef_lasso</span><span class="op">[</span><span class="va">coef_lasso</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">0</span>, <span class="op">]</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">coef_vals</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>          las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>          main <span class="op">=</span> <span class="st">"glmnet: Shrunk Coefficients"</span>,</span>
<span>          ylab <span class="op">=</span> <span class="st">"Absolute Coefficient Value"</span>,</span>
<span>          col <span class="op">=</span> <span class="st">"salmon"</span>,</span>
<span>          cex.names <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># corrselect: unbiased OLS coefficients</span></span>
<span>  <span class="va">coef_corrselect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model_corrselect</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>  <span class="co"># Remove intercept</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">coef_corrselect</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>          las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>          main <span class="op">=</span> <span class="st">"corrselect: Unbiased OLS Coefficients"</span>,</span>
<span>          ylab <span class="op">=</span> <span class="st">"Absolute Coefficient Value"</span>,</span>
<span>          col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>          cex.names <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-11-1.png" class="r-plt" alt="Side-by-side barplots comparing coefficient magnitudes between glmnet (left panel, salmon bars) and corrselect (right panel, blue bars). Left panel shows glmnet's shrunk coefficients affected by L1 penalty, biased toward zero. Right panel shows corrselect's unbiased OLS coefficients on pruned variables with preserved effect sizes. The comparison illustrates the tradeoff between prediction-focused shrinkage and interpretation-focused hard selection." width="960"></p>
<p>Left: L1 penalty shrinks coefficients toward zero (biased). Right:
OLS on pruned variables (unbiased). glmnet optimizes prediction with
shrinkage. corrselect preserves effect sizes.</p>
</div>
<div class="section level3">
<h3 id="comparison-2">Comparison<a class="anchor" aria-label="anchor" href="#comparison-2"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Criterion</th>
<th>glmnet</th>
<th>corrselect</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Objective</strong></td>
<td>Prediction accuracy</td>
<td>Multicollinearity removal</td>
</tr>
<tr class="even">
<td><strong>Selection</strong></td>
<td>Soft (shrinkage)</td>
<td>Hard (removal)</td>
</tr>
<tr class="odd">
<td><strong>Coefficient bias</strong></td>
<td>Yes (L1/L2)</td>
<td>No</td>
</tr>
<tr class="even">
<td><strong>Multicollinearity</strong></td>
<td>Regularization</td>
<td>Pruning</td>
</tr>
<tr class="odd">
<td><strong>Response</strong></td>
<td>Required</td>
<td>Not required</td>
</tr>
<tr class="even">
<td><strong>Tuning</strong></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
(cross-validation)</td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
(user-specified)</td>
</tr>
<tr class="odd">
<td><strong>Interpretability</strong></td>
<td>Shrunk effects</td>
<td>Direct effects</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="applications-2">Applications<a class="anchor" aria-label="anchor" href="#applications-2"></a>
</h3>
<p><strong>glmnet</strong>: Prediction-focused, high-dimensional
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">p &gt; n</annotation></semantics></math>),
accepts biased coefficients.</p>
<p><strong>corrselect</strong>: Interpretable coefficients, exploratory
analysis, explicit correlation constraint, unregularized modeling.</p>
<p><strong>Sequential</strong>: Correlation pruning (corrselect)
followed by sparse prediction (glmnet).</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="comparison-4-modelprune-vs-manual-vif-removal">Comparison 4: modelPrune() vs Manual VIF Removal<a class="anchor" aria-label="anchor" href="#comparison-4-modelprune-vs-manual-vif-removal"></a>
</h2>
<div class="section level3">
<h3 id="method-3">Method<a class="anchor" aria-label="anchor" href="#method-3"></a>
</h3>
<p>Variance Inflation Factor quantifies predictor multicollinearity:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">VIF</mtext><mi>j</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><msubsup><mi>R</mi><mi>j</mi><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\text{VIF}_j = \frac{1}{1 - R^2_j}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mi>j</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">R^2_j</annotation></semantics></math>
results from regressing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>j</mi></msub><annotation encoding="application/x-tex">X_j</annotation></semantics></math>
on remaining predictors. Thresholds:</p>
<ul>
<li>VIF &lt; 5: Low collinearity</li>
<li>VIF &lt; 10: Moderate (acceptable)</li>
<li>VIF ≥ 10: High (problematic)</li>
</ul>
<p>Manual approach: iteratively remove max(VIF) until all VIF &lt;
threshold.</p>
</div>
<div class="section level3">
<h3 id="manual-implementation">Manual Implementation<a class="anchor" aria-label="anchor" href="#manual-implementation"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manual iterative VIF removal</span></span>
<span><span class="va">manual_vif_removal</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">threshold</span> <span class="op">=</span> <span class="fl">5</span>, <span class="va">max_iter</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Get response variable name</span></span>
<span>  <span class="va">response_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/allnames.html" class="external-link">all.vars</a></span><span class="op">(</span><span class="va">formula</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Get predictor names (handles ~ . notation)</span></span>
<span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">current_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>  <span class="co"># Exclude intercept</span></span>
<span></span>
<span>  <span class="va">removed_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">vif_vals</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html" class="external-link">vif</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">vif_vals</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">threshold</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">current_vars</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">removed_vars</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">max_iter</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Remove variable with highest VIF</span></span>
<span>    <span class="va">var_to_remove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">vif_vals</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">removed_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">removed_vars</span>, <span class="va">var_to_remove</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Iteration"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">removed_vars</span><span class="op">)</span>, <span class="st">": Removing"</span>, <span class="va">var_to_remove</span>,</span>
<span>        <span class="st">"(VIF ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">vif_vals</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Update variable list and refit</span></span>
<span>    <span class="va">current_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">current_vars</span>, <span class="va">var_to_remove</span><span class="op">)</span></span>
<span>    <span class="va">new_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">response_var</span>, <span class="st">"~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">current_vars</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">new_formula</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>    <span class="va">vif_vals</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html" class="external-link">vif</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, iterations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">removed_vars</span><span class="op">)</span>,</span>
<span>       vif <span class="op">=</span> <span class="va">vif_vals</span>, removed <span class="op">=</span> <span class="va">removed_vars</span>, converged <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">vif_vals</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="va">threshold</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run manual VIF removal</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"car"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Manual VIF removal (iterative):\n"</span><span class="op">)</span></span>
<span>  <span class="va">manual_result</span> <span class="op">&lt;-</span> <span class="fu">manual_vif_removal</span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bioclim_example</span>, threshold <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nVariables kept:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">manual_result</span><span class="op">$</span><span class="va">vif</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">manual_result</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"(Stopped at max_iter = 10; VIF threshold not yet reached)\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Manual VIF removal (iterative):</span></span>
<span><span class="co">#&gt; Loading required package: car</span></span>
<span><span class="co">#&gt; Loading required package: carData</span></span>
<span><span class="co">#&gt; Iteration 1 : Removing BIO2 (VIF = 5.83 )</span></span>
<span><span class="co">#&gt; Iteration 2 : Removing BIO7 (VIF = 5.66 )</span></span>
<span><span class="co">#&gt; Iteration 3 : Removing BIO5 (VIF = 5.03 )</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variables kept: 16</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="modelprune-comparison">modelPrune() Comparison<a class="anchor" aria-label="anchor" href="#modelprune-comparison"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run modelPrune</span></span>
<span><span class="va">modelprune_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modelPrune.html">modelPrune</a></span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bioclim_example</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nmodelPrune results:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; modelPrune results:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Variables removed:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">modelprune_result</span>, <span class="st">"removed_vars"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Variables removed: BIO2 BIO7 BIO5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Variables kept:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">modelprune_result</span>, <span class="st">"selected_vars"</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Variables kept: 16</span></span>
<span></span>
<span><span class="co"># Extract final model</span></span>
<span><span class="va">final_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">modelprune_result</span>, <span class="st">"final_model"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"car"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFinal VIF values:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html" class="external-link">vif</a></span><span class="op">(</span><span class="va">final_model</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Final VIF values:</span></span>
<span><span class="co">#&gt;  BIO1  BIO3  BIO4  BIO6  BIO8  BIO9 BIO10 BIO11 BIO12 BIO13 BIO14 BIO15 BIO16 </span></span>
<span><span class="co">#&gt;  2.09  3.68  3.81  2.57  4.03  4.27  4.96  3.06  1.76  2.51  3.11  3.01  2.43 </span></span>
<span><span class="co">#&gt; BIO17 BIO18 BIO19 </span></span>
<span><span class="co">#&gt;  2.88  2.82  1.70</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visual-vif-comparison">Visual: VIF Comparison<a class="anchor" aria-label="anchor" href="#visual-vif-comparison"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"car"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Compute VIF for original model</span></span>
<span>  <span class="va">model_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">species_richness</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bioclim_example</span><span class="op">)</span></span>
<span>  <span class="va">vif_before</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html" class="external-link">vif</a></span><span class="op">(</span><span class="va">model_full</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># VIF after modelPrune</span></span>
<span>  <span class="va">vif_after</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html" class="external-link">vif</a></span><span class="op">(</span><span class="va">final_model</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Combined barplot</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">all_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">vif_before</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">vif_after</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">vif_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    before <span class="op">=</span> <span class="va">vif_before</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">all_vars</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">vif_before</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    after <span class="op">=</span> <span class="va">vif_after</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">all_vars</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">vif_after</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">vif_combined</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">vif_combined</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">vif_combined</span> <span class="op">&lt;-</span> <span class="va">vif_combined</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">vif_combined</span><span class="op">$</span><span class="va">before</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Show top 15</span></span>
<span>  <span class="va">n_show</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">vif_combined</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">vif_combined</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n_show</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          beside <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>          main <span class="op">=</span> <span class="st">"VIF Before and After modelPrune()"</span>,</span>
<span>          ylab <span class="op">=</span> <span class="st">"VIF"</span>,</span>
<span>          col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          cex.names <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>          names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">vif_combined</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n_show</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>         legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before"</span>, <span class="st">"After"</span>, <span class="st">"Limit = 5"</span><span class="op">)</span>,</span>
<span>         fill   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>         border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"white"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>         lty    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>         lwd    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>         col    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"black"</span><span class="op">)</span>,</span>
<span>         bty    <span class="op">=</span> <span class="st">"o"</span>,</span>
<span>         bg     <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-14-1.png" class="r-plt" alt="Side-by-side barplot showing VIF values before (red bars) and after (blue bars) applying modelPrune() for the top 15 variables ordered by initial VIF. Black horizontal dashed line marks the VIF limit of 5. Before pruning, many variables show high VIF values indicating severe multicollinearity. After modelPrune(), all retained variables have VIF below the threshold, and high-VIF variables are completely removed (shown as red-only bars), demonstrating automated and effective multicollinearity reduction." width="768"></p>
<div class="section level3">
<h3 id="comparison-3">Comparison<a class="anchor" aria-label="anchor" href="#comparison-3"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Criterion</th>
<th>Manual VIF</th>
<th>modelPrune()</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Algorithm</strong></td>
<td>Iterative greedy</td>
<td>Graph-based</td>
</tr>
<tr class="even">
<td><strong>Automation</strong></td>
<td>Manual</td>
<td>Automated</td>
</tr>
<tr class="odd">
<td><strong>Optimality</strong></td>
<td>Heuristic</td>
<td>Maximal subset</td>
</tr>
<tr class="even">
<td><strong>Forced variables</strong></td>
<td>Manual exclusion</td>
<td><code>force_in</code></td>
</tr>
<tr class="odd">
<td><strong>Output</strong></td>
<td>Verbose log</td>
<td>Summary</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="applications-3">Applications<a class="anchor" aria-label="anchor" href="#applications-3"></a>
</h3>
<p><strong>Manual VIF</strong>: Educational use, diagnostic
understanding, legacy workflows.</p>
<p><strong>modelPrune()</strong>: Production pipelines, forced variable
constraints, reproducible documentation.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<div class="section level3">
<h3 id="method-selection">Method Selection<a class="anchor" aria-label="anchor" href="#method-selection"></a>
</h3>
<table class="table">
<colgroup>
<col width="17%">
<col width="44%">
<col width="38%">
</colgroup>
<thead><tr class="header">
<th>Goal</th>
<th>Primary Method</th>
<th>Alternative</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Redundancy removal (unsupervised)</td>
<td>corrPrune()</td>
<td>caret::findCorrelation()</td>
</tr>
<tr class="even">
<td>VIF reduction (regression)</td>
<td>modelPrune()</td>
<td>Manual VIF</td>
</tr>
<tr class="odd">
<td>Predictive variable selection</td>
<td>Boruta</td>
<td>RF importance</td>
</tr>
<tr class="even">
<td>Prediction accuracy</td>
<td>glmnet</td>
<td>Elastic net</td>
</tr>
<tr class="odd">
<td>Mixed data types</td>
<td>assocSelect()</td>
<td>Manual metrics</td>
</tr>
<tr class="even">
<td>Forced variable constraints</td>
<td>corrselect (<code>force_in</code>)</td>
<td>N/A</td>
</tr>
<tr class="odd">
<td>Exploratory (fast)</td>
<td>caret</td>
<td>corrPrune (greedy)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="corrselect-distinguishing-features">corrselect Distinguishing Features<a class="anchor" aria-label="anchor" href="#corrselect-distinguishing-features"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Maximal clique enumeration</strong>: Optimal retention under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">|r_{ij}| &lt; \tau</annotation></semantics></math>
constraint</li>
<li>
<strong>Deterministic</strong>: ELS and Bron-Kerbosch algorithms
guarantee reproducibility</li>
<li>
<strong>Flexible</strong>: Forced variables, mixed types,
greedy/exact modes</li>
<li>
<strong>Unbiased estimates</strong>: Hard removal preserves
coefficient interpretability</li>
<li>
<strong>Model-agnostic</strong>: Correlation-based
preprocessing</li>
</ol>
</div>
<div class="section level3">
<h3 id="integrated-workflow">Integrated Workflow<a class="anchor" aria-label="anchor" href="#integrated-workflow"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Correlation pruning</span></span>
<span><span class="va">data_pruned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrPrune.html">corrPrune</a></span><span class="op">(</span><span class="va">raw_data</span>, threshold <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># VIF refinement</span></span>
<span><span class="va">model_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modelPrune.html">modelPrune</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_pruned</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Importance testing (optional)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"Boruta"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">boruta_result</span> <span class="op">&lt;-</span> <span class="fu">Boruta</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Boruta/man/Boruta.html" class="external-link">Boruta</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">model_data</span><span class="op">)</span></span>
<span>  <span class="va">important_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">boruta_result</span><span class="op">$</span><span class="va">finalDecision</span><span class="op">[</span></span>
<span>    <span class="va">boruta_result</span><span class="op">$</span><span class="va">finalDecision</span> <span class="op">==</span> <span class="st">"Confirmed"</span></span>
<span>  <span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Final model: OLS (interpretable) or glmnet (prediction)</span></span>
<span><span class="va">final_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">model_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"response"</span>, <span class="va">important_vars</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p><strong>caret</strong>: Kuhn, M. (2008). Building predictive
models in R using the caret package. <em>Journal of Statistical
Software</em>, 28(5), 1-26. <a href="https://doi.org/10.18637/jss.v028.i05" class="external-link">doi:10.18637/jss.v028.i05</a></p></li>
<li><p><strong>Boruta</strong>: Kursa, M. B., &amp; Rudnicki, W. R.
(2010). Feature selection with the Boruta package. <em>Journal of
Statistical Software</em>, 36(11), 1-13. <a href="https://doi.org/10.18637/jss.v036.i11" class="external-link">doi:10.18637/jss.v036.i11</a></p></li>
<li><p><strong>glmnet</strong>: Friedman, J., Hastie, T., &amp;
Tibshirani, R. (2010). Regularization paths for generalized linear
models via coordinate descent. <em>Journal of Statistical Software</em>,
33(1), 1-22. <a href="https://doi.org/10.18637/jss.v033.i01" class="external-link">doi:10.18637/jss.v033.i01</a></p></li>
<li><p><strong>VIF</strong>: Belsley, D. A., Kuh, E., &amp; Welsch, R.
E. (1980). <em>Regression Diagnostics: Identifying Influential Data and
Sources of Collinearity</em>. Wiley. <a href="https://doi.org/10.1002/0471725153" class="external-link">doi:10.1002/0471725153</a></p></li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li>
<code><a href="../articles/quickstart.html">vignette("quickstart")</a></code> - Interface overview and usage
examples</li>
<li>
<code><a href="../articles/workflows.html">vignette("workflows")</a></code> - Domain-specific workflows
(genomics, ecology, surveys)</li>
<li>
<code><a href="../articles/advanced.html">vignette("advanced")</a></code> - Algorithm selection and
performance tuning</li>
<li>
<code><a href="../articles/theory.html">vignette("theory")</a></code> - Graph-theoretic foundations and
formal proofs</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gcol33" class="external-link">Gilles Colling</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
