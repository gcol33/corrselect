---
title: "Quick Start"
author: "Gilles Colling"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Quick Start}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 7,
  fig.height = 5,
  dev = "svg"
)
```

## What corrselect Does

corrselect identifies and removes redundant variables based on pairwise correlation or association. Given a threshold $\tau$, it finds subsets where all pairwise associations satisfy $|a_{ij}| < \tau$ (see `vignette("theory")` for mathematical formulation).

## Interface Hierarchy

corrselect provides three levels of interface:

### Level 1: Simple Pruning

**corrPrune()** - Removes redundant predictors based on pairwise correlation:

- Returns a single pruned dataset
- No response variable required
- Fast greedy or exact search

**modelPrune()** - Reduces VIF in regression models:

- Returns a single pruned dataset with response
- Iteratively removes high-VIF predictors
- Works with lm, glm, lme4, glmmTMB

### Level 2: Structured Subset Selection

**corrSelect()** - Returns all maximal subsets (numeric data):

- Enumerates all maximal valid subsets satisfying threshold (see `vignette("theory")`)
- Provides full metadata (size, avg_corr, max_corr, min_corr)
- Exact or greedy search

**assocSelect()** - Returns all maximal subsets (mixed-type data):

- Handles numeric, factor, and ordered variables
- Uses appropriate association measures per variable pair
- Exact or greedy search

### Level 3: Low-Level Matrix Interface

**MatSelect()** - Direct matrix input:

- Accepts precomputed correlation/association matrices
- No data preprocessing
- Useful for repeated analyses

---

## Quick Examples

### corrPrune(): Association-Based Pruning

```{r}
library(corrselect)
data(mtcars)

# Remove correlated predictors (threshold = 0.7)
pruned <- corrPrune(mtcars, threshold = 0.7)

# Results
cat(sprintf("Reduced from %d to %d variables\n", ncol(mtcars), ncol(pruned)))
names(pruned)
```

Variables removed:

```{r}
attr(pruned, "removed_vars")
```

**How corrPrune() selects among multiple maximal subsets**:

When multiple maximal subsets exist (which is common), `corrPrune()` returns the subset with the **lowest average absolute correlation**. This selection criterion balances three goals:

1. **Minimize redundancy**: Lower average correlation means more independent variables
2. **Maximize information**: Prefers diverse variable combinations over tightly clustered ones
3. **Deterministic behavior**: Always returns the same result for the same data

To explore **all** maximal subsets instead of just the optimal one, use `corrSelect()` (see below).

### modelPrune(): VIF-Based Pruning

```{r}
# Prune based on VIF (limit = 5)
model_data <- modelPrune(
  formula = mpg ~ .,
  data = mtcars,
  limit = 5
)

# Results
cat("Variables kept:", paste(attr(model_data, "selected_vars"), collapse = ", "), "\n")
cat("Variables removed:", paste(attr(model_data, "removed_vars"), collapse = ", "), "\n")
```

### corrSelect(): Enumerate All Maximal Subsets

```{r}
results <- corrSelect(mtcars, threshold = 0.7)
show(results)
```

Inspect subsets:

```{r}
as.data.frame(results)[1:5, ]  # First 5 subsets
```

Extract a specific subset:

```{r}
subset_data <- corrSubset(results, mtcars, which = 1)
names(subset_data)
```

### assocSelect(): Mixed-Type Data

```{r}
# Create mixed-type data
df <- data.frame(
  x1 = rnorm(100),
  x2 = rnorm(100),
  cat1 = factor(sample(c("A", "B", "C"), 100, replace = TRUE)),
  ord1 = ordered(sample(1:5, 100, replace = TRUE))
)

# Handle mixed types automatically
results_mixed <- assocSelect(df, threshold = 0.5)
show(results_mixed)
```

---

## Protecting Variables

Use `force_in` to ensure specific variables are always retained:

```{r}
# Force "mpg" to remain in all subsets
pruned_force <- corrPrune(
  data = mtcars,
  threshold = 0.7,
  force_in = "mpg"
)

# Verify forced variable is present
"mpg" %in% names(pruned_force)
```

---

## Threshold Selection

Common threshold guidelines:

| Threshold | Interpretation | Use Case |
|-----------|----------------|----------|
| 0.5 | Strict | When multicollinearity is critical |
| 0.7 | Moderate | General-purpose default |
| 0.9 | Lenient | When retaining variables is priority |

For detailed threshold selection strategies including visualization techniques and sensitivity analysis, see `vignette("advanced")`.

---

## Interface Selection Guide

| Scenario | Function | Key Parameters |
|----------|----------|----------------|
| Quick dimensionality reduction | `corrPrune()` | `threshold`, `mode` |
| Model-based refinement | `modelPrune()` | `limit` (VIF threshold), `engine` |
| Enumerate all valid subsets | `corrSelect()` | `threshold` |
| Mixed-type data | `assocSelect()` | `threshold` |
| Precomputed matrices | `MatSelect()` | `threshold`, `method` |
| Protect key variables | Any function | `force_in` |

---

## See Also

- `vignette("workflows")` - Complete real-world workflows (ecological, survey, genomic, mixed models)
- `vignette("advanced")` - Algorithmic control and custom engines
- `vignette("comparison")` - Comparison with caret, Boruta, glmnet
- `vignette("theory")` - Theoretical foundations and formulation
- `?corrPrune`, `?modelPrune`, `?corrSelect`, `?assocSelect`, `?MatSelect`
